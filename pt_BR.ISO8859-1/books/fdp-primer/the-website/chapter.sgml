<!-- Copyright (c) 1998, 1999 Nik Clayton, All rights reserved.

     Redistribution and use in source (SGML DocBook) and 'compiled' forms
     (SGML HTML, PDF, PostScript, RTF and so forth) with or without
     modification, are permitted provided that the following conditions
     are met:

      1. Redistributions of source code (SGML DocBook) must retain the above
         copyright notice, this list of conditions and the following
         disclaimer as the first lines of this file unmodified.

      2. Redistributions in compiled form (transformed to other DTDs,
         converted to PDF, PostScript, RTF and other formats) must reproduce
         the above copyright notice, this list of conditions and the
         following disclaimer in the documentation and/or other materials
         provided with the distribution.

     THIS DOCUMENTATION IS PROVIDED BY NIK CLAYTON "AS IS" AND ANY EXPRESS OR
     IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
     OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
     DISCLAIMED. IN NO EVENT SHALL NIK CLAYTON BE LIABLE FOR ANY DIRECT,
     INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
     (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
     SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
     HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
     STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
     ANY WAY OUT OF THE USE OF THIS DOCUMENTATION, EVEN IF ADVISED OF THE
     POSSIBILITY OF SUCH DAMAGE.

     $FreeBSD: doc/en_US.ISO8859-1/books/fdp-primer/the-website/chapter.sgml,v 1.11 2002/06/28 23:44:37 keramida Exp $
-->

<chapter id="the-website">
  <title>O Website</title>
  
  <sect1>
    <title>Prepara&ccedil;&atilde;o</title>
    
    <para>Pegue 200MB livre no disco. Voc&ecirce; ira precisar de espa&ccedil;o em disco para as ferramentas SGML, 
      um subconjunto da &aacute;rvore do CVS, espa&ccedil;o provis&oacute;rio para compila&ccedil;&atilde; e 
      web pages instaladas. Se voc&ecirce j&aacute; tem instalado as ferramentas SGML e a &aacute;rvore 
      do CVS, voc&ecirc precisar&aacute; apenas ~100MB livres no disco.</para>
 
    <note>
      <para>Certifique-se que seus ports de documenta&ccedil;&atilde; est&atilde;o atualizados! Quando na
        d&uacute;vida, remova o outro ports usando o comando &man.pkg.delete.1; antes de instalar o ports.
        Por exemplo, n&oacute;s atualmente dependemos do jade-1.2, e se voc&ecirce; tem instalado o jade-1.1. por favor fa&ccedil;a:</para>

      <screen>&prompt.root; <userinput>pkg_delete jade-1.1</userinput></screen>
    </note>

    <para>Configure a reposit&oacute;rio CVS. Voc&ecircle; precisa dos diret&oacute;rios www, doc e ports dentro da 
     sua &aacute;rvore do CVS (mais o CVSROOT &eacute; claro). Por favor leia o como fazer Introdu&ccedil;&atilde;o ao CVSup <ulink url="../handbook/synching.html#CVSUP">http://www.FreeBSD.org/doc/en_US.ISO8859-1/books/handbook/synching.html#CVSUP</ulink> espelho uma &aacute;vore do CVS ou partes de uma &aacute;rvore do CVS.</para>
    
    <para>O essencial do cvsup seria: <literal>www</literal>,
      <literal>doc-all</literal>, <literal>cvs-base</literal>, e
      <literal>ports-base</literal>.</para>
    
    <para>Isso precisar&aacute; de ~100MB de espa&ccedil;o livre em disco.</para>
    
    <para>Uma &aacute;rvore completa do CVS, incluindo: <literal>src</literal>,
      <literal>doc</literal>, <literal>www</literal>, e
      <literal>ports</literal> - &eacute; atualmente de 650MB.</para>
  </sect1>
  
  <sect1>
    <title>Construa as web pages do inicio</title>
    
    <procedure> 
      <step>
	<para>V&aacute; para o diret&oacute;rio de prepara&ccedil;&atilde;o com no m&iacute;nimo 60MB de espa&ccedil;o em disco</para>
	
	<screen>&prompt.root; <userinput>mkdir /var/tmp/webbuild</userinput>
&prompt.root; <userinput>cd /var/tmp/webbuild</userinput></screen>
      </step>

      <step>
	<para>Checkout os arquivos SGML do CVS.</para>
	
	<screen>&prompt.root; <userinput>cvs -R co www doc</userinput></screen>
      </step>
      
      <step>
        <para>Entre no diret&oacute;rio <filename>www</filename>, e
	  execute o &man.make.1; <maketarget>links</maketarget>, para criar 
	  os links simb&oacute;licos necess&aacute;rios..</para>
	
	<screen>&prompt.root; <userinput>cd www</userinput>
&prompt.root; <userinput>make links</userinput></screen>
      </step>

      <step>
	<para>Entre no diret&oacute;rio <filename>en</filename>, e execute
	  &man.make.1; <maketarget>all</maketarget> target, para criar as
	  web pages.</para>
	
	<screen>&prompt.root; <userinput>cd en</userinput>
&prompt.root; <userinput>make all</userinput></screen>
      </step>
    </procedure>
  </sect1>
  
  <sect1>
    <title>Install the web pages into your web server</title>
    
    <procedure>
      <step>
	<para>If you have moved out of the <filename>en</filename>
	  directory, change back to it.</para>
	
	  <screen>&prompt.root; <userinput>cd <replaceable>path</replaceable>/www/en</userinput></screen>
      </step>

      <step>
	<para>Run the &man.make.1; <maketarget>install</maketarget> target,
	  setting the <makevar>DESTDIR</makevar> variable to the name of the 
	  directory you want to install the files to.</para>
	
	<screen>&prompt.root; <userinput>make DESTDIR=<replaceable>/usr/local/www</replaceable> install</userinput></screen>
      </step>

      <step>
	<para>If you have previously installed the web pages into the same
	  directory the install process will not have deleted any old or
	  outdated pages.  For example, if you build and install a new copy
	  of the site every day, this command will find and delete all
	  files that have not been updated in three days.</para>
	
	<screen>&prompt.root; <userinput>find <replaceable>/usr/local/www</replaceable> -ctime 3 -print0 | xargs -0 rm</userinput></screen>
      </step>
    </procedure>
  </sect1>
  
  <sect1>
    <title>Environment variables</title>
    
    <variablelist>
      <varlistentry>
	<term><envar>CVSROOT</envar></term>
	
	<listitem>
	  <para>Location of the CVS tree. Essential.</para>
	  
	  <screen><userinput>&prompt.root; CVSROOT=/home/ncvs; export CVSROOT</userinput></screen>
	</listitem>
      </varlistentry>
	
      <varlistentry>
	<term><makevar>ENGLISH_ONLY</makevar></term>
	
	<listitem>
	  <para>If set and not empty, the makefiles will build and
	    install only the English documents. All translations will be
	    ignored. E.g.:</para>
	  
	  <screen>&prompt.root; <userinput>make ENGLISH_ONLY=YES all install</userinput></screen>

	  <para>If you want unset the variable
	    <makevar>ENGLISH_ONLY</makevar> and build all pages, including
	    translations, set the variable <makevar>ENGLISH_ONLY</makevar>
	    to an empty value</para>
	  
	  <screen>&prompt.root; <userinput>make ENGLISH_ONLY="" all install clean</userinput></screen>
	</listitem>
      </varlistentry>
      
      <varlistentry>
	<term><makevar>WEB_ONLY</makevar></term>
	
	<listitem>
	  <para>If set and not empty, the makefiles will build and install
	    only the HTML pages from the www directory. All documents from
	    the doc directory (Handbook, FAQ, Tutorials) will be ignored.
	    E.g.:</para>
	  
	  <screen>&prompt.root; <userinput>make WEB_ONLY=YES all install</userinput></screen>
	</listitem>
      </varlistentry>
	
      <varlistentry>
	<term><makevar>NOPORTSCVS</makevar></term>
	
	<listitem>
	  <para>If set, the makefiles will not checkout files from the ports
	    cvs repository. Instead, it will copy the files from
	    <filename>/usr/ports</filename> (or where the variable
	    <envar>PORTSBASE</envar> points to).</para>
	</listitem>
      </varlistentry>
    </variablelist>
    
    <para><envar>CVSROOT</envar> is an environment variable. You must set it
      on the command line or in your dot files (~/.profile).</para>
    
    <para><makevar>WEB_ONLY</makevar>, <makevar>ENGLISH_ONLY</makevar> and
      <makevar>NOPORTSCVS</makevar> are makefile variables. You can set the
      variables in <filename>/etc/make.conf</filename>,
      <filename>Makefile.inc</filename> or as environment variables on the
      command line or in your dot files.</para>
  </sect1>
</chapter>
  
<!--
     Local Variables:
     mode: sgml
     sgml-declaration: "../chapter.decl"
     sgml-indent-data: t
     sgml-omittag: nil
     sgml-always-quote-attributes: t
     sgml-parent-document: ("../book.sgml" "part" "chapter")
     End:
-->
