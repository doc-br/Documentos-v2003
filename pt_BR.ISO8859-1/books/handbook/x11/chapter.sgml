<!--
     The FreeBSD Documentation Project

     $FreeBSD: doc/en_US.ISO8859-1/books/handbook/x11/chapter.sgml,v 1.131 2003/11/05 10:36:56 ceri Exp $
-->

<chapter id="x11">
  <title>O Sistema de Janela X</title>

  <sect1 id="x11-synopsis">
    <title>Sinopse</title>

    <para>O FreeBSD usa <application>&xfree86;</application> para prover aos usuários
      uma poderosa interface gráfica. <application>&xfree86;</application>
      é uma implementação de código aberto do Sistema de Janela X. Este capítulo
      cobrirá a instalação e configuração do
      <application>&xfree86;</application> num sistema FreeBSD. Para mais
      informações sobore o <application>&xfree86;</application> e hardware de vídeo
      suportado, verifique o sítio <ulink
        url="http://www.XFree86.org/">&xfree86;</ulink>.</para>

    <para>Após ler este capítulo, você saberá:</para>

    <itemizedlist>
      <listitem>
    <para>Os vários componentes do Sistema de Janela X, e como eles
      interagem.</para>
      </listitem>

      <listitem>
        <para>Como istalar e configurar o
          <application>&xfree86;</application>.</para>
      </listitem>

      <listitem>
        <para>Como instalar e utilizar diferentes gerenciadores de janelas.</para>
      </listitem>

      <listitem>
        <para>Como utilizar fontes &truetype; no
          <application>&xfree86;</application>.</para>
      </listitem>

      <listitem>
        <para>Como preparar seu sistema para o uso de <foreignphrase>login</foreignphrase> gráfico
          (<application>XDM</application>).</para>
      </listitem>
    </itemizedlist>

    <para>Antes de ler este capítulo, é recomendável:</para>

    <itemizedlist>
      <listitem><para>Saber como instalar softwares adicionais de terceiros
        (<xref linkend="ports">).</para></listitem>
    </itemizedlist>
  </sect1>

  <sect1 id="x-understanding">
    <title>Compreendendo o X</title>

    <para>Usar o X pela primeira vez pode causar certo impacto em quem já está
      familiarizado com outros ambientes gráficos, como o &microsoft.windows; ou o
      &macos;.</para>

    <para>Nao é necessário entender todos os detalhes dos vários componentes do
      X e como eles interagem; entretanto, algum conhecimento básico torna
      possível tirar vantagens dos pontos positivos do X.</para>

    <sect2>
      <title>Por que o X?</title>

      <para>O X nao é o primeiro sistema de interface gráfica escrito para o &unix;, mas é o
        mais popular. O grupo de desenvolvimento original do X já haviam trabalhado em outro
        sistema de interface gráfica antes de escrever o X. O nome desse sistema era
        <quote>W</quote> (de <quote>Window</quote>).  X é apenas a próxima
        letra no alfabeto Romano.</para>

      <para>O X pode ser chamado de <quote>X</quote>, <quote>Sistema de Janela X</quote>,
        <quote>X11</quote>, e outros termos.
        Em inglês, o X também é conhecido por <foreignphrase>X Window System</foreignphrase>, e
        chamar X11 de
        <quote>X Windows</quote> (note o <quote>s</quote>) pode ofender algumas pessoas;
        veja &man.X.7; para mais dicas sobre isso.</para>
    </sect2>

    <sect2>
      <title>O modelo Cliente/Servidor do X</title>

      <para>O X foi concebido desde o início com foco na rede, e
        adota um modelo <quote>cliente-servidor</quote>.  No modelo do X, o
        <quote>servidor X</quote> executa em um computador que possui teclado,
        monitor, e mouse conectados. O servidor é responsável por gerenciar
        o vídeo, tratar as entradas pelo teclado e mouse, e assim por diante.
        Cada aplicativo do X (como o <application>XTerm</application>, ou
        <application>&netscape;</application>) é um <quote>cliente</quote>. Um
        cliente envia mensagens para o servidor como <quote>Por favor, desenhe uma
        janela nestas coordenadas</quote>, e o servidor responde a
        mensagens como <quote>O usuário acabou de clicar o bot&atilde;o OK
        </quote>.</para>

      <para>Se há apenas um computador envolvido, como em casa ou em um ambiente
        de escritório pequeno, o servidor X e os clientes X estarao executando
        no mesmo computador. Entretanto, é perfeitamente possível executar o servidor X
        em um computador de mesa menos poderoso, e executar os aplicativos do X
        (os clientes), por assim dizer, naquela máquina poderosa e caríssima que serve
        a todo o escritório. Neste cenário a comunicaç&atilde;o entre o cliente X
        e o servidor se dá na rede.</para>

      <para>Isto causa confus&atilde;o a algumas pessoas, pois a terminologia do X é
        exatamente contrária à que eles esperam. O que se espera é que o <quote>servidor X
        </quote> seja a máquina grande e poderosa do por&atilde;o e
        o <quote>cliente X</quote> a máquina sobre suas messas.</para>

      <para>Lembre-se que o servidor X é a máquina com monitor e
        teclado, e os clientes X s&atilde;o os programas  que exibem as
        janelas.</para>

      <para>N&atilde; há nada no protocolo que force máquinas clientes e
        servidoras a estar executando o mesmo sistema operacional ou ainda
        no mesmo tipo de computador. É certamente possível
        executar um servidor X no &microsoft.windows; ou no &macos; da Apple, e há
        várias aplicaç&otilde; gratuitas e comerciais disponíveis que fazem exatamente
        isso.</para>

      <para>O seridor X que é distribuído com o FreeBSD é chamado
        <application>&xfree86;</application>, e está disponível gratuitamente, sob uma
        licença muito similar à licença do FreeBSD. Há também servidores X comerciais
        disponíveis para o FreeBSD.</para>
    </sect2>

    <sect2>
      <title>O Gerenciador de Janela</title>

      <para>A filosofia de concepç&atilde;o do X é muito semelhante a filosofia de concepç&atilde; do &unix;,
        <quote>ferramentas, n&atilde;o políticas</quote>.  Isso significa que o X n&atilde;o tenta
        dizer como a tarefa deve ser realizada. Ao invés disso, as ferramentas s&atilde;o fornecidas
        ao usuário, e é sua responsabilidade decidir como vai usar
        essas ferramentas.</para>

      <para>Essa filosofia se estende ao X quando o mesmo n&atilde; dita com o quê as janelas devem
        parecer na exibiç&atilde;o, como movê-las com o mouse, que
        atalho deve ser usado para mover-se entre as janelas (i.e.,
        <keycombo action="simul">
          <keycap>Alt</keycap>
          <keycap>Tab</keycap>
        </keycombo>, no caso do &microsoft.windows;), a aparência da barra de títulos
        em cada janela, se elas devem ou n&atilde;o apresentar
        bot&otilde;es para fechá-las, e assim por diante.</para>

      <para>Ao invés disso, o X delega essa responsabilidade para um aplicativo chamado
        <quote>Gerenciador de Janela</quote> (do inglês
        <quote><foreignphrase>Window Manager</foreignphrase></quote>).  Há dúzias de gerenciadores de
        janela disponíveis para o X: <application>AfterStep</application>,
        <application>Blackbox</application>, <application>ctwm</application>,
        <application>Enlightenment</application>,
        <application>fvwm</application>, <application>Sawfish</application>,
        <application>twm</application>,
        <application>Window Maker</application>, e outras.  Cada um desses
        gerenciadores de janela provêm diferentes visuais e sensaç&otilde; alguns deles
        suportam <quote>áreas de trabalho virtuais</quote>; alguns permitem personalizar
        atalhos de teclado para gerenciar a área de trabalho; outros tem um bot&atilde;o <quote>Iniciar</quote>
        ou dispositivo semelhante; outros s&atilde;o <quote>tematizáveis</quote>, permitindo
        uma modificaç&atilde; completa no visual e sensaç&otilde;es pela aplicaç&atilde;o de um novo tema. Estes
        gerenciadores de janela, e muitos outros, est&atilde;o disponíveis na
        categoria <filename>x11-wm</filename> da Coleç&atilde;o de <literal>Ports</literal>.</para>

      <para>Para completar, ambos ambientes de trabalho <application>KDE</application> e o
    <application>GNOME</application> têm seus
    próprios gerenciadores de janela integrados na área de trabalho.</para>

      <para>Cada gerenciador de janela também possui um mecanismo de configuraç&atilde;o diferente;
        alguns esperam que a configuraç&atilde;o seja escrita manualmente, outros possuem
        <acronym>GUI</acronym> como ferramentas para a maior parte das tarefas de configuraç&atilde;o; pelo menos um
        (<application>sawfish</application>) tem seu arquivo de configuraç&otilde;es escrito
        em um dialeto da linguagem List.</para>

      <note>
        <title>Política do Foco</title>

        <para>Outro recurso de responsabilidade do gerenciador de janela é
          a <quote>política de foco</quote> do mouse. Todo sistema de enjanelamento
          precisa de parâmetros para escolher uma janela que responda ao acionamento do
          teclado, e deve indicar visivelmente qual janela está ativa
          também.</para>

        <para>Uma política de foco bem familiar é a chamada <quote>clique para focar</quote>.
          Este é o modelo utilizado pelo &microsoft.windows;, no qual uma janela
          se torna ativa após receber um clique do mouse.</para>

        <para>O X n&atilde;o suporta nenhuma política de foco em particular. Ao invés disso, o
          gerenciador de janela controla qual tem o foco a qualquer tempo.
          Os diferentes gerenciadores de janela v&atilde;o suportar métodos de foco distintos. Todos
          suportam clique para focar, e a maioria deles suporta
          vários outros.</para>

        <para>As políticas de foco mais populares s&atilde;o:</para>

        <variablelist>
          <varlistentry>
            <term>o foco segue o mouse</term>
            <listitem>
              <para>A janela abaixo do ponteiro do mouse é a
                janela que possui o foco. Esta n&atilde;o é necessariamente
                a janela que está sobre todas as demais.
                O foco é modificado ao apontar outra janela, n&atilde;o há
                necessidade de clicar nela.</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term>foco desleixado</term>

            <listitem>
              <para>Esta política é uma pequena extens&atilde;o de <quote>o foco segue o mouse</quote>.
                Com o foco seguindo o mouse, se o mouse é movido para
                a janela raiz (ou a area de trabalho) ent&atilde;o nenhuma janela tem o foco,
                e o acionamento do teclado é simplesmente perdido. Com o foco desleixado, o foco é
                modificado apenas quando o cursor entra em uma nova janela, e n&atilde;o
                quando se sai da janela atual.</para>
            </listitem>
          </varlistentry>

          <varlistentry>
            <term>clique para focar</term>

            <listitem>
              <para>A janela ativa é selecionada pelo clique do mouse. A
                janela pode ent&atilde;o ser <quote>elevada</quote>, e aparecer na
                frente de todas as demais janelas. Todo acionamento do teclado ser&atilde;o agora
                direcionados para essa janela, mesmo se o cursor for movido para
                outra janela.</para>
            </listitem>
          </varlistentry>
        </variablelist>

        <para>Muitos gerenciadores de janela supportam outras políticas, bem como
          variações nestas. Certifique-se de consultar a documentação própria do
          gerenciador de janela.</para>
      </note>
    </sect2>

    <sect2>
      <title><foreignphrase>Widgets</foreignphrase></title>

      <para>A abordagem do X de prover ferramentas e não políticas se extende para os
        <foreignphrase>widgets</foreignphrase> vistos nas telas de cada aplicativo.</para>

      <para><quote><foreignphrase>Widget</foreignphrase></quote> é um termo para todos os itens da intertace com o usuário
        que podem ser clicados ou manipados de alguma forma;  botões,
        <foreignphrase>check boxes</foreignphrase>, <foreignphrase>radio buttons</foreignphrase>, ícones, listas, e outros.  &microsoft.windows;
        chama estes de <quote>controles</quote>.</para>

      <para>O &microsoft.windows; e o &macos; da Apple's têm uma política muito rígida para os <foreignphrase>widgets</foreignphrase>.
        Espera-se que os desenvolvedores de aplicações compartilhem o mesmo visual e sensações em seus
        aplicativos.  Com o X, não foi
        considerado sensato determinar um estilo gráfico particular, ou conjunto
        de <foreignphrase>widgets</foreignphrase> a aderir.</para>

      <para>Como resultado, não espere que as aplicações do X tenham o mesmo
        visual e sensações. Há vários conjuntos de <foreignphrase>widgets</foreignphrase> populares e
        variações, incluindo o conjunto original de <foreignphrase>widgets</foreignphrase> Athena do MIT,
        <application>&motif;</application> (no qual o conjunto de <foreignphrase>widgets</foreignphrase> do
        &microsoft.windows; foi modelado, todas as bordas chanfradas em três tons de
        cinza), <application>OpenLook</application>, e outros.</para>

      <para>A maior parte das novas aplicações para o X vão utilizar um conjunto de <foreignphrase>widgets</foreignphrase> de visual moderno,
        ou Qt, utilizado pelo <application>KDE</application>, ou
        <application>GTK</application>, utilizado pelo projeto
        <application>GNOME</application>.
        No que diz respeito a isso, há alguma convergência no
        visual e sensações da área de trabalho do &unix;, o que certamente torna tudo mais fácil para os
        novos usuários.</para>
    </sect2>
  </sect1>

  <sect1 id="x-install">
    <title>Instalando o &xfree86;</title>

    <para>Antes de instalar o <application>&xfree86;</application>, decida que
      versão executar.  <application>&xfree86; 3.X</application> é um ramo de manutenção do desenvolvimento do
      <application>&xfree86;</application>.  É muito
      estável, e suporta um número bem grande de placas  vídeo. Entretanto, nenhum recurso novo
      está sendo desenvolvido para o software. O <application>&xfree86;
      4.X</application> é uma reconcepção do sistema com diversos novos
      recursos como melhor suporte para fontes e <foreignphrase>anti-aliasing</foreignphrase>.
      Infelizmente esta nova arquitetura requer que os drivers de vídeo sejam
      reescritos, e algumas placas mais velhas que eram suportadas na 3.X não são
      ainda suportadas na 4.X. Como todo desenvolvimento novo e suporte para as
      placas de vídeo são feitos nesse ramo, o <application>&xfree86;
      4.X</application> é agora a versão padrão do sistema de janela X no
      FreeBSD.</para>

    <para>O programa de instalaç&atilde;o do FreeBSD oferece aos usuários a oportunidade de instalar
      e configurar o <application>&xfree86; 4.X</application> durante a instalaç&atilde;o
      (detalhes em <xref linkend="x-server">). Para instalar e executar o
      <application>&xfree86; 3.X</application>, aguarde até que o
      FreeBSD mínimo seja instalado, e ent&atilde;o instale o
      <application>&xfree86;</application>. Por exemplo, para construir e instalar o
      <application>&xfree86; 3.X</application> da cole&ccedil;&atilde;o de <literal>ports</literal>:</para>

    <screen>&prompt.root; <userinput>cd /usr/ports/x11/XFree86</userinput>
&prompt.root; <userinput>make all install clean</userinput></screen>

    <para>Como alternativa, quaisquer vers&otilde;es do <application>&xfree86;</application>
      pode ser instalada diretamente dos binários do FreeBSD fornecidos no
      <ulink url="http://www.XFree86.org/">sítio &xfree86;</ulink>. Um
      pacote binário a ser usado com a ferramenta &man.pkg.add.1; também está disponível para o
      <application>&xfree86; 4.X</application>. Quando o recurso de baixar da fonte remota
      do &man.pkg.add.1; é utilizado, o número da vers&atilde;o do
      pacote deve ser removido. O &man.pkg.add.1; vai baixar automaticamente
      a vers&atilde;o mais recente do aplicativo. Logo bara baixar e instalar o
      pacote do <application>&xfree86; 4.X</application>, é só digitar:</para>

    <screen>&prompt.root; <userinput>pkg_add -r XFree86</userinput></screen>

    <para>Você também pode utilizar a cole&ccedil;&atilde;o de <literal>ports</literal> para instalar o
      <application>&xfree86; 4.X</application>, para isso você precisa apenas
      digitar os comandos a seguir:</para>

    <screen>&prompt.root; <userinput>cd /usr/ports/x11/XFree86-4</userinput>
&prompt.root; <userinput>make install clean</userinput></screen>

    <note><para>Os exemplos acima v&atilde;o instalar a distribuiç&atilde;o completa do
      <application>&xfree86;</application> incluindo os
      servidores, clientes, fontes etc. Pacotes individuais e <literal>ports</literal> para
      diferentes partes do <application>&xfree86; 4.X</application> também est&atilde;o
      disponíveis.</para></note>

    <para>O restante deste capítulo explicará como configurar o
      <application>&xfree86;</application>, e como instalar um ambiente na área de trabalho produtivo.
      </para>

<!-- A forma mais fácil é a partir do sysinstall para o XFree86 4.X -->

  </sect1>

  <sect1 id="x-config">
    <sect1info>
      <authorgroup>
        <author>
          <firstname>Christopher</firstname>
          <surname>Shumway</surname>
          <contrib>Contribuiç&atilde;o de </contrib>
          <!-- Julho 2001 -->
        </author>
      </authorgroup>
    </sect1info>
    <title>Configuraç&atilde;o do &xfree86;</title>


    <indexterm><primary>XFree86 4.X</primary></indexterm>
    <indexterm><primary>XFree86</primary></indexterm>

    <sect2>
      <title>Antes de começar</title>

      <para>Antes de configurar o <application>&xfree86; 4.X</application>,
        é necessário conhecer as seguintes informaç&otilde;es sobre o sistema alvo:</para>

      <itemizedlist>
        <listitem><para>As especificaç&otilde;es do monitor</para></listitem>
        <listitem><para>O <foreignphrase>chipset</foreignphrase> da placa de vídeo</para></listitem>
        <listitem><para>A quantidade de memória da placa de vídeo</para></listitem>
      </itemizedlist>

      <indexterm><primary>A taxa de varredura horizontal</primary></indexterm>
      <indexterm><primary>A taxa de varredura vertical</primary></indexterm>

      <para>As especificaç&otilde;es do monitor s&atilde;o s&atilde;o usadas pelo
        <application>&xfree86;</application> para determinar a resoluç&atilde;o e
        taxa de atualizaç&atilde;o em que deve operar. Estas especificaç&otilde;es podem geralmente ser
        obtidas da documentaç&atilde;o que vem com o monitor ou a partir do
        sítio do fabricante. S&atilde;o necessários dois intervalos numéricos,
        a taxa de varredura horizontal e a taxa de sincronizaç&atilde;o 
        vertical.</para>

      <para>O <foreignphrase>chipset</foreignphrase> da placa de vídeo define qual módulo de <literal>driver</literal> o 
        <application>&xfree86;</application> usa para conversar com o hardware.
        Com a maioria dos <foreignphrase>chipset</foreignphrase>, isso pode ser determinado
        automaticamente, mas ainda é útil saber identificá-lo caso a detecç&atilde;o
        automática n&atilde;o funcione corretamente.</para>

      <para>A memória da placa de vídeo determina que
        resoluç&atilde;o e a profundidade das cores nas quais o sistema vai executar. É 
        importante que o usuário conheça isso para saber das limitaç&otilde;es do
        sistema.</para>

    </sect2>

    <sect2>
      <title>Configurando o &xfree86; 4.X</title>

      <para>A configuraç&atilde;o do <application>&xfree86; 4.X</application> é
        um processo de vários passos. O primeiro passo é construir um arquivo
        de configuraç&atilde;o inicial com a opç&atilde;o <option>-configure</option> do
        <application>&xfree86;</application>.  Como o super usuário, simplesmente
        execute:</para>
      <screen>&prompt.root; <userinput>XFree86 -configure</userinput></screen>

      <para>Isso vai gerar o esqueleto do arquivo de configuraç&atilde;o do
        <application>&xfree86;</application> no diretório
        <filename>/root</filename> chamado
        <filename>XF86Config.new</filename> (na verdade a pasta utilizada é a
        registrada na variável de ambiente <envar>$HOME</envar>,
        e ela vai depender de como você conseguiu os direitos de super usuário). O programa do
        <application>&xfree86;</application> vai tentar investigar o
        o hardware da placa de vídeo no sistema e vai escrever um
        arquivo de configuraçao que carregue os drivers adequados ao
        hardware detectado no sistema alvo.</para>

      <para>O próximo passo é a testar a configuraç&atilde;o existente
        para verificar se o <application>&xfree86;</application>
        pode trabalhar com o
        hardware do sistema alvo. Para fazer esta tarefa, o usuário
        precisa executar:</para>

      <screen>&prompt.root; <userinput>XFree86 -xf86config XF86Config.new</userinput></screen>

      <para>Se a grade preto e cinza e um ponteiro de mouse do X aparecem,
        a configuraç&atilde;o foi bem sucedida. Para sair do teste, basta pressionar simultaneamente
        <keycombo action="simul">
          <keycap>Ctrl</keycap>
          <keycap>Alt</keycap>
          <keycap>Backspace</keycap>
        </keycombo>.</para>

    <note><para>Se o mouse n&atilde;o funcionar, certifique-se que o dispositivo
      foi configurado. Veja em <xref linkend="mouse">
      no capítulo de instalaç&atilde;o do &os;.</para></note>

      <indexterm><primary>Fazendo ajustes finos no XFree86 4</primary></indexterm>

      <para>Em seguinda, ajuste o arquivo de configuraç&otilde;es <filename>XF86Config.new</filename>
        ao seu gosto. Abra o arquivo em um editor de textos como o
        &man.emacs.1; ou &man.ee.1;. Primeiro, adicione as freqüências do
        monitor do seu sistema. Elas geralmente s&atilde;o expressadas
        como taxas de sincronizaç&atilde;o horizontal e vertical. Estes
        valores s&atilde;o adicionados ao arquivo <filename>XF86Config.new</filename>
        sob a seç&atilde;o <literal>"Monitor"</literal>:</para>

      <programlisting>Section "Monitor"
        Identifier   "Monitor0"
        VendorName   "Monitor Vendor"
        ModelName    "Monitor Model"
        HorizSync    30-107
        VertRefresh  48-120
EndSection</programlisting>

      <para>As express&otilde;es <varname>HorizSync</varname> e
        <varname>VertRefresh</varname> podem n&atilde;o existir no
        arquivo de configuraç&otilde;es. Se for o caso, elas precisam ser adicionadas, com
        a taxa de sincronizaç&atilde;o horizontal posicionada depois da express&atilde;o
        <varname>Horizsync</varname> e a taxa de sincronizaç&atilde;o
        vertical após a express&atilde;o <varname>VertRefresh</varname>.
        Confira no exemplo acima as taxas de um monitor já 
        preenchidas.</para>

      <para>O X permite que recursos DPMS (<literal>Energy Star</literal>) sejam utilizados em monitores
        com suporte. O programa &man.xset.1; controla os intervalos entre atividades e pode forçar
        os modos de espera, suspenso e desligado. Se você deseja habilitar os recursos de DPMS
        para o seu monitor, você deve acrescentar a linha a seguir na seç&atilde;o
        <literal>Monitor</literal>:</para>

      <programlisting>
        Option       "DPMS"</programlisting>

      <indexterm>
        <primary><command>XF86Config</command></primary>
      </indexterm>

      <para>Enquanto o arquivo de configuraç&otilde;es <filename>XF86Config.new</filename>
        ainda estiver aberto no editor, selecione
        a resoluç&atilde;o padr&atilde;o do monitor e a profundidade das cores desejada. Isso está
        definido na seç&atilde;o <literal>"Screen"</literal>:</para>

      <programlisting>Section "Screen"
        Identifier "Screen0"
        Device     "Card0"
        Monitor    "Monitor0"
        DefaultDepth 24
        SubSection "Display"
                Depth     24
                Modes     "1024x768"
        EndSubSection
EndSection</programlisting>

      <para>A express&atilde;o <varname>DefaultDepth</varname> descreve 
        a profundidade de cores empregada por padr&atilde;o. Isso pode ser sobreposto
        com a opç&atilde;o da linha de comando <command>-bpp</command> existente para o
        &man.XFree86.1;.
        A express&atilde;o <varname>Modes</varname>
        descreve a resoluç&atilde;o utilizada para a profundidade de cores dada.
        Observe que apenas os modos do padr&atilde;o VESA s&atilde;o suportados pela definiç&atilde;o do
        hardware gráfico do sistema alvo.
        No exemplo acima, a profundidade de cores padr&atilde;o é de vinte e quatro
	bits por ponto. Nesta profundidade de cores, a resoluç&atilde;o aceita é de 
        mil e vinte e quatro pontos por setecentos e sessenta e oito
        pontos.</para>

      <para>Por fim, salve o arquivo de configuraç&otilde;es e teste-o utilizando
        o modo de teste dado acima. Se tudo estiver bem, o arquivo de configuraç&atilde;o
        precisa ser instalado em um local conhecido pelo
        &man.XFree86.1;
        a fim de encontrá-lo.
        Este local é tipicamente a pasta <filename>/etc/X11/XF86Config</filename> ou 
        <filename>/usr/X11R6/etc/X11/XF86Config</filename>.</para>

      <screen>&prompt.root; <userinput>cp XF86Config.new /etc/X11/XF86Config</userinput></screen>

      <para>Uma vez que o arquivo de configuraç&atilde;o tenha sido colocado em um lugar
        conhecido, a configuraç&atilde;o está completa. Para iniciar o
        <application>&xfree86; 4.X</application> com &man.startx.1;,
        instale o <literal>port</literal> <filename role="package">x11/wrapper</filename>.
        O <application>&xfree86; 4.X</application> também pode ser executado via
        &man.xdm.1;.</para>

    <note><para>Também existe uma ferramenta gráfica capaz de fazer a configuraç&atilde;o,
      o &man.xf86cfg.1;, que vem na distribuiç&atilde;o do <application>&xfree86; 4.X</application>
      Ela permite definir interativamente sua configuraç&atilde;o pela escolha
      dos <literal>drivers</literal> e parâmetros apropriados. Este programa pode ser utilizado 
      no console também, basta utilizar o comando <command>xf86cfg - textmode</command>. Para mais detalhes, 
      verifique a página do manual &man.xf86cfg.1;.</para></note>

    </sect2>

    <sect2>
      <title>Tópicos de configuraç&atilde;o avançados</title>

      <sect3>
        <title>Configuraç&atilde;o dos <foreignphrase>Chipsets</foreignphrase> Gráficos &intel; i810</title>

        <indexterm><primary>O <foreignphrase>chipset</foreignphrase> gráfico da Intel i810</primary></indexterm>

        <para>A configuraç&atilde;o dos <foreignphrase>chipsets</foreignphrase> integrados da &intel; i810
          requerem que a interface de programaç&atilde;o para o AGP, <devicename>agpgart</devicename>,
          do <application>&xfree86;</application> seja instalada para
          controlar a placa. O <literal>driver</literal> &man.agp.4; está no <literal>kernel</literal>
          <filename>GENERIC</filename> desde as <literal>releases</literal>
          4.8-RELEASE e 5.0-RELEASE. Nas <literal>releases</literal> anteriores, você deve
          adicionar as linhas a seguir:</para>

    <programlisting>device agp</programlisting>

    <para>no arquivo de configuraç&atilde;o do se <literal>kernel</literal> e reconstruir um novo
      <literal>kernel</literal>. Ao invés disso, você pode querer carregar
          o módulo <filename>agp.ko</filename> do <literal>kernel</literal>
          automaticamente com o &man.loader.8; durante o processo de inicializa&ccedil;&atilde;o.
          Para isso, basta adicionar esta linha ao
          <filename>/boot/loader.conf</filename>:</para>

        <programlisting>agp_load="YES"</programlisting>

        <para>A seguir, se estiver utilizando o FreeBSD&nbsp;4.X ou posterior, um novo nó
          para o dispositivo (<foreignphrase>device node</foreignphrase>) precisa ser criado para
          a interface de programaç&atilde;o. Para criar o nó para o dispositivo AGP, execute
          o &man.MAKEDEV.8; no diretório
          <filename>/dev</filename>:</para>

        <screen>&prompt.root; <userinput>cd /dev</userinput>
&prompt.root; <userinput>sh MAKEDEV agpgart</userinput></screen>

    <note>
      <para>O FreeBSD&nbsp;5.X ou posterior vai utilizar o &man.devfs.5; para alocar
        os nós dos dispositivos de modo transparente, logo, o passo do
        &man.MAKEDEV.8; n&atilde;o é necessário.</para>
    </note>

        <para>Isso vai permitir a configuraç&atilde;o do dispositivo como se faz com qualquer outra
          placa de vídeo. Observe que em sistemas sem o <literal>driver</literal> &man.agp.4;
          compilado no <literal>kernel</literal>, tentar carregar o módulo com
          o &man.kldload.8; n&atilde;o vai funcionar. Este <literal>driver</literal> precisa estar
          no <literal>kernel</literal> durante o processo de inicializa&ccedil;&atilde;o seja sendo compilado ou
          pelo uso do <filename>/boot/loader.conf</filename>.</para>

        <para>Se estiver utilizando o <application>&xfree86; 4.1.0</application> (ou
          posterior) e mensagens sobre símbolos n&atilde;o resolvidos como
          <literal>fbPictureInit</literal> aparecerem, tente adicionar a linha a seguir
          após <literal>Driver "i810"</literal> no arquivo de configuraç&atilde;o
          do <application>&xfree86;</application>:</para>
        <programlisting>Option "NoDDC"</programlisting>
      </sect3>
    </sect2>
  </sect1>

  <sect1 id="x-fonts">
    <sect1info>
      <authorgroup>
        <author>
          <firstname>Murray</firstname>
          <surname>Stokely</surname>
          <contrib>Com contribuiç&otilde;es de </contrib>
        </author>
      </authorgroup>
    </sect1info>
    <title>Usando fontes no &xfree86;</title>

    <sect2 id="type1">
      <title>Fontes <literal>Type1</literal></title>
      <para>As fontes padr&atilde;o que s&atilde;o distribuídas com
        o <application>&xfree86;</application> est&atilde;o aquém do ideal para aplicaç&otilde;es
        comuns de editoraç&atilde;o eletrônica. Fontes grandes em apresentaç&otilde;es aparecem
        recortadas e com aparência nada profissional, e fontes pequenas no
        <application>&netscape;</application> s&atilde;o quase ininteligíveis.
        Entretanto, há várias fontes <literal>Type1</literal> (&postscript;) gratuitas e de alta qualidade 
        disponíveis as quais podem ser usadas imediatamente 
        com o <application>&xfree86;</application>, seja a vers&atilde;o 3.X ou
        a vers&atilde;o 4.X.  Por exemplo, a coleç&atilde;o de fontes URW
        (<filename role="package">x11-fonts/urwfonts</filename>) inclui
        vers&otilde;es de alta qualidade de fontes <literal>type1</literal> padr&atilde;o (<trademark class="registered">Times Roman</trademark>,
        <trademark class="registered">Helvetica</trademark>, <trademark class="registered">Palatino</trademark> e outras). A coleç&atilde;o <literal>Freefonts</literal>
        (<filename role="package">x11-fonts/freefonts</filename>) inclui
        muitas outras fontes, mas a maioria delas s&atilde;o destinadas ao uso em
        softwares de manipulaç&atilde;o de gráficos como o <application>Gimp</application>, n&atilde;o sendo
        suficientemente compleats para o uso como fontes de tela. Para completar,
        o <application>&xfree86;</application> pode ser configurado para usar 
        fontes &truetype; com um mínimo de esforço: veja 
        <link linkend="truetype">seç&atilde;o sobre fontes &truetype;</link> adiante.</para>

      <para>Para instalar as coleç&otilde;es de fontes <literal>Type1</literal> acima da coleç&atilde;o de 
	<literal>ports</literal>, execute os comandos a seguir:</para>

      <screen>&prompt.root; <userinput>cd /usr/ports/x11-fonts/urwfonts</userinput>
&prompt.root; <userinput>make install clean</userinput></screen>

      <para>E da mesma forma para o <literal>freefont</literal> e outras coleç&otilde;es. Para dizer ao servidor X
        que estas fontes existem, adicione a linha apropriada ao
        arquivo <filename>XF86Config</filename> (em <filename>/etc/</filename> para 
        <application>&xfree86;</application> vers&atilde;o 3, ou em
        <filename>/etc/X11/</filename> para a vers&atilde;o 4), onde se lê:</para>

      <programlisting>FontPath "/usr/X11R6/lib/X11/fonts/URW/"</programlisting>

      <para>Alternativamente, na linha de comandos da sess&atilde;o X
        execute:</para>

      <screen>&prompt.user; <userinput>xset fp+ /usr/X11R6/lib/X11/fonts/URW</userinput>
&prompt.user; <userinput>xset fp rehash</userinput></screen>

      <para>Isso vai funcionar mas será perdido quando a sess&atilde;o do X for fechada,
        a menos que seja adicionada ao arquivo de inicializaç&atilde;o (<filename>~/.xinitrc</filename>
        para uma sess&atilde;o normal via <command>startx</command>,
        ou <filename>~/.xsession</filename> quando o registro (<literal>login</literal>) for feito via
        um gerenciador de registro gráfico como o <application>XDM</application>).
        Uma terceira forma é utilizar o novo arquivo
        <filename>XftConfig</filename>: consulte a seç&atilde;o
        sobre <link linkend="antialias">anti-aliasing</link>.
        </para>
    </sect2>

    <sect2 id="truetype">
    <title>Fontes &truetype;</title>

    <indexterm><primary>Fontes TrueType</primary></indexterm>
    <indexterm><primary>fontes</primary>
      <secondary>TrueType</secondary>
    </indexterm>

    <para>O <application>&xfree86; 4.X</application> tem suporte incorporado
      para a exibiç&atilde;o produzida de fontes &truetype;.  Há dois módulos diferentes
      que podem permitir essa funcionalidade. O módulo <literal>freetype</literal> é utilizado
      neste exemplo por ser mais coerente com outros suportes para produç&atilde;o de
      fontes. Para habilitar o módulo <literal>freetype</literal> basta acrescentar
      a linha a seguir à seç&atilde;o <literal>"Module"</literal> do
      arquivo <filename>/etc/X11/XF86Config</filename>.</para>

    <programlisting>Load  "freetype"</programlisting>

    <para>Para o <application>&xfree86; 3.3.X</application>, um servidor
      de fontes &truetype; separado se faz necessário.
      O <application>Xfstt</application> é de uso comum para
      esta finalidade. Para instalar o <application>Xfstt</application>,
      basta instalar o <literal>port</literal>
      <filename role="package">x11-servers/Xfstt</filename>.</para>

    <para>Crie uma pasta para as fontes &truetype; (por exemplo,
      <filename>/usr/X11R6/lib/X11/fonts/TrueType</filename>)
      e copie todas as fontes &truetype; nesta pasta. Tenha em mente
      que as fontes &truetype; n&atilde;o podem ser importadas diretamente de um
      &macintosh;; elas precisam esta no formato &unix;/DOS/&windows; para que possa ser usada pelo
      <application>&xfree86;</application>. Uma vez que os arquivos tenham sido
      copiados para esta pasta, use o 
      <application>ttmkfdir</application> para criar um arquivo
      <filename>fonts.dir</filename>, de modo que o produtor de fontes do X
      saiba que estes novos arquivos foram instalados.
      O <command>ttmkfdir</command> está disponível na
      Coleç&atilde;o de <literal>Ports</literal> do FreeBSD como
      <filename role="package">x11-fonts/ttmkfdir</filename>.</para>

    <screen>&prompt.root; <userinput>cd /usr/X11R6/lib/X11/fonts/TrueType</userinput>
&prompt.root; <userinput>ttmkfdir > fonts.dir</userinput></screen>

    <para>Agora adicione a pasta &truetype; no caminho para as fontes (o <foreignphrase>font
      path</foreignphrase>). Esta é a mesma descriç&atilde;o utilizada anteriormente para as fontes <link
      linkend="type1">Type1</link>, isto é, utilize</para>

    <screen>&prompt.user; <userinput>xset fp+ /usr/X11R6/lib/X11/fonts/TrueType</userinput>
&prompt.user; <userinput>xset fp rehash</userinput></screen>

    <para>ou adicione uma linha <option>FontPath</option> ao arquivo
       <filename>XF86Config</filename>.</para>

      <para>Isso é tudo. Agora o <application>&netscape;</application>,
        o <application>Gimp</application>,
        o <application>&staroffice;</application>, e todos os outros aplicativos
        do X devem estar reconhecendo as fontes &truetype; instaladas.
        Fontes muito pequenas (como um texto em um vídeo de alta resoluç&atilde;o
        de uma página da internet) e fontes muito grandes (dentro do
        <application>&staroffice;</application>) v&atilde;o ter uma aparência muito melhor
        agora.</para>
    </sect2>

    <sect2 id="antialias">
    <sect2info>
      <authorgroup>
        <author>
          <firstname>Joe Marcus</firstname>
          <surname>Clarke</surname>
          <contrib>Atualizado para o &xfree86; 4.3 por </contrib>
          <!-- Maio 2003 -->
        </author>
      </authorgroup>
    </sect2info>
    <title>Fontes com Anti-Alias</title>

    <indexterm><primary>fontes com anti-alias</primary></indexterm>
    <indexterm><primary>fontes</primary>
      <secondary>anti-alias</secondary></indexterm>

    <para>O <foreignphrase>Anti-aliasing</foreignphrase> está disponível no
      <application>&xfree86;</application> desde a vers&atilde;o 4.0.2. Mesmo assim, 
      configurar tais fontes era incômodo antes da introduç&atilde;o do
      <application>&xfree86;</application> 4.3.0. Da vers&atilde; 4.3.0 em diante,
      todas as fontes em <filename>/usr/X11R6/lib/X11/fonts/</filename> e 
      em <filename>~/.fonts/</filename> s&atilde;o automaticamente
      disponibilizadas com <foreignphrase>anti-aliasing</foreignphrase> para os aplicativos prontos para o 
      Xft. Nem todas as aplicaç&otilde;es s&atilde;o preparadas para usar o Xft ainda, mas muitas 
      já contam com o suporte Xft. Exemplos de aplicaç&otilde;es que reconhecem o Xft incluem o Qt 2.3 
      e posteriores (conjunto de ferramentas feito para a área de trabalho do <application>KDE</application>),
      Gtk+ 2.0 e posteriores (conjunto de ferramentas para a área de trabalho do
      <application>GNOME</application>), e o 
      <application>Mozilla</application> 1.2 e posteriores.
    </para>

    <para>Para distinguir que fontes s&atilde;o <foreignphrase>anti-aliased</foreignphrase>, ou
      configurar as propriedades do <foreignphrase>anti-aliasing</foreignphrase>, crie (ou edite, se
      já existir) o arquivo
      <filename>/usr/X11R6/etc/fonts/local.conf</filename>. Vários
      recursos avançados do sistema de fontes Xft podem ser ajustadas através
      deste arquivo; esta seç&atilde;o descreve apenas algumas possibilidades
      simples. Para mais detalhes, por favor verifique em
      &man.fonts-conf.5;.</para>

    <indexterm><primary>XML</primary></indexterm>

    <para>Este arquivo deve ser em formato XML. Preste bastante atenç&atilde;o a
      caixa dos caracteres, e assegure-se de ter fechado todos os rótulos (<foreignphrase>tags</foreignphrase>).
      O arquivo começa com o cabeçalho usual do XML seguido de uma definiç&atilde;o DOCTYPE,
      e ent&atilde;o pelo rótulo <literal>&lt;fontconfig&gt;</literal>:</para>

    <programlisting>
      &lt;?xml version="1.0"?&gt;
      &lt;!DOCTYPE fontconfig SYSTEM "fonts.dtd"&gt;
      &lt;fontconfig&gt;
    </programlisting>

    <para>Como citado anteriormente, toda fonte em
      <filename>/usr/X11R6/lib/X11/fonts/</filename> bem como em
      <filename>~/.fonts/</filename> s&atilde;o automaticamente disponibilizadas para
      aplicaç&otilde;es prontas para o Xft. Se você deseja acrescentar outra pasta
      que esteja fora dessas duas hierarquias, acrescente uma linha similar a apresentada abaixo
      ao arquivo 
      <filename>/usr/X11R6/etc/fonts/local.conf</filename>:</para>

    <programlisting>&lt;dir&gt;/path/to/my/fonts&lt;/dir&gt;</programlisting>

    <para>Após acrescentar novas fontes, e especialmente novas pastas com fontes,
      você deve executar o comando a seguir para reconstruir os <foreignphrase>caches</foreignphrase>
      de fonte:</para>

    <screen>&prompt.root; <userinput>fc-cache -f</userinput></screen>

    <para>O <foreignphrase>anti-aliasing</foreignphrase> torna as bordas pouco nítidas, o que proporciona 
      a textos pequenos maior legibilidade e remove <quote>escadinhas</quote> de  
      textos grandes, mas pode causar fatiga visual se aplicado ao texto normal. Para
      excluir fontes com tamanho em pontos menor 14 do <foreignphrase>anti-aliasing</foreignphrase>, inclua
      estas linhas:</para>

      <programlisting>        &lt;match target="font"&gt;
            &lt;test name="size" compare="less"&gt;
                &lt;double&gt;14&lt;/double&gt;
            &lt;/test&gt;
            &lt;edit name="antialias" mode="assign"&gt;
                &lt;bool&gt;false&lt;/bool&gt;
            &lt;/edit&gt;
        &lt;/match&gt;</programlisting>

    <indexterm><primary>fontes</primary>
      <secondary>espaçamento</secondary></indexterm>

    <para>O espaçamento para fontes monoespaçadas também pode ser inapropriado
      com o <foreignphrase>anti-aliasing</foreignphrase>. Isso parece ser uma quest&atilde;o presente
      no <application>KDE</application>, em particular. Uma correç&atilde;o possível para
      isso é forçar o espaçamento destas fontes para 100. Acrescente
      as seguintes linhas:</para>

    <programlisting>       &lt;match target="pattern" name="family"&gt;
           &lt;test qual="any" name="family"&gt;
               &lt;string&gt;fixed&lt;/string&gt;
           &lt;/test&gt;
           &lt;edit name="family" mode="assign"&gt;
               &lt;string&gt;mono&lt;/string&gt;
           &lt;/edit&gt;
        &lt;/match&gt;
        &lt;match target="pattern" name="family"&gt;
            &lt;test qual="any" name="family"&gt;
                &lt;string&gt;console&lt;/string&gt;
            &lt;/test&gt;
            &lt;edit name="family" mode="assign"&gt;
                &lt;string&gt;mono&lt;/string&gt;
            &lt;/edit&gt;
        &lt;/match&gt;</programlisting>

      <para>(isso apelidará todo nome comum para fontes fixas como 
        <literal>"mono"</literal>), e ent&atilde;o acrescente:</para>

      <programlisting>         &lt;match target="pattern" name="family"&gt;
             &lt;test qual="any" name="family"&gt;
                 &lt;string&gt;mono&lt;/string&gt;
             &lt;/test&gt;
             &lt;edit name="spacing" mode="assign"&gt;
                 &lt;int&gt;100&lt;/int&gt;
             &lt;/edit&gt;
         &lt;/match&gt;      </programlisting>

      <para>Certas fontes, como a Helvetica, podem apresentar problemas quando
        usadas com <foreignphrase>anti-alias</foreignphrase>. Geralmente isso se apreseta como
        uma fonte que parece cortada ao meio verticalmente. No pior caso, isso pode causar a
        parada na execuç&atilde;o de aplicativos como o <application>Mozilla</application>.
        Para evitar isso, considere acrescentar o seguinte ao arquivo
        <filename>local.conf</filename>:</para>

      <programlisting>         &lt;match target="pattern" name="family"&gt;
             &lt;test qual="any" name="family"&gt;
                 &lt;string&gt;Helvetica&lt;/string&gt;
             &lt;/test&gt;
             &lt;edit name="family" mode="assign"&gt;
                 &lt;string&gt;sans-serif&lt;/string&gt;
             &lt;/edit&gt;
         &lt;/match&gt;        </programlisting>

      <para>Uma vez terminada a ediç&atilde;o do
        <filename>local.conf</filename> assegure-se de colocar no final do arquivo
        o rótulo <literal>&lt;/fontconfig&gt;</literal>. N&atilde;o fazê-lo fará que suas
        modificaç&otilde;es sejam desprezadas.</para>

      <para>O conjunto padr&atilde;o de fontes que vem com
        o <application>&xfree86;</application> n&atilde;o é muito
        conveniente quando se trata de <literal>anti-alias</literal>. Um conjunto bem melhor
        de fontes padr&atilde;o pode ser encontrado no <literal>port</literal>
        <filename role="package">x11-fonts/bitstream-vera</filename>.
        Esse <literal>port</literal> irá instalar um arquivo
        <filename>/usr/X11R6/etc/fonts/local.conf</filename>
        se ele n&atilde;o existir. Se o arquivo existir, o <literal>port</literal>
        var criar o arquivo <filename>/usr/X11R6/etc/fonts/local.conf-vera
        </filename>. Faça a fus&atilde;o do conteúdo deste arquivo com o
        <filename>/usr/X11R6/etc/fonts/local.conf</filename>, e as fontes
        <literal>Bitstream</literal> automaticamente substituir&atilde;o as fontes
        Serif, Sans Serif e Monospaced padr&atilde;o do <application>&xfree86;</application>. 
        </para>

      <para>Por fim, os usuários podem acresentar suas próprias configuraç&otilde;es em seus
        arquivos <filename>.fonts.conf</filename> pessoais. Para fazer isso, cada usuário deve
        apenas criar o arquivo <filename>~/.fonts.conf</filename>. Este arquivo precisa também
        estar no formato XML.</para>

      <indexterm><primary>Telas LCD</primary></indexterm>
      <indexterm><primary>Fontes</primary>
        <secondary>Telas LCD</secondary></indexterm>

      <para>Um último ponto: com telas de LCD, amostragem de subpontos pode
        ser desejável. Isso basicamente trata os componentes (horizontalmente separados)
        vermelho, verde e azul separadamente a fim de melhorar a resoluç&atilde;o horizontal;
        os resultados podem ser espetaculares. Para permitir isso, acrescente a
        linha em algum lugar do arquivo <filename>local.conf</filename>:</para>

      <programlisting>
        &lt;match target="font"&gt;
            &lt;test qual="all" name="rgba"&gt;
                &lt;const&gt;unknown&lt;/const&gt;
            &lt;/test&gt;
            &lt;edit name="rgba" mode="assign"&gt;
                &lt;const&gt;rgb&lt;/const&gt;
            &lt;/edit&gt;
        &lt;/match&gt;
      </programlisting>

      <note><para>Conforme o tipo de tela, o
        <literal>rgb</literal> pode precisar ser substituído por <literal>bgr</literal>,
        <literal>vrgb</literal> ou <literal>vbgr</literal>: experimente e
        veja qual funciona melhor.</para></note>

      <indexterm><primary>Mozilla</primary></indexterm>
      <indexterm><primary>navegadores da www</primary>
        <secondary>Mozilla</secondary>
        <see>Mozilla</see></indexterm>

      <para>O <foreignphrase>anti-aliasing</foreignphrase> deve estar habilitado na próxima vez que
        o servidor X for iniciado. Entretanto, os programas precisam saber como tirar vantage
        disso. No presente, o conjunto de ferramentas Qt o faz, logo
        todo o ambiente do KDE pode <application>KDE</application> pode utilizar fontes
        com <foreignphrase>anti-alias</foreignphrase> (veja <xref
        linkend="x11-wm-kde-antialias"> sobre o
        <application>KDE</application> para detalhes). O Gtk+ e o
        <application>GNOME</application> também podem ser adaptados ao 
        <foreignphrase>anti-alias</foreignphrase> através do <literal>capplet</literal> <quote>Font</quote> (veja <xref
        linkend="x11-wm-gnome-antialias"> para mais detalhes). Por padr&atilde;o,
        o <application>Mozilla</application> 1.2 e posteriores v&atilde;o
        usar o <foreignphrase>anti-alias</foreignphrase> automaticamente. Para desativar isso, reconstrua
        o <application>Mozilla</application> com o parâmetro
        <makevar>-DWITHOUT_XFT</makevar>.</para>
    </sect2>
  </sect1>

  <sect1 id="x-xdm">
    <sect1info>
      <authorgroup>
        <author>
          <firstname>Seth</firstname>
          <surname>Kingsley</surname>
          <contrib>Contribuiç&otilde;es de </contrib>
        </author>
      </authorgroup>
    </sect1info>
    <title>The X Display Manager</title>
    <sect2>
      <title>Overview</title>

      <indexterm><primary>O Gerenciador de Exibiç&atilde;o do X (XDM)</primary></indexterm>
      <para>O Gerenciador de Exibiç&atilde;o do X (<application>XDM</application>; n.t. de 
        <literal>X Display Manager</literal>) é uma parte opcional do Sistema de Janela X que é usado para gerenciar
        o <literal>login</literal> nas sess&otilde;es. Isso é útil em vários tipos de
        situaç&otilde;es, incluindo áreas de trabalho como <quote>Terminais X</quote> mínimos
        e grandes servidores de exibiç&atilde;o para rede.
        Como o Sistema de Janela X é independente de rede e protocolos,
        há uma grande variedade de configuraç&otilde;es possíveis
        para a execuç&atilde;o de clientes e servidores X em máquinas diferentes
        e conectadas a rede. O <application>XDM</application> fornece
        uma interface gráfica que possibilita escolher o servidor de exibiç&atilde;o no qual se quer conectar
        e a entrada de informaç&otilde;es de autorizaç&atilde;o como o
        a combinaç&atilde;o de <literal>login</literal> e senha.</para>

      <para>Pense no <application>XDM</application> como  
        o provedor da mesma funcionalidade para o usuário proporcionada pelo
        utilitário &man.getty.8; (veja <xref linkend="term-config"> para 
        detalhes). Isto é, ele faz o <literal>login</literal> no sistema da tela a que se
        está conectado e ent&atilde;o executa um gerente de sess&atilde;o a favor 
        do usuário (geralmente um gerente de janela X).
        O <application>XDM</application> ent&atilde;o aguarda o término
        do programa, sinalizando que o usuário terminou e que deve ser
        feito seu <literal>log out</literal> da tela. Neste ponto,
        o <application>XDM</application> pode exibir a tela de <literal>login</literal> e exibir
        telas com opç&otilde;es para que o próximo usuário faça seu <literal>login</literal>.</para>
    </sect2>

    <sect2>
      <title>Usando o XDM</title>

      <para>O <application>XDM</application> daemon program is
        located in <filename>/usr/X11R6/bin/xdm</filename>.  This program
        can be run at any time as <username>root</username> and it will
        start managing the X display on the local machine.  If
        <application>XDM</application> is to be run every
        time the machine boots up, a convenient way to do this is by
        adding an entry to <filename>/etc/ttys</filename>.  For more
        information about the format and usage of this file, see <xref
        linkend="term-etcttys">.  There is a line in the default
        <filename>/etc/ttys</filename> file for running the
        <application>XDM</application> daemon on a virtual terminal:</para>

      <screen>ttyv8   "/usr/X11R6/bin/xdm -nodaemon"  xterm   off secure</screen>

      <para>By default this entry is disabled; in order to enable it
        change field 5 from <literal>off</literal> to
        <literal>on</literal> and restart &man.init.8; using the
        directions in <xref linkend="term-hup">.  The first field, the
        name of the terminal this program will manage, is
        <literal>ttyv8</literal>.  This means that
        <application>XDM</application> will start running on the 9th
        virtual terminal.</para>
    </sect2>

    <sect2>
      <title>Configuring XDM</title>

      <para>The <application>XDM</application> configuration directory
        is located in <filename>/usr/X11R6/lib/X11/xdm</filename>.  In
        this directory there are several files used to change the
        behavior and appearance of
        <application>XDM</application>.  Typically these files will
        be found:</para>

        <informaltable frame="none">
          <tgroup cols="2">
            <thead>
              <row>
                <entry>File</entry>
                <entry>Description</entry>
              </row>
            </thead>

            <tbody>
              <row>
                <entry><filename>Xaccess</filename></entry>
                <entry>Client authorization ruleset.</entry>
              </row>

              <row>
                <entry><filename>Xresources</filename></entry>
                <entry>Default X resource values.</entry>
              </row>

              <row>
                <entry><filename>Xservers</filename></entry>
                <entry>List of remote and local displays to manage.</entry>
              </row>

              <row>
                <entry><filename>Xsession</filename></entry>
                <entry>Default session script for logins.</entry>
              </row>

              <row>
                <entry><filename>Xsetup_</filename>*</entry>
                <entry>Script to launch applications before the login
                  interface.</entry>
              </row>

              <row>
                <entry><filename>xdm-config</filename></entry>
                <entry>Global configuration for all displays running on
                  this machine.</entry>
              </row>

              <row>
                <entry><filename>xdm-errors</filename></entry>
                <entry>Errors generated by the server program.</entry>
              </row>

              <row>
                <entry><filename>xdm-pid</filename></entry>
                <entry>The process ID of the currently running XDM.</entry>
              </row>
            </tbody>
          </tgroup>
        </informaltable>

      <para>Also in this directory are a few scripts and programs used
        to set up the desktop when <application>XDM</application> is
        running.  The purpose of each of these files will be briefly
        described.  The exact syntax and usage of all of these files is
        described in &man.xdm.1;.</para>

      <para>The default configuration is a simple rectangular login
        window with the hostname of the machine displayed at the top in
        a large font and <quote>Login:</quote> and
        <quote>Password:</quote> prompts below.  This is a good starting
        point for changing the look and feel of
        <application>XDM</application> screens.</para>

      <sect3>
        <title>Xaccess</title>

        <para>The protocol for connecting to
          <application>XDM</application> controlled displays is called
          the X Display Manager Connection Protocol (XDMCP).  This file
          is a ruleset for controlling XDMCP connections from remote
          machines.  By default, it allows any client to connect, but
          that does not matter unless the <filename>xdm-config</filename>
          is changed to listen for remote connections.</para>
      </sect3>

      <sect3>
        <title>Xresources</title>
        <para>This is an application-defaults file for the display
          chooser and the login screens.  This is where the appearance
          of the login program can be modified.  The format is identical
          to the app-defaults file described in the
          <application>&xfree86;</application> documentation.</para>
      </sect3>

      <sect3>
        <title>Xservers</title>
        <para>This is a list of the remote displays the chooser should
          provide as choices.</para>
      </sect3>

      <sect3>
        <title>Xsession</title>
        <para>This is the default session script for
          <application>XDM</application> to run after a user has logged
          in.  Normally each user will have a customized session script
          in <filename>~/.xsession</filename> that overrides this
          script.</para>
      </sect3>

      <sect3>
        <title>Xsetup_*</title>
        <para>These will be run automatically before displaying the
          chooser or login interfaces.  There is a script for each
          display being used, named <filename>Xsetup_</filename> followed
          by the local display number (for instance
          <filename>Xsetup_0</filename>).  Typically these scripts will
          run one or two programs in the background such as
          <command>xconsole</command>.</para>
      </sect3>

      <sect3>
        <title>xdm-config</title>
        <para>This contains settings in the form of app-defaults
          that are applicable to every display that this installation
          manages.</para>
      </sect3>

      <sect3>
        <title>xdm-errors</title>
        <para>This contains the output of the X servers that
          <application>XDM</application> is trying to run.  If a display
          that <application>XDM</application> is trying to start hangs
          for some reason, this is a good place to look for error
          messages.  These messages are also written to the user's
          <filename>~/.xsession-errors</filename> file on a per-session
          basis.</para>
      </sect3>
    </sect2>

    <sect2>
      <title>Running a Network Display Server</title>

      <para>In order for other clients to connect to the display
        server, edit the access control rules, and enable the connection
        listener.  By default these are set to conservative values.
        To make <application>XDM</application> listen for connections,
        first comment out a line in the <filename>xdm-config</filename>
        file:</para>

      <screen>! SECURITY: do not listen for XDMCP or Chooser requests
! Comment out this line if you want to manage X terminals with xdm
DisplayManager.requestPort:     0</screen>

      <para>and then restart <application>XDM</application>.  Remember that
        comments in app-defaults files begin with a <quote>!</quote>
        character, not the usual <quote>#</quote>.  More strict
        access controls may be desired.  Look at the example
        entries in <filename>Xaccess</filename>, and refer to the
        &man.xdm.1; manual page.</para>
    </sect2>

     <sect2>
        <title>Replacements for XDM</title>

        <para>Several replacements for the default
          <application>XDM</application> program exist.  One of them,
          <application>KDM</application> (bundled with
          <application>KDE</application>) is described later in this
          chapter.  <application>KDM</application> offers many visual
          improvements and cosmetic frills, as well as the
          functionality to allow users to choose their window manager
          of choice at login time.</para>
     </sect2>
  </sect1>

  <sect1 id="x11-wm">
    <sect1info>
      <authorgroup>
        <author>
          <firstname>Valentino</firstname>
          <surname>Vaschetto</surname>
          <contrib>Contributed by </contrib>
        </author>
        <!-- June 2001 -->
      </authorgroup>
    </sect1info>

    <title>Desktop Environments</title>

    <para>This section describes the different desktop environments
      available for X on FreeBSD.  A <quote>desktop environment</quote>
      can mean anything ranging from a simple window manager to a
      complete suite of desktop applications, such as
      <application>KDE</application> or <application>GNOME</application>.
    </para>

    <sect2 id="x11-wm-gnome">
      <title>GNOME</title>

      <sect3 id="x11-wm-gnome-about">
        <title>About GNOME</title>

        <indexterm><primary>GNOME</primary></indexterm>
        <para><application>GNOME</application> is a user-friendly
          desktop environment that enables users to easily use and
          configure their computers.  <application>GNOME</application>
          includes a panel (for starting applications and displaying
          status), a desktop (where data and applications can be
          placed), a set of standard desktop tools and applications, and
          a set of conventions that make it easy for applications to
          cooperate and be consistent with each other.  Users of other
          operating systems or environments should feel right at home
          using the powerful graphics-driven environment that
          <application>GNOME</application> provides.  More
      information regarding <application>GNOME</application> on
      FreeBSD can be found on the <ulink
      url="http://www.FreeBSD.org/gnome">FreeBSD GNOME
      Project</ulink>'s web site.</para>
      </sect3>

      <sect3 id="x11-wm-gnome-install">
        <title>Installing GNOME</title>

        <para>The easiest way to install
          <application>GNOME</application> is through the
          <quote>Desktop Configuration</quote> menu during the FreeBSD
      installation process as described in <xref
      linkend="default-desktop"> of Chapter&nbsp;2.  It can also
          be easily installed from a package or the ports
          collection:</para>

        <para>To install the <application>GNOME</application> package
          from the network, simply type:</para>

        <screen>&prompt.root; <userinput>pkg_add -r gnome2</userinput></screen>

        <para>To build <application>GNOME</application> from source, use
          the ports tree:</para>

        <screen>&prompt.root; <userinput>cd /usr/ports/x11/gnome2</userinput>
&prompt.root; <userinput>make install clean</userinput></screen>

        <para>Once <application>GNOME</application> is installed,
          the X server must be told to start
          <application>GNOME</application> instead of a default window
          manager.  If a custom <filename>.xinitrc</filename> is already in
          place, simply replace the line that starts the current window
          manager with one that starts
          <application>/usr/X11R6/bin/gnome-session</application> instead.
          If nothing special has been done to configuration file,
          then it is enough to simply type:</para>

        <screen>&prompt.user; <userinput>echo "/usr/X11R6/bin/gnome-session" &gt; ~/.xinitrc</userinput></screen>

        <para>Next, type <command>startx</command>, and the
          <application>GNOME</application> desktop environment will be
          started.</para>

        <note><para>If a display manager, like
          <application>XDM</application>, is being used, this will not work.
          Instead, create an executable <filename>.xsession</filename>
          file with the same command in it.  To do this, edit the file
          and replace the existing window manager command with
          <application>/usr/X11R6/bin/gnome-session</application>:
          </para></note>

        <screen>&prompt.user; <userinput>echo "#!/bin/sh" > ~/.xsession</userinput>
&prompt.user; <userinput>echo "/usr/X11R6/bin/gnome-session" >> ~/.xsession</userinput>
&prompt.user; <userinput>chmod +x ~/.xsession</userinput></screen>

        <para>Another option is to configure the display manager to
          allow choosing the window manager at login time; the section on
          <link linkend="x11-wm-kde-details">KDE details</link>
          explains how to do this for <application>kdm</application>, the
          display manager of <application>KDE</application>.</para>
      </sect3>

      <sect3 id="x11-wm-gnome-antialias">
        <title>Anti-aliased Fonts with GNOME</title>

        <indexterm><primary>GNOME</primary>
          <secondary>anti-aliased fonts</secondary></indexterm>
    <para>Starting with version 4.0.2, <application>&xfree86;</application>
      supports anti-aliasing via its <quote>RENDER</quote> extension.
      Gtk+ 2.0 and greater (the toolkit used by
      <application>GNOME</application>) can make use of this
      functionality.  Configuring anti-aliasing is described in
      <xref linkend="antialias">.  So, with up-to-date software,
      anti-aliasing is possible within the
      <application>GNOME</application> desktop.  Just go to
      <menuchoice>
        <guimenu>Applications</guimenu>
        <guisubmenu>Desktop Preferences</guisubmenu>
        <guimenuitem>Font</guimenuitem></menuchoice>, and select either
      <guibutton>Best shapes</guibutton>,
      <guibutton>Best contrast</guibutton>, or
      <guibutton>Subpixel smoothing (LCDs)</guibutton>.  For a
      Gtk+ application that is not part of the
      <application>GNOME</application> desktop, set the
      environment variable <varname>GDK_USE_XFT</varname> to
      <literal>1</literal> before launching the program.</para>
      </sect3>
    </sect2>

    <sect2 id="x11-wm-kde">
      <title>KDE</title>

      <indexterm><primary>KDE</primary></indexterm>
      <sect3 id="x11-wm-kde-about">
        <title>About KDE</title>

        <para><application>KDE</application> is an easy to use
          contemporary desktop environment.  Some of the things that
          <application>KDE</application> brings to the user are:</para>

        <itemizedlist>
          <listitem>
        <para>A beautiful contemporary desktop</para>
      </listitem>

          <listitem>
        <para>A desktop exhibiting complete network transparency</para>
      </listitem>

          <listitem>
        <para>An integrated help system allowing for convenient,
          consistent access to help on the use of the
          <application>KDE</application> desktop and its
          applications</para>
      </listitem>

          <listitem>
        <para>Consistent look and feel of all
              <application>KDE</application> applications</para>
      </listitem>

          <listitem>
        <para>Standardized menu and toolbars, keybindings, color-schemes,
          etc.</para>
      </listitem>

          <listitem>
        <para>Internationalization: <application>KDE</application>
              is available in more than 40 languages</para>
      </listitem>

          <listitem>
        <para>Centralized consisted dialog driven desktop
          configuration</para>
      </listitem>

          <listitem>
        <para>A great number of useful
              <application>KDE</application> applications</para>
      </listitem>
        </itemizedlist>

        <para><application>KDE</application> has an office application
          suite based on <application>KDE</application>'s
          <quote>KParts</quote> technology consisting
          of a spread-sheet, a presentation application, an organizer, a
          news client and more.  <application>KDE</application> also
          comes with a web browser called
          <application>Konqueror</application>, which represents
          a solid competitor to other existing web browsers on &unix;
          systems.  More information on <application>KDE</application>
          can be found on the <ulink url="http://www.kde.org/">KDE
          website</ulink>.  For FreeBSD specific informations and
      resources on <application>KDE</application>, consult
      the <ulink url="http://freebsd.kde.org/">FreeBSD-KDE
      team</ulink>'s website.</para>
      </sect3>

      <sect3 id="x11-wm-kde-install">
        <title>Installing KDE</title>

        <para>Just as with <application>GNOME</application> or any
          other desktop environment, the easiest way to install
          <application>KDE</application> is through the <quote>Desktop
          Configuration</quote> menu during the FreeBSD installation
      process as described in <xref linkend="default-desktop"> of Chapter
      2.  Once again, the software can be easily installed from a package
      or from the ports collection:</para>

        <para>To install the <application>KDE</application> package
          from the network, simply type:</para>

        <screen>&prompt.root; <userinput>pkg_add -r kde</userinput></screen>

    <para>&man.pkg.add.1; will automatically fetch the latest version
      of the application.</para>

        <para>To build <application>KDE</application> from source,
          use the ports tree:</para>

        <screen>&prompt.root; <userinput>cd /usr/ports/x11/kde3</userinput>
&prompt.root; <userinput>make install clean</userinput></screen>

        <para>After <application>KDE</application> has been installed,
          the X server must be told to launch this application
          instead of the default window manager.  This is accomplished
          by editing the <filename>.xinitrc</filename> file:</para>

        <screen>&prompt.user; <userinput>echo "exec startkde" &gt; ~/.xinitrc</userinput></screen>

    <para>Now, whenever the X Window System is invoked with
      <command>startx</command>,
          <application>KDE</application> will be the desktop.</para>

        <para>If a display manager such as
          <application>xdm</application> is being used, the
          configuration is slightly different.  Edit the
          <filename>.xsession</filename> file instead.  Instructions
          for <application>kdm</application> are described later in
          this chapter.</para>
      </sect3>
    </sect2>

    <sect2 id="x11-wm-kde-details">
        <title>More Details on KDE</title>

        <para>Now that <application>KDE</application> is installed on
          the system, most things can be discovered through the
          help pages, or just by pointing and clicking at various menus.
          &windows; or &mac; users will feel quite at home.</para>

        <para>The best reference for <application>KDE</application> is
          the on-line documentation.  <application>KDE</application>
          comes with its own web browser,
          <application>Konqueror</application>, dozens of useful
          applications, and extensive documentation.  The remainder of
          this section discusses the technical items that are
          difficult to learn by random exploration.</para>

      <sect3 id="x11-wm-kde-kdm">
        <title>The KDE Display Manager</title>

        <indexterm><primary>KDE</primary>
          <secondary>display manager</secondary></indexterm>
        <para>An administrator of a multi-user system may wish to have
          a graphical login screen to welcome users.
          <link linkend="x-xdm"><filename>xdm</filename></link> can be
          used, as described earlier.  However,
          <application>KDE</application> includes an
          alternative, <application>kdm</application>, which is designed
          to look more attractive and include more login-time options.
          In particular, users can easily choose (via a menu) which
          desktop environment (<application>KDE</application>,
          <application>GNOME</application>, or something else) to run
          after logging on.</para>

        <para>To begin with, run the <application>KDE</application>
          control panel, <command>kcontrol</command>, as
          <username>root</username>.  It is generally considered
          unsafe to run the entire X environment as
          <username>root</username>.  Instead, run the window manager
          as a normal user, open a terminal window (such as
          <filename>xterm</filename> or <application>KDE</application>'s
          <filename>konsole</filename>), become <username>root</username>
          with <userinput>su</userinput> (the user must be in the
          <groupname>wheel</groupname>
          group in <filename>/etc/group</filename> for this), and then
          type <userinput>kcontrol</userinput>.</para>

    <para>Click on the icon on the left marked
      <guibutton>System</guibutton>, then on <guibutton>Login
      manager</guibutton>.  On the right there are
          various configurable options, which the
          <application>KDE</application> manual will explain in greater
          detail.  Click on <guibutton>sessions</guibutton> on the right.
          Click <guibutton>New type</guibutton> to add various window
          managers and desktop environments.  These are just labels,
          so they can say <application>KDE</application> and
          <application>GNOME</application> rather than
          <application>startkde</application> or
          <application>gnome-session</application>.
          Include a label <literal>failsafe</literal>.</para>

        <para>Play with the other menus as well, they are mainly
          cosmetic and self-explanatory.  When you are done, click on
          <guibutton>Apply</guibutton> at the bottom, and quit the
          control center.</para>

        <para>To make sure <application>kdm</application> understands
          what the labels (<application>KDE</application>,
          <application>GNOME</application> etc) mean, edit the files used
          by <link linkend="x-xdm">xdm</link>.
          <note><para>In <application>KDE 2.2</application> this has
            changed: <application>kdm</application> now uses its own
            configuration files.  Please see the <application>KDE
            2.2</application> documentation for details.</para>
          </note>
          In a terminal window, as <username>root</username>,
          edit the file
          <filename>/usr/X11R6/lib/X11/xdm/Xsession</filename>.  There is
          a section in the middle like this:</para>

    <screen>case $# in
1)
        case $1 in
        failsafe)
                exec xterm -geometry 80x24-0-0
                ;;
        esac
esac</screen>

        <para>A few lines need to be added to this section.
          Assuming the labels from used were <quote>KDE</quote> and
          <quote>GNOME</quote>,
          use the following:</para>

    <screen>case $# in
1)
        case $1 in
        kde)
                exec /usr/local/bin/startkde
                ;;
        GNOME)
                exec /usr/X11R6/bin/gnome-session
                ;;
        failsafe)
                exec xterm -geometry 80x24-0-0
                ;;
        esac
esac</screen>

        <para>For the <application>KDE</application>
          login-time desktop background to be honored,
          the following line needs to be added to
          <filename>/usr/X11R6/lib/X11/xdm/Xsetup_0</filename>:</para>

        <screen>/usr/local/bin/kdmdesktop</screen>

        <para>Now, make sure <application>kdm</application> is listed in
          <filename>/etc/ttys</filename> to be started at the next bootup.
          To do this, simply follow the instructions from the previous
          section on <link linkend="x-xdm">xdm</link> and replace
          references to the <command>/usr/X11R6/bin/xdm</command>
          program with <command>/usr/local/bin/kdm</command>.</para>
      </sect3>

      <sect3 id="x11-wm-kde-antialias">
        <title>Anti-aliased Fonts</title>

        <indexterm><primary>KDE</primary>
          <secondary>anti-aliased fonts</secondary></indexterm>
        <para>Starting with version 4.0.2,
          <application>&xfree86;</application> supports anti-aliasing via
      its <quote>RENDER</quote> extension, and starting with version 2.3,
      Qt (the toolkit used by <application>KDE</application>) supports
      this extension.  Configuring this is described in <xref
          linkend="antialias"> on antialiasing X11 fonts.  So, with
          up-to-date software, anti-aliasing is possible on a
          <application>KDE</application> desktop.  Just go to the KDE
      menu, go to
      <menuchoice>
        <guimenu>Preferences</guimenu>
        <guisubmenu>Look and Feel</guisubmenu>
        <guimenuitem>Fonts</guimenuitem></menuchoice>, and click on the check box
          <guibutton>Use Anti-Aliasing for Fonts and Icons</guibutton>.
          For a Qt application which is not part of
      <application>KDE</application>, the environment variable
      <varname>QT_XFT</varname> needs to be set to <literal>true</literal>
      before starting the program.</para>

       </sect3>
     </sect2>

     <sect2 id="x11-wm-xfce">
         <title>XFce</title>
       <sect3 id="x11-wm-xfce-about">
         <title>About XFce</title>

        <para><application>XFce</application> is a desktop environment
          based on the GTK
          toolkit used by <application>GNOME</application>, but is much
          more lightweight and meant for those who want a simple,
          efficient desktop which is nevertheless easy to use and
          configure.  Visually, it looks very much like
          <application>CDE</application>, found on commercial &unix;
          systems.  Some of <application>XFce</application>'s features
          are:</para>

         <itemizedlist>
           <listitem>
         <para>A simple, easy-to-handle desktop</para>
           </listitem>

           <listitem>
         <para>Fully configurable via mouse, with drag and
               drop, etc </para>
           </listitem>

           <listitem>
         <para>Main panel similar to <application>CDE</application>, with
           menus, applets and applications launchers</para>
           </listitem>

           <listitem>
         <para>Integrated window manager, file manager, sound manager,
           <application>GNOME</application> compliance module, and other
           things</para>
           </listitem>

           <listitem>
         <para>Themeable (since it uses GTK)</para>
           </listitem>

           <listitem>
         <para>Fast, light and efficient: ideal for older/slower machines
           or machines with memory limitations</para>
           </listitem>
         </itemizedlist>

         <para>More information on <application>XFce</application>
          can be found on the <ulink url="http://www.xfce.org/">XFce
            website</ulink>.</para>
       </sect3>

       <sect3 id="x11-wm-xfce-install">
         <title>Installing XFce</title>

        <para>A binary package for <application>XFce</application>
          exists (at the time of writing).  To install, simply type:</para>

        <screen>&prompt.root; <userinput>pkg_add -r xfce</userinput></screen>

        <para>Alternatively, to build from source, use the ports
          collection:</para>

        <screen>&prompt.root; <userinput>cd /usr/ports/x11-wm/xfce</userinput>
&prompt.root; <userinput>make install clean</userinput></screen>

        <para>Now, tell the X server to launch
         <application>XFce</application> the next time X is started.
         Simply type this:</para>

        <screen>&prompt.user; <userinput>echo "/usr/X11R6/bin/startxfce" &gt; ~/.xinitrc</userinput></screen>

        <para>The next time X is started,
          <application>XFce</application> will be the desktop.
          As before, if a display manager like
          <filename>xdm</filename> is being used, create an
          <filename>.xsession</filename>, as described in the
          section on <link linkend="x11-wm-gnome">GNOME</link>, but
          with the <filename>/usr/X11R6/bin/startxfce</filename>
          command; or, configure the display manager to allow
          choosing a desktop at login time, as explained in
          the section on <link linkend="x11-wm-kde-kdm">kdm</link>.</para>
      </sect3>
    </sect2>
  </sect1>

</chapter>

<!--
     Local Variables:
     mode: sgml
     sgml-declaration: "../chapter.decl"
     sgml-indent-data: t
     sgml-omittag: nil
     sgml-always-quote-attributes: t
     sgml-parent-document: ("../book.sgml" "part" "chapter")
     End:
-->
