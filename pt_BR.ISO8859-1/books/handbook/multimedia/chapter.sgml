<!--
     The FreeBSD Documentation Project

     $FreeBSD: doc/en_US.ISO8859-1/books/handbook/multimedia/chapter.sgml,v 1.68 2003/11/24 03:57:43 murray Exp $
-->

<chapter id="multimedia">
 <chapterinfo>
  <authorgroup>
   <author>
    <firstname>Ross</firstname>
    <surname>Lippert</surname>
    <contrib>Edited by </contrib>
   </author>
  </authorgroup>
 </chapterinfo>

 <title>Multimedia</title>
  <sect1 id="multimedia-synopsis">
  <title>Sin&oacute;pse</title>

    <para>O FreeBSD suporta uma ampla variedade de placas de som,
      permitindo que voc&ecirc; aprecie sons de alta fidelidade a partir do
      seu computador.  Isto inclui a habilidade de gravar e reproduzir
      audio no formato MP3 (MPEG Audio Layer 3), WAV e Ogg Vorbis
      assim como muitos outros formatos.  A cole&ccedil;&atilde;o de ports do
      FreeBSD tamb&eacute;m possui aplicativos que permitem a edi&ccedil;&atilde;o de
      arquivos de audio, a adi&ccedil;&atilde;o de efeitos sonoros, e o controle de
      dispositivos MIDI conectados ao seu computador.</para>

    <para>Com alguma disposi&ccedil;&atilde;o para experimentar, o FreeBSD pode
      reproduzir arquivos de video e DVD's.  O numero de aplica&ccedil;&otilde;es
      para codificar, converter, e reproduzir as v&aacute;rias midias de video 
      &eacute; mais limitada do que o numero de aplica&ccedil;&otilde;es para som.  Por
      exemplo, enquanto este capitulo est&aacute; sendo escrito, n&atilde;o existe
      uma boa aplica&ccedil;&atilde;o de
      <FOREIGNPHRASE>re-encoding</foreignphrase> na cole&ccedil;&atilde;o de ports
      do FreeBSD, a qual possa ser utilizada para converter arquivos
      de um formato para outro, da mesma forma que podemos fazer com
      arquivos de audio utilizando o <filename role="package">audio/sox
      </filename>.  Entretando, o cen&aacute;rio nesta &aacute;rea de software esta
      mudando rapidamente.</para>
    
    <para>Este capitulo ir&aacute; descrever os passos necess&aacute;rios para
      configurar a sua placa de som.  A instala&ccedil;&atilde;o e configura&ccedil;&atilde;o do
      <application>&xfree86;</application> (<xref linkend="x11">) j&aacute;
      foi abordada, e na ocasi&atilde;o foram tomados todos os cuidados
      necess&aacute;rios em rela&ccedil;&atilde;o a correta configura&ccedil;&atilde;o da sua placa de video,
      embora possam existir alguns ajustes a serem aplicados para uma
      melhor reprodu&ccedil;&atilde;o de videos.</para>
    
    <para>Ap&oacute;s a leitura deste capitulo, voce saber&aacute;:</para>

    <itemizedlist>
      <listitem>
        <para>Como configurar o seu sistema de forma que a sua placa
	  de som seja reconhecida.</para>
      </listitem>

      <listitem>
        <para>M&eacute;todos para testar se sua placa de som esta
	  funcionando, utilizando aplicativos de exemplo.</para>
      </listitem>

      <listitem>
        <para>Como realizar uma pesquisa de defeitos em sua
	  configura&ccedil;&atilde;o som.</para>
      </listitem>

      <listitem>
        <para>Como reproduzir e encodar arquivos de audio MP3 e em 
	  outros formatos.</para>
      </listitem>

      <listitem>
        <para>Como o video &eacute; suportado pelo <application>&xfree86;</application>.</para>
      </listitem>

      <listitem>
        <para>Alguns ports de reprodutores/codificadores os quais
	  apresentam bons resultados.</para>
      </listitem>

      <listitem>
        <para>Como reproduzir DVD's, e arquivos <filename>.mpg</filename> e 
	  <filename>.avi</filename>.</para>
      </listitem>

      <listitem>
        <para>Como ripar informa&ccedil;&otilde;es de CDs e DVDs para arquivos.</para>
      </listitem>
    </itemizedlist>

    <para>Antes de ler este capitulo, voc&ecirc; deve:</para>

    <itemizedlist>
      <listitem><para>Conhecer como configurar e instalar um novo kernel
	(<xref linkend="kernelconfig">).</para></listitem>
    </itemizedlist>

    <para>Para as sess&otilde;es de video,  assumimos que o <application>&xfree86; 
      4.X</application> (<filename role='package'>x11/XFree86-4</filename>) j&aacute; est&aacute;
      instalado.  O <application>&xfree86; 3.X</application> pode
      funcionar, mas ele n&atilde;o foi testado com o que &eacute; descrito neste
      capitulo.  Se voc&ecirc; constatar que algo descrito aqui, funciona
      com o <application>&xfree86; 3.X</application>, por favor nos
      informe.</para>
      
    <warning>
      <para>Tentar montar um CD de audio ou um DVD de video com o comando
	&man.mount.8; ir&aacute; resultar ao menos em um erro, e no pior dos
	casos em um <emphasis>kernel panic</emphasis>.  Estas midias
	possuem uma codifica&ccedil;&atilde;o especializada, a qual difere do
	sistema de arquivos ISO usual.</para>
    </warning>

  </sect1>

  <sect1 id="sound-setup">
    <sect1info>
      <authorgroup>
        <author>
	 <firstname>Moses</firstname>
	 <surname>Moore</surname>
	 <contrib>Contriuido por</contrib>
	 <!-- 20 November 2000 -->
        </author>
      </authorgroup>
    </sect1info>

    <title>Configurando a placa de som</title>
    
  <sect2 id="sound-device">
    <title>Localizando o dispositivo correto</title>

    <indexterm><primary>PCI</primary></indexterm>
    <indexterm><primary>ISA</primary></indexterm>
    <indexterm><primary>Placas de som</primary></indexterm>

    <para>Antes de voc&ecirc; come&ccedil;ar, voc&ecirc; deve saber qual o modelo da
      placa que voc&ecirc; possui, qual chipset ela utiliza, e se ela &eacute; uma
      placa PCI ou ISA.  O FreeBSD suporta uma larga variedade de
      placas PCI e ISA.  Se voc&ecirc; n&atilde;o localizar a sua placa na lista
      seginte, verifique a pagina de manual &man.pcm.4;.  Esta n&atilde;o &eacute;
      uma lista completa; entretando ela lista algumas das placas mais
      comuns.</para>
    
    <itemizedlist>
      <listitem>
	<para>Crystal 4237, 4236, 4232, 4231</para>
      </listitem>

      <listitem>
	<para>Yamaha OPL-SAx</para>
      </listitem>

      <listitem>
	<para>OPTi931</para>
      </listitem>

      <listitem>
	<para>Ensoniq AudioPCI 1370/1371</para>
      </listitem>

      <listitem>
	<para>ESS Solo-1/1E</para>
      </listitem>

      <listitem>
	<para>NeoMagic 256AV/ZX</para>
      </listitem>

      <listitem>
	<para>&soundblaster; Pro, 16, 32, AWE64, AWE128, Live</para>
      </listitem>

      <listitem>
	<para>Creative ViBRA16</para>
      </listitem>

      <listitem>
	<para>Advanced Asound 100, 110, and Logic ALS120</para>
      </listitem>

      <listitem>
	<para>ES 1868, 1869, 1879, 1888</para>
      </listitem>

      <listitem>
	<para>Gravis UltraSound</para>
      </listitem>

      <listitem>
	<para>Aureal Vortex 1 or 2</para>
      </listitem>
    </itemizedlist>

    <indexterm>
      <primary>kernel</primary>
      <secondary>configura&ccedil;&atilde;o</secondary>
    </indexterm>

    <para>Para utilizar o seu dispositivo de som, voc&ecirc; ir&aacute; precisar
      carregar o driver de dispositivo apropriado.  Isto pode ser
      efetuado de duas formas.  A forma mais simples consiste-se em
      carregar o m&oacute;dulo de kernel apropriado para sua placa de som com 
      o comando &man.kldload.8; o que pode ser feito a partir da linha
      de comando:
    
    <screen>&prompt.root; <userinput>kldload snd_emu10k1.ko</userinput></screen>

    <para>ou atrav&eacute;s da adi&ccedil;&atilde;o de uma linha apropriada no arquivo 
      <filename>/boot/loader.conf</filename>, tal como o exemplo abaixo:</para>

    <programlisting>snd_emu10k1_load="YES"</programlisting>

    <para>Estes exemplos s&atilde;o para uma placa de som Creative
      &soundblaster; Live!.  Outros m&oacute;dulos de som carreg&aacute;veis
      dispon&iacute;veis s&atilde;o listados no
      <filename>/boot/defaults/loader.conf</filename>.</para>
    
    <para>Alternativamente, voc&ecirc; pode compilar de forma est&aacute;tica o 
      suporte &agrave; sua placa de som no seu kernel.  A sess&atilde;o abaixo
      fornece as informa&ccedil;&otilde;es que voc&ecirc; precisa para adicionar o suporte
      ao seu hardware desta maneira.  Para maiores informa&ccedil;&otilde;es sobre a
      recompila&ccedil;&atilde;o do seu kernel, por favor consulte 
      <xref linkend="kernelconfig">.</para>
    
    <sect3>
      <title>Placas de som Creative, Advance, e ESS</title>

      <para>Se voc&ecirc; possui uma das placas abaixo, voc&ecirc; ir&aacute; precisar
	adicionar:</para>
      
      <programlisting>device pcm</programlisting>

      <para>Ao seu arquivo de configura&ccedil;&atilde;o do kernel.  Se voc&ecirc; possui
      uma placa ISA PnP, voc&ecirc; tamb&eacute;m ter&aacute; que adicionar:</para>
      
      <programlisting>device sbc</programlisting>

      <para>Para uma plana n&atilde;o-PnP, adicione:</para>
      
      <programlisting>device pcm
device sbc0 at isa? port 0x220 irq 5 drq 1 flags 0x15</programlisting>

      <para>Ao seu arquivo de configura&ccedil;&atilde;o do kernel.  A configura&ccedil;&atilde;o
	mostrada acima &eacute; a padr&atilde;o.  Voc&ecirc; pode precisar alterar o IRQ
	ou outras configura&ccedil;&otilde;es para adaptar-se a sua placa.  Consulte
	a pagina de manual &man.sbc.4; para maiores
	informa&ccedil;&otilde;es.</para>
      
      <note>
	<para>A placa de som Sound Blaster Live n&atilde;o &eacute; suportada no
	  FreeBSD FreeBSD&nbsp;4.0 sem um <literal>patch</literal>, o
	  qual esta sess&atilde;o n&atilde;o ir&aacute; abranger.  &Eacute; recomendado que voc&ecirc;
	  atualize seu sistema para a ultima vers&atilde;o -STABLE antes de
	  tentar utilizar esta placa.</para>
      </note>
    </sect3>

    <sect3>
      <title>Placas Gravis UltraSound</title>

      <para>Para um placa ISA PnP, voc&ecirc; ir&aacute; precisar adicionar:</para>

      <programlisting>device pcm
device gusc</programlisting>

      <para>Ao seu arquivo de configura&ccedil;&atilde;o do kernel.  se voc&ecirc; possui 
	uma placa ISA n&atilde;o-PnP, voc&ecirc; ir&aacute; precisar adicionar:</para>

      <programlisting>device pcm
device gus0 at isa? port 0x220 irq 5 drq 1 flags 0x13</programlisting>

      <para>Ao seu arquivo de configura&ccedil;&atilde;o do kernel.  A configura&ccedil;&atilde;o 
        mostrada acima &eacute; a padr&atilde;o.  Voc&ecirc; pode precisar alterar o IRQ 
        ou outras configura&ccedil;&otilde;es para adaptar-se a sua placa.  Consulte 
        a pagina de manual &man.gusc.4; para maiores informa&ccedil;&otilde;es.</para>
    </sect3>

    <sect3>
      <title>Placas de som Crystal</title>

      <para>Para placas Crystal, voc&ecirc; ir&aacute; precisar adicionar:</para>

      <programlisting>device pcm
device csa</programlisting>

      <para>Ao seu arquivo de configura&ccedil;&atilde;o do kernel.</para>
    </sect3>

    <sect3>
      <title>Suporte Gen&eacute;rico</title>

      <para>Para placas PCI ou ISa PnP, voc&ecirc; ir&aacute; precisar adicionar:</para>

      <programlisting>device pcm</programlisting>

      <para>Ao seu arquivo de configura&ccedil;&atilde;o do kernel.  Se voc&ecirc; possui
	uma placa de som ISA n&atilde;o-PnP a qual n&atilde;o possui um
	<literal>bridge driver</literal>, voc&ecirc; ir&aacute; precisar
	adicionar:</para>
      
      <programlisting>device pcm0 at isa? irq 10 drq 1 flags 0x0</programlisting>

      <para>Ao seu arquivo de configura&ccedil;&atilde;o do kernel.  A configura&ccedil;&atilde;o 
        mostrada acima &eacute; a padr&atilde;o.  Voc&ecirc; pode precisar alterar o IRQ 
        ou outras configura&ccedil;&otilde;es para adaptar-se a sua placa.</para>
    </sect3>

    <sect3>
      <title>Som Onboard</title>

      <para>Alguns sistemas com idispositivos de som embutidos na
	placa m&atilde;e podem precisar que a seguinte op&ccedil;&atilde;o esteja presente em
	seu arquivo de configura&ccedil;&atilde;o do kernel:</para>
      
      <programlisting>options PNPBIOS</programlisting>
    </sect3>

  </sect2>

  <sect2 id="sound-devicenodes">
    <title>Criando e testando os n&oacute;s de dispositivos (Device Nodes)</title>

    <indexterm><primary>n&oacute;s de dispositivo</primary></indexterm>

    <para>Depois que voc&ecirc; reinicializar, loge no sistema e verifique se o seu dispositivo 
      est&aacute; sendo listado no arquivo <filename>/var/run/dmesg.boot</filename>, 
      como mostrado abaixo:</para>

    <screen>&prompt.root; <userinput>grep pcm /var/run/dmesg.boot</userinput>
pcm0: &lt;SB16 DSP 4.11&gt; on sbc0</screen>

    <para>A sa&iacute;da para o seu sistema pode parecer diferente.  Se o
      dispositivo <devicename>pcm</devicename> n&atilde;o for exibido, algo
      de errado ocorreu anteriormente.  Se isto acontecer, verifique
      novamente o arquivo de configura&ccedil;&atilde;o do seu kernel e
      certifique-se de que voc&ecirc; escolheu o dispositivo correto.  Os
      problemas mais comuns est&atilde;o listados em <xref linkend="troubleshooting">
      .</para>
    
    <note>
      <para>Se voc&ecirc; estiver executando o FreeBSD&nbsp;5.0 ou
      posterior, voc&ecirc; pode pular tranquilamente o resto desta sess&atilde;o.
      Estas vers&otilde;es utilizam um &man.devfs.5; para criar
      automaticamente os n&oacute;s de dispositivos.</para>
    </note>
      
    <para>Se o comando pr&eacute;vio retornou <devicename>pcm0</devicename>,
      voc&ecirc; ter&aacute; que executar os seguintes comandos, logado como
      <username>root</username>:</para>
    
    <screen>&prompt.root; <userinput>cd /dev</userinput>
&prompt.root; <userinput>sh MAKEDEV snd0</userinput></screen>

    <para>Se o comando retornou <devicename>pcm1</devicename>, siga os
      mesmos passos mostrados acima, subistituindo
      <devicename>snd0</devicename> por
      <devicename>snd1</devicename>.</para>
    
    <note>
      <para>Os comandos acima <emphasis>n&atilde;o</emphasis> ir&atilde;o criar o
	dispositivo <devicename>/dev/snd</devicename>!</para>
    </note>

    <para>O <command>MAKEDEV</command> ir&aacute; criar um grupo de n&oacute;s de
      dispositivo, incluindo:</para>
    
    <informaltable frame="none">
      <tgroup cols="2">
	<thead>
	  <row>
	    <entry>Dispositivo</entry>
	    <entry>Descri&ccedil;&atilde;o</entry>
	  </row>
	</thead>

	<tbody>
	  <row>
	    <entry><devicename>/dev/audio</devicename></entry>
	    <entry>Dispositivo de audio compativel com padr&atilde;o &sparc;</entry>
	  </row>

	  <row>
	    <entry><devicename>/dev/dsp</devicename></entry>
	    <entry>Dispositivo de voz digitalizada</entry>
	  </row>

	  <row>
	    <entry><devicename>/dev/dspW</devicename></entry>
	    <entry>Semelhante ao <devicename>/dev/dsp</devicename>, mas com uma 
	    amostragem de 16 bits</entry>
	  </row>

	  <row>
	    <entry><devicename>/dev/midi</devicename></entry>
	    <entry>Acesso direto ao dispositivo midi</entry>
	  </row>

	  <row>
	    <entry><devicename>/dev/mixer</devicename></entry>
	    <entry>Porta de controle do dispositivo de mixagem</entry>
	  </row>

	  <row>
	    <entry><devicename>/dev/music</devicename></entry>
	    <entry>Interface n&iacute;vel 2 do sequenciador</entry>
	  </row>

	  <row>
	    <entry><devicename>/dev/sequencer</devicename></entry>
	    <entry>Dispositivo sequenciador</entry>
	  </row>

	  <row>
	    <entry><devicename>/dev/pss</devicename></entry>
	    <entry>Interface de dispositivo program&aacute;vel</entry>
	  </row>
	</tbody>
      </tgroup>
    </informaltable>

    <para>Se tudo correu bem, agora voc&ecirc; deve ter uma placa de som que
      funciona.  Se o seu drive de CD-ROM ou de DVD-ROM estiver
      devidamente conectado a sua placa de som, voc&ecirc; pode colocar um
      CD no drive e reproduzi-lo com o uso do &man.cdcontrol.1;:</para>
    
      <screen>&prompt.user; <userinput>cdcontrol -f /dev/acd0c play 1</userinput></screen>

    <para>Varias aplica&ccedil;&otilde;es, tal como o <filename role="package">
      audio/workman</filename> oferece yma interface melhor.  Voc&ecirc;
      pode desejar instalar uma aplica&ccedil;&atilde;o tal como o <filename
      role="package">audio/mpg123</filename> para ouvir seus arquivos
      de audio no formato MP3.</para>
    
    <sect3 id="troubleshooting">
      <title>Problemas Comuns</title>

      <indexterm><primary>n&oacute;s de dispositivo</primary></indexterm>
      <indexterm><primary>I/O port</primary></indexterm>
      <indexterm><primary>IRQ</primary></indexterm>
      <indexterm><primary>DSP</primary></indexterm>

      <informaltable>
        <tgroup cols="2">
  	  <thead>
	    <row>
	     <entry>Erro</entry>
	      <entry>Solu&ccedil;&atilde;o</entry>
	    </row>
          </thead>

	  <tbody>
	    <row>
	      <entry><errorname>unsupported subdevice XX</errorname></entry>
	      <entry><para>Um ou mais dos n&oacute;s de dispositivo n&atilde;o foram
		criados corretamente. Repita os passos acima.</para></entry>
            </row>

            <row>
              <entry><errorname>sb_dspwr(XX) timed out</errorname></entry>
              <entry><para>A porta de I/O n&atilde;o esta ajustada corretamente.</para></entry>
            </row>

            <row>
              <entry><errorname>bad irq XX</errorname></entry>
	      <entry><para>O IRQ est&aacute; ajustado de forma incorreta.
		Certifique-se de que o IRQ setado &eacute; o mesmo IRQ
		utilizado pela sua placa.</para></entry>
            </row>

            <row>
              <entry><errorname>xxx: gus pcm not attached, out of memory</errorname></entry>
              <entry><para>N&atilde;o existe mem&oacute;ria suficiente para utilizar
		o dispositivo.</para></entry>
            </row>

            <row>
              <entry><errorname>xxx: can't open /dev/dsp!</errorname></entry>
              <entry><para>Verifique com o comando <command>fstat | grep dsp</command>
                se alguma outra aplica&ccedil;&atilde;o esta mantendo o dispositivo
		aberto.  Criadores de problema dignos de aten&ccedil;&atilde;o s&atilde;o o
		<application>esound</application> e o suporte a som do
		<application>KDE</application>.</para></entry>
            </row>
          </tbody>
        </tgroup>
      </informaltable>
    </sect3>
  </sect2>

  <sect2>
    <sect2info>
     <authorgroup>
      <author>
       <firstname>Munish</firstname>
       <surname>Chopra</surname>
       <contrib>Contribuido por </contrib>
      </author>
     </authorgroup>
    </sect2info>
    <title>Utilizando multiplas fontes de som</title>

    <para>&Eacute; frequentemente desej&aacute;vel termos multiplas fontes de som, as
      quais possam ser reproduzidas simultaneamente, como por exemplo
      quando o <application>esound</application> ou o
      <application>artsd</application> n&atilde;o suportam o compartilhamento
      do dispositivo de som com alguma aplica&ccedil;&atilde;o.</para>
    
    <para>O FreeBSD permite que voc&ecirc; fa&ccedil;a isso atrav&eacute;s dos
      <emphasis>Canais virtuais de som</emphasis>, os quais podem ser
      configurados atr&aacute;ves do &man.sysctl.8;.  Os canais virtuais
      permitem que voc&ecirc; multiplexe os canais de reprodu&ccedil;&atilde;o da sua
      placa de som atrav&eacute;s de uma mixagem do som pelo kernel.</para>
    
    <para>Para configurar os canais virtuais, existem 2 vari&aacute;veis do
      sysctl que precisam ser ajustadas,  se voc&ecirc; &eacute; o usu&aacute;rio
      <username>root</username>, isto pode ser feito da seguinte
      forma:</para>
    
    <screen>&prompt.root; <userinput>sysctl hw.snd.pcm0.vchans=4</userinput>
&prompt.root; <userinput>sysctl hw.snd.maxautovchans=4</userinput></screen>

    <para>O exemplo acima define 4 canais virtuais, o qual &eacute; um numero
      razo&aacute;vel para uso no dia a dia.  A vari&aacute;vel
      <varname>hw.snd.pcm0.vchans</varname> define o numero de canais
      virtuais que o <devicename>pcm0</devicename> possui, e ela &eacute;
      configur&aacute;vel  uma vez que o dispositivo tenha sido atachado. J&aacute; a
      vari&aacute;vel <literal>hw.snd.maxautovchans</literal> define o numero
      de canais virtuais atribuido a um dispositivo atachado via
      &man.kldload.8;.  Uma vez que o m&oacute;dulo
      <devicename>pcm</devicename> pode ser carregado
      independentemente dos drivers de hardware, a vari&aacute;vel
      varname>hw.snd.maxautovchans</varname> pode armazenar quantos
      canais virtuais ser&atilde;o atribuidos a qualquer dispositivo de som
      atachado ap&oacute;s a inicializa&ccedil;&atilde;o do sistema.</para>
    
    <para>Se voc&ecirc; n&atilde;o est&aacute; utilizando o &man.devfs.5;,, voc&ecirc; ter&aacute; que
      apontar a sua aplica&ccedil;&atilde;o para
      <devicename>/dev/dsp0</devicename>.<replaceable>x</replaceable>,
      onde <replaceable>x</replaceable> ser&aacute; um valor de 0 a 3 se a
      vari&aacute;vel <varname>hw.snd.pcm.0.vchans</varname> estiver definida
      para 4 como no exemplo anterior.  Em um sistema que utilize o
      &man.devfs.5;, a atribui&ccedil;&atilde;o ocorre de forma autom&aacute;tica e
      transparente ao usu&aacute;rio.</para>
   </sect2>

  </sect1>

  <sect1 id="sound-mp3">
    <sect1info>
      <authorgroup>
	<author>
	  <firstname>Chern</firstname>
	  <surname>Lee</surname>
	  <contrib>Contribuido por </contrib>
	</author>
      </authorgroup>
      <!-- 11 Sept 2001 -->
    </sect1info>

    <title>Audio MP3</title>

    <para>Os arquivos de audio MP3 (MPEG Layer 3) oferecem uma qualidade de som
      pr&oacute;xima a qualidade de um CD de audio convencional, de forma que
      n&atilde;o existe nenhuma raz&atilde;o para que voc&ecirc; deixe a sua esta&ccedil;&atilde;o de
      trabalho FreeBSD sem suporte aos mesmos.</para>
    
    <sect2 id="mp3-players">
      <title>Reprodutores de MP3</title>

      <para>De longe, o reprodutor MP3 mais popular no ambiente
	<application>&xfree86;</application> &eacute; o
	<application>XMMS</application> (X Multimedia System).  Os
	skins do <application>Winamp</application> podem ser
	utilizandos com o <application>XMMS</application> uma vez que
	a GUI &eacute; quase identica a do Nullsoft's <application>Winamp
	</application>.  O <application>XMMS</application> tamb&eacute;m
	possui um suporte nativo a plugins.</para>
      
      <para>O <application>XMMS</application> pode ser instalado
	a partir do port <filename role="package">multimedia/xmms</filename> 
	ou ent&atilde;o atrav&eacute;s de um pacote bin&aacute;rio.</para>
      
      <para>A interface do <application>XMMS'</application> &eacute;
	intuitiva, com uma playlist, equalizador gr&aacute;fico, etc.
	Aqueles que est&atilde;o familizarizados com o
	<application>Winamp</application> ir&atilde;o achar o
	<application>XMMS</application> simples de se utilizar.</para>

      <para>O port <filename role="package">audio/mpg123</filename> &eacute;
	uma alternativa, visto que &eacute; um reprodutor de mp3 de linha de
	comando.</para>

      <para>O <application>mpg123</application> pode ser executado,
	especificando como parametros na linha de comando, o dispositivo 
	de som e o arquivo MP3, como ilustrado abaixo:</para>
      
      <screen>&prompt.root; <userinput>mpg123 -a <replaceable>/dev/dsp1.0</replaceable> Foobar-GreatestHits.mp3</userinput>
High Performance MPEG 1.0/2.0/2.5 Audio Player for Layer 1, 2 and 3.
Version 0.59r (1999/Jun/15). Written and copyrights by Michael Hipp.
Uses code from various people. See 'README' for more!
THIS SOFTWARE COMES WITH ABSOLUTELY NO WARRANTY! USE AT YOUR OWN RISK!





Playing MPEG stream from Foobar-GreatestHits.mp3 ...
MPEG 1.0 layer III, 128 kbit/s, 44100 Hz joint-stereo
</screen>

      <para>O <literal>/dev/dsp1.0</literal>  deve ser substituido com o 
	dispositivo <devicename>dsp</devicename> correspondente ao do
	seu sistema.</para>

    </sect2>

    <sect2 id="rip-cd">
      <title>Ripando trilhas de um CD de audio</title>

      <para>Antes de encodar um CD ou uma trilha de CD para MP3, os
      dados de audio do CD devem ser ripados para o seu disco rigido.
      Isto &eacute; feito atrav&eacute;s da c&oacute;pia dos dados CDDA brutos (CD Digital 
      Audio) para arquivos .WAV.</para>
      
      <para>A ferramenta <command>cdda2wav</command> a qual faz parte
	do pacote <filename role="package">sysutils/cdrtools</filename>,
	&eacute; utilizada para ripar informa&ccedil;&otilde;es de audio dos CDs, bem como
	as informa&ccedil;&otilde;es associadas a ele.</para>
      
      <para>Com o CD de audio no drive, o seguinte comando pode ser
	executado (como <username>root</username>) para ripar um CD
	inteiro para arquivos .WAV individuais (um por trilha):</para>
      
      <screen>&prompt.root; <userinput>cdda2wav -D <replaceable>0,1,0</replaceable> -B</userinput></screen>

      <para>O <application>cdda2wav</application> tamb&eacute;m suporta drives de
	CDROM padr&atilde;o ATAPI (IDE).  Para ripar apartir de um drive IDE,
	especifique o nome do dispositivo no lugar do numero de
	unidade SCSI. Por exemplo, para ripar a trilha 7 apartir de um
	drive IDE:</para>
      
      <screen>&prompt.root; <userinput>cdda2wav -D <replaceable>/dev/acd0a</replaceable> -t 7</userinput></screen>

      <para>A op&ccedil;&atilde;o <option>-D <replaceable>0,1,0</replaceable></option>
	indica o dispositivo SCSI <devicename>0,1,0</devicename>, o
	qual corresponde a saida do comando <command>cdrecord -scanbus
	</command>.</para>
      
      <para>Para ripar trilhas individuais, fa&ccedil;a uso da op&ccedil;&atilde;o
	<option>-t</option> como mostrado:</para>
      
      <screen>&prompt.root; <userinput>cdda2wav -D <replaceable>0,1,0</replaceable> -t 7</userinput></screen>

      <para>Este exemplo ripa a trilha 7 do CDROM de audio.  Para
	ripar um range de trilhas, por exemplo, da trilha 1 a 7,
	especifique o range:</para>
      
      <screen>&prompt.root; <userinput>cdda2wav -D <replaceable>0,1,0</replaceable> -t 1+7</userinput></screen>

      <para>O utilit&aacute;rio &man.dd.1; tamb&eacute;m pode ser utilizado para
	extrair uma trilha de audio de um drive ATAPI, leia a sess&atilde;o
	<xref linkend="duplicating-audiocds"> para maiores informa&ccedil;&otilde;es
	sobre esta possibilidade.</para>
      
    </sect2>

    <sect2 id="mp3-encoding">
      <title>Codificando arquivos MP3</title>

      <para>Hoje em dia, o codificador mp3 escolhido &eacute; o <application>lame</application>.
	O application>Lame</application> pode ser encontrado no
	caminho <filename role="package">audio/lame</filename> da
	&aacute;rvore do ports.</para>
      
      <para>Utilizando os arquivos WAV ripados, o comando seguinte ir&aacute;
	converter o arquivo <filename>audio01.wav</filename> para
	<filename>audio01.mp3</filename>:</para>
      
      <screen>&prompt.root; <userinput>lame -h -b <replaceable>128</replaceable> \
--tt "<replaceable>Foo Song Title</replaceable>" \
--ta "<replaceable>FooBar Artist</replaceable>" \
--tl "<replaceable>FooBar Album</replaceable>" \
--ty "<replaceable>2001</replaceable>" \
--tc "<replaceable>Ripped and encoded by Foo</replaceable>" \
--tg "<replaceable>Genre</replaceable>" \
<replaceable>audio01.wav audio01.mp3</replaceable></userinput></screen>

      <para>Aparentemente 128&nbsp;kbits &eacute; o bitrate padr&atilde;o para uso
      	com arquivos MP3.  Muitos apreciam a qualidade superior
	oferecida por bitrates maiores como 160 ou 192kbps.  Quanto
	maior o bitrate, maior o espa&ccedil;o em disco ocupado pelo arquivo
	mp3 resultante -- mas a qualidade tamb&eacute;m ser&aacute; maior.  A op&ccedil;&atilde;o
	<option>-h</option> ativa o modo <quote>Maior qualidade mas um
	pouco mais lento</quote>.  As op&ccedil;&otilde;es iniciadas com
	<option>--t</option> indicam as tags ID3, as quais cont&eacute;m
	usualmente informa&ccedil;&otilde;es da musica, para serem embutidas no
	arquivo MP3.  Op&ccedil;&otilde;es adicionais de codifica&ccedil;&atilde;o podem ser
	encontradas consultando a pagina de manual do lame.</para>
      
    </sect2>

    <sect2 id="mp3-decoding">
      <title>Decodificando arquivos MP3</title>

      <para>A fim de gravar um CD de audio a partir de arquivos MP3,
	os mesmos devem ser convertidos para um formato WAV
	n&atilde;o-comprimido.  Tanto o <application>XMMS</application>
	quanto o <application>mpg123</application> suportam
	redirecionar a saida de um MP3 para um formato de arquivo
	descomprimido.</para>
	
      <para>Gravando para disco com o <application>XMMS</application>:</para>

      <procedure>
	<step>
	  <para>Execute o <application>XMMS</application>.</para>
	</step>

	<step>
	  <para>Clique com o bot&atilde;o direito do mouse na janela para
	    exibir o menu do <application>XMMS</application>.</para>
	</step>

	<step>
	  <para>Selecione a op&ccedil;&atilde;o <literal>Preference</literal> abaixo
	    do <literal>Options</literal>.</para>
	</step>

	<step>
	  <para>Altere o plugin de sa&iacute;da para <quote>Disk Writer 
	    Plugin</quote>.</para>
	</step>

	<step>
	  <para>Pressione <literal>Configure</literal>.</para>
	</step>

	<step>
	  <para>Entre com o diret&oacute;rio (ou escolha a op&ccedil;&atilde;o browse) no
	    qual os arquivos descomprimidos ser&atilde;o gravados.</para>
	</step>

	<step>
	  <para>Carregue normalmente o arquivo MP3 no <application>XMMS
	    </application>, com o volume ajustado para 100% e com as
	    configura&ccedil;&otilde;es do equalizador desligadas.</para>
	</step>

	<step>
	  <para>Pressione <literal>Play</literal> &mdash; O 
	    <application>XMMS</application> ir&aacute; se comportar como se
	    estivesse reproduzindo o arquivo MP3, mas nenhuma musica
	    ser&aacute; ouvida.  Ele est&aacute; na verdade reproduzindo o arquivo
	    MP3 para um arquivo.</para>
	</step>

	<step>
	  <para>Certifique-se de refazer a configura&ccedil;&atilde;o do plugin de saida,
	    para poder voltar a ouvir seus MP3 de novo.</para>
	</step>
      </procedure>

      <para>Escrevendo para a saida padr&atilde;o no <application>mpg123</application>:</para>

      <procedure>
	<step>
	  <para>Execute mpg123 -s <replaceable>audio01.mp3</replaceable>
	    &gt; audio01.pcm</para>
	</step>
      </procedure>

      <para>O <application>XMMS</application> gera um arquivo no
      	formato WAv, enquanto o <application>mpg123</application>
	converte o MP3 em dados brutos de audio no formato PCM.
	Ambos os formatos podem ser utilizados com o
	<application>cdrecord</application> para criar CDs de audio.
	J&aacute; com o &man.burncd.8;, voc&ecirc; poder&aacute; utilizar somente arquivos de 
	audio em formato PCM.  Se voc&ecirc; utilizar arquivos WAV, voc&ecirc;
	observar&aacute; um pequeno ruido no inicio de cada trilha, este som
	&eacute; o cabe&ccedil;alho do arquivo WAV.  Voc&ecirc; pode simplesmente remover
	o cabe&ccedil;akho de um arquivo WAV com o utilit&aacute;rio
	<application>SoX</application> (ele pode ser instalado apartir
	do port <filename role="package">audio/sox</filename> ou de um
	pacote bin&aacute;rio):</para>
      
      <screen>&prompt.user; <userinput>sox -t wav -r 44100 -s -w -c 2 <replaceable>track.wav track.raw</replaceable></userinput></screen>

      <para>Leia a sess&atilde;o <xref linkend="creating-cds"> para maiores 
	informa&ccedil;&otilde;es sobre o uso do um gravador de CDs no FreeBSD.</para>
    </sect2>
 </sect1>

 <sect1 id="video-playback">
  <sect1info>
    <authorgroup>
      <author>
        <firstname>Ross</firstname>
	<surname>Lippert</surname>
	<contrib>Contribuido por </contrib>
      </author>
    </authorgroup>
    <!-- 5 June 2002 -->
  </sect1info>

  <title>Reprodu&ccedil;&atilde;o de Video</title>

    <para>Video playback is a very new and rapidly developing application
      area.  Be patient.  Not everything is going to work as smoothly as
      it did with sound.</para>

    <para>Before you begin, you should know the model of the video
      card you have and the chip it uses.  While <application>&xfree86;</application> supports a
      wide variety of video cards, fewer give good playback
      performance.  To obtain a list of extensions supported by the
      X server using your card use the command &man.xdpyinfo.1; while
      X11 is running.</para>

    <para>It is a good idea to have a short MPEG file which can be
      treated as a test file for evaluating various players and
      options.  Since some DVD players will look for DVD media in
      <filename>/dev/dvd</filename> by default, or have this device
      name hardcoded in them, you might find it useful to make
      symbolic links to the proper devices:</para>

      <screen>&prompt.root; <userinput>ln -sf /dev/acd0c /dev/dvd</userinput>
&prompt.root; <userinput>ln -sf /dev/racd0c /dev/rdvd</userinput></screen>

    <para>On FreeBSD&nbsp;5.X, which uses &man.devfs.5; there
        is a slightly different set of recommended links:</para>

      <screen>&prompt.root; <userinput>ln -sf /dev/acd0c /dev/dvd</userinput>
&prompt.root; <userinput>ln -sf /dev/acd0c /dev/rdvd</userinput></screen>

    <para>Additionally, DVD decryption, which requires invoking
      special DVD-ROM functions, requires write permission on the DVD
      devices.</para>

    <indexterm>
      <primary>kernel options</primary>
      <secondary>options CPU_ENABLE_SSE</secondary>
    </indexterm>
    <indexterm>
      <primary>kernel options</primary>
      <secondary>options USER_LDT</secondary>
    </indexterm>

    <para>Some of the ports discussed rely on the following kernel
      options to build correctly.  Before attempting to build, add
      these options to the kernel configuration file, build a new kernel, and reboot:</para>

      <programlisting>option CPU_ENABLE_SSE
option USER_LDT</programlisting>

    <para>To enhance the shared memory X11 interface, it is
      recommended that the values of some &man.sysctl.8; variables
      should be increased:</para>

      <programlisting>kern.ipc.shmmax=67108864
kern.ipc.shmall=32768</programlisting>

  <sect2 id="video-interface">
    <title>Determinando as Capacidades de Video</title>

    <indexterm><primary>XVideo</primary></indexterm>
    <indexterm><primary>SDL</primary></indexterm>
    <indexterm><primary>DGA</primary></indexterm>

    <para>There are several possible ways to display video under X11.
      What will really work is largely hardware dependent.  Each
      method described below will have varying quality across
      different hardware.  Secondly, the rendering of video in X11 is
      a topic receiving a lot of attention lately, and with each
      version of <application>&xfree86;</application> there may be significant improvement.</para>

    <para>A list of common video interfaces:</para>

    <orderedlist>
    <listitem>
      <para>X11: normal X11 output using shared memory.</para>
    </listitem>
    <listitem>
      <para>XVideo: an extension to the X11
      interface which supports video in any X11 drawable.</para>
    </listitem>
    <listitem>
      <para>SDL: the Simple Directmedia Layer.</para>
    </listitem>
    <listitem>
      <para>DGA: the Direct Graphics Access.</para>
    </listitem>
    <listitem>
      <para>SVGAlib: low level console graphics layer.</para>
    </listitem>
    </orderedlist>

    <sect3 id="video-interface-xvideo">
    <title>XVideo</title>

      <para><application>&xfree86; 4.X</application> has an extension called
        <emphasis>XVideo</emphasis> (aka Xvideo, aka Xv, aka xv) which
        allows video to be directly displayed in drawable objects
        through a special acceleration.  This extension provides very
        good quality playback even on low-end machines (for example my
        PIII&nbsp;400&nbsp;Mhz laptop).  Unfortunately, the list of cards in which
        this feature is supported <quote>out of the box</quote> is
        currently:</para>
      
        <orderedlist>
	<listitem>
	   <para>3DFX Voodoo 3</para>
        </listitem>
        <listitem>
           <para>&intel; i810 and i815</para>
        </listitem>
        <listitem>
          <para>some S3 chips (such as Savage/IX and Savage/MX)</para>
        </listitem>
        </orderedlist>

      <para>If your card is not one of these, do not be disappointed yet.
      <application>&xfree86; 4.X</application> adds new xv capabilities with each release
      <footnote>
        <para>A popular familiar graphics card with generally very good
         <application>&xfree86;</application> performance, nVidia, has yet to release the specifications
	 on their XVideo support to the <application>&xfree86;</application> team.  It may be some time
	 before <application>&xfree86;</application> fully support XVideo for these cards.</para>
      </footnote>.
      To check whether the extension is running, 
      use <command>xvinfo</command>:</para>

        <screen>&prompt.user; <userinput>xvinfo</userinput></screen>

      <para>XVideo is supported for your card if the result looks like:</para>
<screen>X-Video Extension version 2.2
screen #0
  Adaptor #0: "Savage Streams Engine"
    number of ports: 1
    port base: 43
    operations supported: PutImage 
    supported visuals:
      depth 16, visualID 0x22
      depth 16, visualID 0x23
    number of attributes: 5
      "XV_COLORKEY" (range 0 to 16777215)
              client settable attribute
              client gettable attribute (current value is 2110)
      "XV_BRIGHTNESS" (range -128 to 127)
              client settable attribute
              client gettable attribute (current value is 0)
      "XV_CONTRAST" (range 0 to 255)
              client settable attribute
              client gettable attribute (current value is 128)
      "XV_SATURATION" (range 0 to 255)
              client settable attribute
              client gettable attribute (current value is 128)
      "XV_HUE" (range -180 to 180)
              client settable attribute
              client gettable attribute (current value is 0)
    maximum XvImage size: 1024 x 1024
    Number of image formats: 7
      id: 0x32595559 (YUY2)
        guid: 59555932-0000-0010-8000-00aa00389b71
        bits per pixel: 16
        number of planes: 1
        type: YUV (packed)
      id: 0x32315659 (YV12)
        guid: 59563132-0000-0010-8000-00aa00389b71
        bits per pixel: 12
        number of planes: 3
        type: YUV (planar)
      id: 0x30323449 (I420)
        guid: 49343230-0000-0010-8000-00aa00389b71
        bits per pixel: 12
        number of planes: 3
        type: YUV (planar)
      id: 0x36315652 (RV16)
        guid: 52563135-0000-0000-0000-000000000000
        bits per pixel: 16
        number of planes: 1
        type: RGB (packed)
        depth: 0
        red, green, blue masks: 0x1f, 0x3e0, 0x7c00
      id: 0x35315652 (RV15)
        guid: 52563136-0000-0000-0000-000000000000
        bits per pixel: 16
        number of planes: 1
        type: RGB (packed)
        depth: 0
        red, green, blue masks: 0x1f, 0x7e0, 0xf800
      id: 0x31313259 (Y211)
        guid: 59323131-0000-0010-8000-00aa00389b71
        bits per pixel: 6
        number of planes: 3
        type: YUV (packed)
      id: 0x0
        guid: 00000000-0000-0000-0000-000000000000
        bits per pixel: 0
        number of planes: 0
        type: RGB (packed)
        depth: 1
        red, green, blue masks: 0x0, 0x0, 0x0</screen>

    <para>Also note that the formats listed (YUV2, YUV12, etc) are not
     present with every implementation of XVideo and their absence may
     hinder some players.</para>

    <para>If the result looks like:</para>
<screen>X-Video Extension version 2.2
screen #0
no adaptors present</screen>

    <para>Then XVideo is probably not supported for your card.</para>

    <para>If XVideo is not supported for your card, this only means
      that it will be more difficult for your display to meet the
      computational demands of rendering video.  Depending on your
      video card and processor, though, you might still be able to
      have a satisfying experience.  You should probably read about
      ways of improving performance in the advanced reading <xref
      linkend="video-further-reading">.</para>

    </sect3>

    <sect3 id="video-interface-SDL">
    <title>Camada simples directmedia (Simple Directmedia Layer)</title>

    <para>The Simple Directmedia Layer, SDL, was intended to be a
      porting layer between &microsoft.windows;, BeOS, and &unix;,
      allowing cross-platform applications to be developed which made
      efficient use of sound and graphics.  The SDL layer provides a
      low-level abstraction to the hardware which can sometimes be
      more efficient than the X11 interface.</para>

    <para>The SDL can be found at <filename role="package">devel/sdl12</filename></para>

    </sect3>

    <sect3 id="video-interface-DGA">
    <title>Acesso gr&aacute;fico direto</title>

    <para>Direct Graphics Access is an <application>&xfree86;</application> extension which allows
      a program to bypass the X server and directly alter the
      framebuffer.  Because it relies on a low level memory mapping to
      effect this sharing, programs using it must must be run as
      <username>root</username>.</para>

    <para>The DGA extension can be tested and benchmarked by
      &man.dga.1;.  When <command>dga</command> is running, it
      changes the colors of the display whenever a key is pressed.  To
      quit, use <keycap>q</keycap>.</para>

    </sect3>

  </sect2>

  <sect2 id="video-ports">
    <title>Ports e Pacotes para lidar com video</title>

    <indexterm><primary>video ports</primary></indexterm>
    <indexterm><primary>video packages</primary></indexterm>

    <para>This section discusses the software available from the
      FreeBSD Ports Collection which can be used for video playback.
      Video playback is a very active area of software development,
      and the capabilities of various applications are bound to
      diverge somewhat from the descriptions given here.</para>

    <para>Firstly, it is important to know that many of the video
      applications which run on FreeBSD were developed as Linux
      applications.  Many of these applications are still
      beta-quality.  Some of the problems that you may encounter with
      video packages on FreeBSD include :</para>

      <orderedlist>

      <listitem>
        <para>An application cannot playback a file which another
          application produced.</para>
      </listitem> 

      <listitem>
        <para>An application cannot playback a file which the
          application itself produced.</para>
      </listitem>

      <listitem>
        <para>The same application on two different machines,
          rebuilt on each machine for that machine, plays back the same
          file differently.</para>
      </listitem>

      <listitem>
        <para>A seemingly trivial filter like rescaling of the image
          size results in very bad artifacts from a buggy rescaling
          routine.</para>
      </listitem>

      <listitem>
        <para>An application frequently dumps core.</para>
      </listitem>

      <listitem>
        <para>Documentation is not installed with the port and can be
          found either on the web or under the port's <filename role='directory'>work</filename>
          directory.</para>
      </listitem>

      </orderedlist>

    <para>Many of these applications may also exhibit
      <quote>Linux-isms</quote>.  That is, there may be
      issues resulting from the way some standard libraries are
      implemented in the Linux distributions, or some features of the
      Linux kernel which have been assumed by the authors of the
      applications.  These issues are not always noticed and worked around
      by the port maintainers, which can lead to problems like
      these:</para>
       
      <orderedlist>

      <listitem>
        <para>The use of <filename>/proc/cpuinfo</filename> to detect
          processor characteristics.</para>
      </listitem>

      <listitem>
        <para>A misuse of threads which causes a program to hang upon
          completion instead of truly terminating.</para>
      </listitem>

      <listitem>
        <para>Software not yet in the FreeBSD Ports Collection
	  which is commonly used in conjunction with the application.</para>
      </listitem>

      </orderedlist>

      <para>So far, these application developers have been cooperative with
        port maintainers to minimize the work-arounds needed for
        port-ing.</para>

    <sect3 id="video-mplayer">
      <title>MPlayer</title>

      <para><application>MPlayer</application> is a recently developed and rapidly developing
        video player.  The goals of the <application>MPlayer</application> team are speed and
        flexibility on Linux and other Unices.  The project was
        started when the team founder got fed up with bad playback
        performance on then available players.  Some would say that
        the graphical interface has been sacrificed for a streamlined
        design.  However, once
        you get used to the command line options and the key-stroke
        controls, it works very well.</para>

      <sect4 id="video-mplayer-building">
        <title>Compilando o MPlayer</title>
        <indexterm><primary>MPlayer</primary>
	           <secondary>making</secondary></indexterm>

	<para><application>MPlayer</application> resides in <filename
	  role="package">multimedia/mplayer</filename>.
	  <application>MPlayer</application> performs a variety of
	  hardware checks during the build process, resulting in a
	  binary which will not be portable from one system to
	  another.  Therefore, it is important to build it from
	  ports and not to use a binary package.  Additionally, a
	  number of options can be specified in the <command>make</command>
	  command line, as described at the start of the build.</para>

	<screen>&prompt.root; <userinput>cd /usr/ports/multimedia/mplayer</userinput>
&prompt.root; <userinput>make</userinput>
You can enable additional compilation optimizations
by defining WITH_OPTIMIZED_CFLAGS
You can enable GTK GUI by defining WITH_GUI.
You can enable DVD support by defining WITH_DVD.
You can enable SVGALIB support by defining WITH_SVGALIB.
You can enable VORBIS sound support by defining WITH_VORBIS.
You can enable XAnim DLL support by defining WITH_XANIM.
</screen>

        <para>If you have <filename
          role="package">x11-toolkits/gtk12</filename> installed, then
          you might as well enable the GUI.  Otherwise, it is not
          worth the effort.  If you intend to play (possibly CSS
          encoded) DVD's with <application>MPlayer</application> you must enable the DVD support
          option here <footnote><para>Unauthorized DVD playback is a
          serious criminal act in some countries.  Check local laws
          before enabling this option.</para> </footnote>.  Some
          reasonable options are:</para>

        <screen>&prompt.root; <userinput>make WITH_DVD=yes WITH_SVGALIB=yes</userinput></screen>

        <para>As of this writing, the <application>MPlayer</application> port will build its HTML
          documentation and one executable,
          <command>mplayer</command>.  It can also be made to build an
          encoder, <command>mencoder</command>, which is a tool for
          re-encoding video.  A modification to the
          <filename>Makefile</filename> can enable it.  It may be
          enabled by default in subsequent versions of the port.</para>

        <para>The HTML documentation for <application>MPlayer</application> is very informative.
          If the reader finds the information on video hardware and
          interfaces in this chapter lacking, the <application>MPlayer</application> documentation
          is a very thorough supplement.  You should definitely take
          the time to read the <application>MPlayer</application>
          documentation if you are looking for information about video
          support in &unix;.</para>

      </sect4>

      <sect4 id="video-mplayer-using">
        <title>Utilizando o MPlayer</title>
        <indexterm><primary>MPlayer</primary>
	           <secondary>use</secondary></indexterm>

        <para>Any user of <application>MPlayer</application> must set up a
          <filename>.mplayer</filename> subdirectory of her
          home directory.  To create this necessary subdirectory,
	  you can type the following:</para>

<screen>&prompt.user; <userinput>cd /usr/ports/multimedia/mplayer</userinput>
&prompt.user; <userinput>make install-user</userinput></screen>

	<para>The command options for <command>mplayer</command> are
	  listed in the manual page.  For even more detail there is HTML
	  documentation.  In this section, we will describe only a few
	  common uses.</para>

	<para>To play a file, such as
	  <filename><replaceable>testfile.avi</replaceable></filename>,
	  through one of the various video interfaces set the
	  <option>-vo</option> option:</para>

	  <screen>&prompt.user; <userinput>mplayer -vo xv testfile.avi</userinput></screen>
	  <screen>&prompt.user; <userinput>mplayer -vo sdl testfile.avi</userinput></screen>
	  <screen>&prompt.user; <userinput>mplayer -vo x11 testfile.avi</userinput></screen>
	  <screen>&prompt.root; <userinput>mplayer -vo dga testfile.avi</userinput></screen>
	  <screen>&prompt.root; <userinput>mplayer -vo 'sdl:dga' testfile.avi</userinput></screen>

	<para>It is worth trying all of these options, as their relative
	  performance depends on many factors and will vary significantly
	  with hardware.</para>

	<para>To play from a DVD, replace the
	 <filename>testfile.avi</filename> with <option>-dvd &lt;N&gt;
	 <replaceable>DEVICE</replaceable></option> where &lt;N&gt; is
	 the title number to play and
	 <filename><replaceable>DEVICE</replaceable></filename> is the
	 device node for the DVD-ROM.  For example, to play title 3
	 from <filename>/dev/dvd</filename>:</para>

	  <screen>&prompt.root; <userinput>mplayer -vo dga -dvd 2 /dev/dvd</userinput></screen>

	<para>To stop, pause, advance and so on, consult the
	  keybindings, which are output by running <command>mplayer
	  -h</command> or read the manual page.</para>

        <para>Additional important options for playback are:
          <option>-fs -zoom</option> which engages the fullscreen mode
          and <option>-framedrop</option> which helps performance.</para>

	<para>In order for the mplayer command line to not become too
	  large, the user can create a file
	  <filename>.mplayer/config</filename> and set default options
	  there:</para>
<programlisting>vo=xv
fs=yes
zoom=yes</programlisting>

	<para>Finally, <command>mplayer</command> can be used to rip a
	  DVD title into a <filename>.vob</filename> file.  To dump
	  out the second title from a DVD, type this:</para>

	  <screen>&prompt.root; <userinput>mplayer -dumpstream -dumpfile out.vob -dvd 2 /dev/dvd</userinput></screen>

        <para>The output file, <filename>out.vob</filename>, will be
	  MPEG and can be manipulated by the other packages described
	  in this section.</para>

      </sect4>
      <sect4 id="video-mencoder">
        <title>mencoder</title>
        <indexterm>
	  <primary>mencoder</primary>
	</indexterm>

	<para>If you opt to install <command>mencoder</command> when
	 you build <application>MPlayer</application>, be forewarned
	 that it is still an experimental component.  Before using 
         <command>mencoder</command> it is a good idea to
	 familiarize yourself with the options from the HTML
	 documentation.  There is a manual page, but it is not very
	 useful without the HTML documentation.  There are innumerable ways to
	 improve quality, lower bitrate, and change formats, and some
	 of these tricks may make the difference between good
	 or bad performance.  Here are a couple of examples to get
	 you going.  First a simple copy:</para>

	 <screen>&prompt.user; <userinput>mencoder input.avi -oac copy -ovc copy -o output.avi</userinput></screen>

         <para>Improper combinations of command line options can yield
	 output files that are
	 unplayable even by <command>mplayer</command>.  Thus, if you
	 just want to rip to a file, stick to the <option>-dumpfile</option>
	 in <command>mplayer</command>.</para>

	 <para>To convert <filename>input.avi</filename> to the MPEG4
	 codec with MPEG3 audio encoding (<filename role="package">audio/lame</filename> is required):</para>

	 <screen>&prompt.user; <userinput>mencoder input.avi -oac mp3lame -lameopts br=192 \
	 -ovc lavc -lavcopts vcodec=mpeg4:vhq -o output.avi</userinput></screen>

	 <para>This has produced output playable by <command>mplayer</command>
	 and <command>xine</command>.</para>

	 <para><filename>input.avi</filename> can be replaced with
	   <option>-dvd 1 /dev/dvd</option> and run as
	   <username>root</username> to re-encode a DVD title
	   directly.  Since you are likely to be dissatisfied with
	   your results the first time around, it is recommended you
	   dump the title to a file and work on the file.</para>
      </sect4>

    </sect3>

    <sect3 id="video-xine">
    <title>iReprodutor de video xine</title>

    <para>The <application>xine</application> video player is a project of wide scope aiming not only at being an
     all in one video solution, but also in producing a reusable base
     library and a modular executable which can be extended with
     plugins.  It comes both as a package and as a port, <filename
     role="package">multimedia/xine</filename>.</para>

    <para>The <application>xine</application> player
     is still very rough around the edges, but it is clearly off to a
     good start.  In practice, <application>xine</application> requires either a fast CPU with a
     fast video card, or support for the XVideo extension.  The GUI is
     usable, but a bit clumsy.</para>

    <para>As of this writing, there is no input module shipped with
     <application>xine</application> which will play CSS encoded DVD's.  There are third party
     builds which do have modules for this built in them, but none
     of these are in the FreeBSD Ports Collection.</para>

    <para>Compared to <application>MPlayer</application>, <application>xine</application> does more for the user, but at the
      same time, takes some of the more fine-grained control away from
      the user.  The <application>xine</application> video player
      performs best on XVideo interfaces.</para>
     
    <para>By default, <application>xine</application> player will
    start up in a graphical user interface.  The menus can then be
    used to open a specific file:</para>

      <screen>&prompt.user; <userinput>xine</userinput></screen>

    <para>Alternatively, it may be invoked to play a file immediately
      without the GUI interface with the command:</para>

      <screen>&prompt.user; <userinput>xine -g -p mymovie.avi</userinput></screen>

    </sect3>

    <sect3 id="video-ports-transcode">
    <title>Utilit&aacute;rios de transcodifica&ccedil;&atilde;o</title>

    <para>The software <application>transcode</application> is not a player, but a suite of tools for
      re-encoding <filename>.avi</filename> and <filename>.mpg</filename> files.  With <application>transcode</application>, one has the
      ability to merge video files, repair broken files, using command
      line tools with <filename>stdin/stdout</filename> stream
      interfaces.</para>

    <para>Like <application>MPlayer</application>, <application>transcode</application> is very experimental software which
      must be build from the port <filename
      role="package">multimedia/transcode</filename>.  Using a great
      many options to the <command>make</command> command.  I
      recommend:</para>

      <screen>&prompt.root; <userinput>make WITH_LIBMPEG2=yes</userinput></screen>

    <para>If you plan to install <filename
      role="package">multimedia/avifile</filename>, then add the
      <literal>WITH_AVIFILE</literal> option to your
      <command>make</command> command line, as shown here:</para>

      <screen>&prompt.root; <userinput>make WITH_AVIFILE=yes WITH_LIBMPEG2=yes</userinput></screen>

    <para>Here are two examples of using <command>transcode</command>
      for video conversion which produce rescaled output.  The first
      encodes the output to an openDIVX AVI file, while the second
      encodes to the much more portable MPEG format.</para>

      <screen>&prompt.user; <userinput>transcode -i input.vob -x vob -V -Z 320x240 \
-y opendivx -N 0x55 -o output.avi</userinput></screen>

      <screen>&prompt.user; <userinput>transcode -i input.vob -x vob -V -Z 320x240 \
-y mpeg -N 0x55 -o output.tmp</userinput>
&prompt.user; <userinput>tcmplex -o output.mpg -i output.tmp.m1v -p output.tmp.mpa -m 1</userinput></screen>

    <para>There is a manual page for <command>transcode</command>, but
      there is little documentation for the various <command>tc*</command> utilities (such as
      <command>tcmplex</command>) which are also installed.
      However, the <option>-h</option> command line option can
      always be given to get curt usage instructions for a
      command.</para>

    <para>In comparison, <command>transcode</command> runs
      significantly slower than <command>mencoder</command>, but it
      has a better chance of producing a more widely playable file.
      MPEGs created by <command>transcode</command> have been known to
      play on older copies of
      <application>&windows.media; Player</application> and Apple's <application>&quicktime;</application>, for example.</para>

    </sect3>

  </sect2>

  <sect2 id="video-further-reading">
    <title>Refer&ecirc;ncias para leitura adicional</title>

    <para>The various video software packages for FreeBSD are
      developing rapidly.  It is quite possible that in the near
      future many of the problems discussed here will have been
      resolved.  In the mean time, those who
     want to get the very most out of FreeBSD's A/V capabilities will
     have to cobble together knowledge from several FAQs and tutorials
     and use a few different applications.  This section exists to
      give the reader pointers to such additional information.</para>

    <para>The 
      <ulink url="http://www.mplayerhq.hu/DOCS/">MPlayer documentation</ulink>
      is very technically informative.
      These documents should probably be consulted by anyone wishing
      to obtain a high level of expertise with &unix; video.  The
      <application>MPlayer</application> mailing list is hostile to anyone who has not bothered
      to read the documentation, so if you plan on making bug reports
      to them, RTFM.</para>

    <para>The
      <ulink url="http://dvd.sourceforge.net/xine-howto/en_GB/html/howto.html">      xine HOWTO</ulink>
      contains a chapter on performance improvement
      which is general to all players.</para>

    <para>Finally, there are some other promising applications which
    the reader may try:</para>

    <itemizedlist>

       <listitem>
         <para><ulink
	   url="http://avifile.sourceforge.net/">Avifile</ulink> which
	   is also a port <filename
	   role='package'>multimedia/avifile</filename>.</para>
       </listitem>

       <listitem>
         <para><ulink
	   url="http://www.dtek.chalmers.se/groups/dvd/">Ogle</ulink>
	   which is also a port <filename
	   role='package'>multimedia/ogle</filename>.</para>
       </listitem>

       <listitem>
         <para><ulink url="http://xtheater.sourceforge.net/">Xtheater</ulink></para>
       </listitem>

	<listitem>
         <para><filename
           role="package">multimedia/dvdauthor</filename>, an open
           source package for authoring DVD content.</para>
        </listitem>

    </itemizedlist>

  </sect2>
 </sect1>
</chapter>

<!--
     Local Variables:
     mode: sgml
     sgml-declaration: "../chapter.decl"
     sgml-indent-data: t
     sgml-omittag: nil
     sgml-always-quote-attributes: t
     sgml-parent-document: ("../book.sgml" "part" "chapter")
     End:
-->
