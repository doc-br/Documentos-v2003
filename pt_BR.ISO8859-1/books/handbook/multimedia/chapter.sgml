<!--
     The FreeBSD Documentation Project

     $FreeBSD: doc/en_US.ISO8859-1/books/handbook/multimedia/chapter.sgml,v 1.68 2003/11/24 03:57:43 murray Exp $
-->

<chapter id="multimedia">
 <chapterinfo>
  <authorgroup>
   <author>
    <firstname>Ross</firstname>
    <surname>Lippert</surname>
    <contrib>Edited by </contrib>
   </author>
  </authorgroup>
 </chapterinfo>

 <title>Multimedia</title>
  <sect1 id="multimedia-synopsis">
  <title>Sin&oacute;pse</title>

    <para>O FreeBSD suporta uma ampla variedade de placas de som,
      permitindo que voc&ecirc; aprecie sons de alta fidelidade a partir do
      seu computador.  Isto inclui a habilidade de gravar e reproduzir
      audio no formato MP3 (MPEG Audio Layer 3), WAV e Ogg Vorbis
      assim como muitos outros formatos.  A cole&ccedil;&atilde;o de ports do
      FreeBSD tamb&eacute;m possui aplicativos que permitem a edi&ccedil;&atilde;o de
      arquivos de audio, a adi&ccedil;&atilde;o de efeitos sonoros, e o controle de
      dispositivos MIDI conectados ao seu computador.</para>

    <para>Com alguma disposi&ccedil;&atilde;o para experimentar, o FreeBSD pode
      reproduzir arquivos de video e DVD's.  O numero de aplica&ccedil;&otilde;es
      para codificar, converter, e reproduzir as v&aacute;rias midias de video 
      &eacute; mais limitada do que o numero de aplica&ccedil;&otilde;es para som.  Por
      exemplo, enquanto este capitulo est&aacute; sendo escrito, n&atilde;o existe
      uma boa aplica&ccedil;&atilde;o de
      <FOREIGNPHRASE>re-encoding</foreignphrase> na cole&ccedil;&atilde;o de ports
      do FreeBSD, a qual possa ser utilizada para converter arquivos
      de um formato para outro, da mesma forma que podemos fazer com
      arquivos de audio utilizando o <filename role="package">audio/sox
      </filename>.  Entretando, o cen&aacute;rio nesta &aacute;rea de software esta
      mudando rapidamente.</para>
    
    <para>Este capitulo ir&aacute; descrever os passos necess&aacute;rios para
      configurar a sua placa de som.  A instala&ccedil;&atilde;o e configura&ccedil;&atilde;o do
      <application>&xfree86;</application> (<xref linkend="x11">) j&aacute;
      foi abordada, e na ocasi&atilde;o foram tomados todos os cuidados
      necess&aacute;rios em rela&ccedil;&atilde;o a correta configura&ccedil;&atilde;o da sua placa de video,
      embora possam existir alguns ajustes a serem aplicados para uma
      melhor reprodu&ccedil;&atilde;o de videos.</para>
    
    <para>Ap&oacute;s a leitura deste capitulo, voce saber&aacute;:</para>

    <itemizedlist>
      <listitem>
        <para>Como configurar o seu sistema de forma que a sua placa
	  de som seja reconhecida.</para>
      </listitem>

      <listitem>
        <para>M&eacute;todos para testar se sua placa de som esta
	  funcionando, utilizando aplicativos de exemplo.</para>
      </listitem>

      <listitem>
        <para>Como realizar uma pesquisa de defeitos em sua
	  configura&ccedil;&atilde;o som.</para>
      </listitem>

      <listitem>
        <para>Como reproduzir e encodar arquivos de audio MP3 e em 
	  outros formatos.</para>
      </listitem>

      <listitem>
        <para>Como o video &eacute; suportado pelo <application>&xfree86;</application>.</para>
      </listitem>

      <listitem>
        <para>Alguns ports de reprodutores/codificadores os quais
	  apresentam bons resultados.</para>
      </listitem>

      <listitem>
        <para>Como reproduzir DVD's, e arquivos <filename>.mpg</filename> e 
	  <filename>.avi</filename>.</para>
      </listitem>

      <listitem>
        <para>Como ripar informa&ccedil;&otilde;es de CDs e DVDs para arquivos.</para>
      </listitem>
    </itemizedlist>

    <para>Antes de ler este capitulo, voc&ecirc; deve:</para>

    <itemizedlist>
      <listitem><para>Conhecer como configurar e instalar um novo kernel
	(<xref linkend="kernelconfig">).</para></listitem>
    </itemizedlist>

    <para>Para as sess&otilde;es de video,  assumimos que o <application>&xfree86; 
      4.X</application> (<filename role='package'>x11/XFree86-4</filename>) j&aacute; est&aacute;
      instalado.  O <application>&xfree86; 3.X</application> pode
      funcionar, mas ele n&atilde;o foi testado com o que &eacute; descrito neste
      capitulo.  Se voc&ecirc; constatar que algo descrito aqui, funciona
      com o <application>&xfree86; 3.X</application>, por favor nos
      informe.</para>
      
    <warning>
      <para>Tentar montar um CD de audio ou um DVD de video com o comando
	&man.mount.8; ir&aacute; resultar ao menos em um erro, e no pior dos
	casos em um <emphasis>kernel panic</emphasis>.  Estas midias
	possuem uma codifica&ccedil;&atilde;o especializada, a qual difere do
	sistema de arquivos ISO usual.</para>
    </warning>

  </sect1>

  <sect1 id="sound-setup">
    <sect1info>
      <authorgroup>
        <author>
	 <firstname>Moses</firstname>
	 <surname>Moore</surname>
	 <contrib>Contriuido por</contrib>
	 <!-- 20 November 2000 -->
        </author>
      </authorgroup>
    </sect1info>

    <title>Configurando a placa de som</title>
    
  <sect2 id="sound-device">
    <title>Localizando o dispositivo correto</title>

    <indexterm><primary>PCI</primary></indexterm>
    <indexterm><primary>ISA</primary></indexterm>
    <indexterm><primary>Placas de som</primary></indexterm>

    <para>Antes de voc&ecirc; come&ccedil;ar, voc&ecirc; deve saber qual o modelo da
      placa que voc&ecirc; possui, qual chipset ela utiliza, e se ela &eacute; uma
      placa PCI ou ISA.  O FreeBSD suporta uma larga variedade de
      placas PCI e ISA.  Se voc&ecirc; n&atilde;o localizar a sua placa na lista
      seginte, verifique a pagina de manual &man.pcm.4;.  Esta n&atilde;o &eacute;
      uma lista completa; entretando ela lista algumas das placas mais
      comuns.</para>
    
    <itemizedlist>
      <listitem>
	<para>Crystal 4237, 4236, 4232, 4231</para>
      </listitem>

      <listitem>
	<para>Yamaha OPL-SAx</para>
      </listitem>

      <listitem>
	<para>OPTi931</para>
      </listitem>

      <listitem>
	<para>Ensoniq AudioPCI 1370/1371</para>
      </listitem>

      <listitem>
	<para>ESS Solo-1/1E</para>
      </listitem>

      <listitem>
	<para>NeoMagic 256AV/ZX</para>
      </listitem>

      <listitem>
	<para>&soundblaster; Pro, 16, 32, AWE64, AWE128, Live</para>
      </listitem>

      <listitem>
	<para>Creative ViBRA16</para>
      </listitem>

      <listitem>
	<para>Advanced Asound 100, 110, and Logic ALS120</para>
      </listitem>

      <listitem>
	<para>ES 1868, 1869, 1879, 1888</para>
      </listitem>

      <listitem>
	<para>Gravis UltraSound</para>
      </listitem>

      <listitem>
	<para>Aureal Vortex 1 or 2</para>
      </listitem>
    </itemizedlist>

    <indexterm>
      <primary>kernel</primary>
      <secondary>configura&ccedil;&atilde;o</secondary>
    </indexterm>

    <para>Para utilizar o seu dispositivo de som, voc&ecirc; ir&aacute; precisar
      carregar o driver de dispositivo apropriado.  Isto pode ser
      efetuado de duas formas.  A forma mais simples consiste-se em
      carregar o m&oacute;dulo de kernel apropriado para sua placa de som com 
      o comando &man.kldload.8; o que pode ser feito a partir da linha
      de comando:
    
    <screen>&prompt.root; <userinput>kldload snd_emu10k1.ko</userinput></screen>

    <para>ou atrav&eacute;s da adi&ccedil;&atilde;o de uma linha apropriada no arquivo 
      <filename>/boot/loader.conf</filename>, tal como o exemplo abaixo:</para>

    <programlisting>snd_emu10k1_load="YES"</programlisting>

    <para>Estes exemplos s&atilde;o para uma placa de som Creative
      &soundblaster; Live!.  Outros m&oacute;dulos de som carreg&aacute;veis
      dispon&iacute;veis s&atilde;o listados no
      <filename>/boot/defaults/loader.conf</filename>.</para>
    
    <para>Alternativamente, voc&ecirc; pode compilar de forma est&aacute;tica o 
      suporte &agrave; sua placa de som no seu kernel.  A sess&atilde;o abaixo
      fornece as informa&ccedil;&otilde;es que voc&ecirc; precisa para adicionar o suporte
      ao seu hardware desta maneira.  Para maiores informa&ccedil;&otilde;es sobre a
      recompila&ccedil;&atilde;o do seu kernel, por favor consulte 
      <xref linkend="kernelconfig">.</para>
    
    <sect3>
      <title>Placas de som Creative, Advance, e ESS</title>

      <para>Se voc&ecirc; possui uma das placas abaixo, voc&ecirc; ir&aacute; precisar
	adicionar:</para>
      
      <programlisting>device pcm</programlisting>

      <para>Ao seu arquivo de configura&ccedil;&atilde;o do kernel.  Se voc&ecirc; possui
      uma placa ISA PnP, voc&ecirc; tamb&eacute;m ter&aacute; que adicionar:</para>
      
      <programlisting>device sbc</programlisting>

      <para>Para uma plana n&atilde;o-PnP, adicione:</para>
      
      <programlisting>device pcm
device sbc0 at isa? port 0x220 irq 5 drq 1 flags 0x15</programlisting>

      <para>Ao seu arquivo de configura&ccedil;&atilde;o do kernel.  A configura&ccedil;&atilde;o
	mostrada acima &eacute; a padr&atilde;o.  Voc&ecirc; pode precisar alterar o IRQ
	ou outras configura&ccedil;&otilde;es para adaptar-se a sua placa.  Consulte
	a pagina de manual &man.sbc.4; para maiores
	informa&ccedil;&otilde;es.</para>
      
      <note>
	<para>A placa de som Sound Blaster Live n&atilde;o &eacute; suportada no
	  FreeBSD FreeBSD&nbsp;4.0 sem um <literal>patch</literal>, o
	  qual esta sess&atilde;o n&atilde;o ir&aacute; abranger.  &Eacute; recomendado que voc&ecirc;
	  atualize seu sistema para a ultima vers&atilde;o -STABLE antes de
	  tentar utilizar esta placa.</para>
      </note>
    </sect3>

    <sect3>
      <title>Placas Gravis UltraSound</title>

      <para>Para um placa ISA PnP, voc&ecirc; ir&aacute; precisar adicionar:</para>

      <programlisting>device pcm
device gusc</programlisting>

      <para>Ao seu arquivo de configura&ccedil;&atilde;o do kernel.  se voc&ecirc; possui 
	uma placa ISA n&atilde;o-PnP, voc&ecirc; ir&aacute; precisar adicionar:</para>

      <programlisting>device pcm
device gus0 at isa? port 0x220 irq 5 drq 1 flags 0x13</programlisting>

      <para>Ao seu arquivo de configura&ccedil;&atilde;o do kernel.  A configura&ccedil;&atilde;o 
        mostrada acima &eacute; a padr&atilde;o.  Voc&ecirc; pode precisar alterar o IRQ 
        ou outras configura&ccedil;&otilde;es para adaptar-se a sua placa.  Consulte 
        a pagina de manual &man.gusc.4; para maiores informa&ccedil;&otilde;es.</para>
    </sect3>

    <sect3>
      <title>Placas de som Crystal</title>

      <para>Para placas Crystal, voc&ecirc; ir&aacute; precisar adicionar:</para>

      <programlisting>device pcm
device csa</programlisting>

      <para>Ao seu arquivo de configura&ccedil;&atilde;o do kernel.</para>
    </sect3>

    <sect3>
      <title>Suporte Gen&eacute;rico</title>

      <para>Para placas PCI ou ISa PnP, voc&ecirc; ir&aacute; precisar adicionar:</para>

      <programlisting>device pcm</programlisting>

      <para>Ao seu arquivo de configura&ccedil;&atilde;o do kernel.  Se voc&ecirc; possui
	uma placa de som ISA n&atilde;o-PnP a qual n&atilde;o possui um
	<literal>bridge driver</literal>, voc&ecirc; ir&aacute; precisar
	adicionar:</para>
      
      <programlisting>device pcm0 at isa? irq 10 drq 1 flags 0x0</programlisting>

      <para>Ao seu arquivo de configura&ccedil;&atilde;o do kernel.  A configura&ccedil;&atilde;o 
        mostrada acima &eacute; a padr&atilde;o.  Voc&ecirc; pode precisar alterar o IRQ 
        ou outras configura&ccedil;&otilde;es para adaptar-se a sua placa.</para>
    </sect3>

    <sect3>
      <title>Som Onboard</title>

      <para>Alguns sistemas com idispositivos de som embutidos na
	placa m&atilde;e podem precisar que a seguinte op&ccedil;&atilde;o esteja presente em
	seu arquivo de configura&ccedil;&atilde;o do kernel:</para>
      
      <programlisting>options PNPBIOS</programlisting>
    </sect3>

  </sect2>

  <sect2 id="sound-devicenodes">
    <title>Criando e testando os n&oacute;s de dispositivos (Device Nodes)</title>

    <indexterm><primary>n&oacute;s de dispositivo</primary></indexterm>

    <para>Depois que voc&ecirc; reinicializar, loge no sistema e verifique se o seu dispositivo 
      est&aacute; sendo listado no arquivo <filename>/var/run/dmesg.boot</filename>, 
      como mostrado abaixo:</para>

    <screen>&prompt.root; <userinput>grep pcm /var/run/dmesg.boot</userinput>
pcm0: &lt;SB16 DSP 4.11&gt; on sbc0</screen>

    <para>A sa&iacute;da para o seu sistema pode parecer diferente.  Se o
      dispositivo <devicename>pcm</devicename> n&atilde;o for exibido, algo
      de errado ocorreu anteriormente.  Se isto acontecer, verifique
      novamente o arquivo de configura&ccedil;&atilde;o do seu kernel e
      certifique-se de que voc&ecirc; escolheu o dispositivo correto.  Os
      problemas mais comuns est&atilde;o listados em <xref linkend="troubleshooting">
      .</para>
    
    <note>
      <para>Se voc&ecirc; estiver executando o FreeBSD&nbsp;5.0 ou
      posterior, voc&ecirc; pode pular tranquilamente o resto desta sess&atilde;o.
      Estas vers&otilde;es utilizam um &man.devfs.5; para criar
      automaticamente os n&oacute;s de dispositivos.</para>
    </note>
      
    <para>Se o comando pr&eacute;vio retornou <devicename>pcm0</devicename>,
      voc&ecirc; ter&aacute; que executar os seguintes comandos, logado como
      <username>root</username>:</para>
    
    <screen>&prompt.root; <userinput>cd /dev</userinput>
&prompt.root; <userinput>sh MAKEDEV snd0</userinput></screen>

    <para>Se o comando retornou <devicename>pcm1</devicename>, siga os
      mesmos passos mostrados acima, subistituindo
      <devicename>snd0</devicename> por
      <devicename>snd1</devicename>.</para>
    
    <note>
      <para>Os comandos acima <emphasis>n&atilde;o</emphasis> ir&atilde;o criar o
	dispositivo <devicename>/dev/snd</devicename>!</para>
    </note>

    <para>O <command>MAKEDEV</command> ir&aacute; criar um grupo de n&oacute;s de
      dispositivo, incluindo:</para>
    
    <informaltable frame="none">
      <tgroup cols="2">
	<thead>
	  <row>
	    <entry>Dispositivo</entry>
	    <entry>Descri&ccedil;&atilde;o</entry>
	  </row>
	</thead>

	<tbody>
	  <row>
	    <entry><devicename>/dev/audio</devicename></entry>
	    <entry>Dispositivo de audio compativel com padr&atilde;o &sparc;</entry>
	  </row>

	  <row>
	    <entry><devicename>/dev/dsp</devicename></entry>
	    <entry>Dispositivo de voz digitalizada</entry>
	  </row>

	  <row>
	    <entry><devicename>/dev/dspW</devicename></entry>
	    <entry>Semelhante ao <devicename>/dev/dsp</devicename>, mas com uma 
	    amostragem de 16 bits</entry>
	  </row>

	  <row>
	    <entry><devicename>/dev/midi</devicename></entry>
	    <entry>Acesso direto ao dispositivo midi</entry>
	  </row>

	  <row>
	    <entry><devicename>/dev/mixer</devicename></entry>
	    <entry>Porta de controle do dispositivo de mixagem</entry>
	  </row>

	  <row>
	    <entry><devicename>/dev/music</devicename></entry>
	    <entry>Interface n&iacute;vel 2 do sequenciador</entry>
	  </row>

	  <row>
	    <entry><devicename>/dev/sequencer</devicename></entry>
	    <entry>Dispositivo sequenciador</entry>
	  </row>

	  <row>
	    <entry><devicename>/dev/pss</devicename></entry>
	    <entry>Interface de dispositivo program&aacute;vel</entry>
	  </row>
	</tbody>
      </tgroup>
    </informaltable>

    <para>Se tudo correu bem, agora voc&ecirc; deve ter uma placa de som que
      funciona.  Se o seu drive de CD-ROM ou de DVD-ROM estiver
      devidamente conectado a sua placa de som, voc&ecirc; pode colocar um
      CD no drive e reproduzi-lo com o uso do &man.cdcontrol.1;:</para>
    
      <screen>&prompt.user; <userinput>cdcontrol -f /dev/acd0c play 1</userinput></screen>

    <para>Varias aplica&ccedil;&otilde;es, tal como o <filename role="package">
      audio/workman</filename> oferece yma interface melhor.  Voc&ecirc;
      pode desejar instalar uma aplica&ccedil;&atilde;o tal como o <filename
      role="package">audio/mpg123</filename> para ouvir seus arquivos
      de audio no formato MP3.</para>
    
    <sect3 id="troubleshooting">
      <title>Problemas Comuns</title>

      <indexterm><primary>n&oacute;s de dispositivo</primary></indexterm>
      <indexterm><primary>I/O port</primary></indexterm>
      <indexterm><primary>IRQ</primary></indexterm>
      <indexterm><primary>DSP</primary></indexterm>

      <informaltable>
        <tgroup cols="2">
  	  <thead>
	    <row>
	     <entry>Erro</entry>
	      <entry>Solu&ccedil;&atilde;o</entry>
	    </row>
          </thead>

	  <tbody>
	    <row>
	      <entry><errorname>unsupported subdevice XX</errorname></entry>
	      <entry><para>Um ou mais dos n&oacute;s de dispositivo n&atilde;o foram
		criados corretamente. Repita os passos acima.</para></entry>
            </row>

            <row>
              <entry><errorname>sb_dspwr(XX) timed out</errorname></entry>
              <entry><para>A porta de I/O n&atilde;o esta ajustada corretamente.</para></entry>
            </row>

            <row>
              <entry><errorname>bad irq XX</errorname></entry>
	      <entry><para>O IRQ est&aacute; ajustado de forma incorreta.
		Certifique-se de que o IRQ setado &eacute; o mesmo IRQ
		utilizado pela sua placa.</para></entry>
            </row>

            <row>
              <entry><errorname>xxx: gus pcm not attached, out of memory</errorname></entry>
              <entry><para>N&atilde;o existe mem&oacute;ria suficiente para utilizar
		o dispositivo.</para></entry>
            </row>

            <row>
              <entry><errorname>xxx: can't open /dev/dsp!</errorname></entry>
              <entry><para>Verifique com o comando <command>fstat | grep dsp</command>
                se alguma outra aplica&ccedil;&atilde;o esta mantendo o dispositivo
		aberto.  Criadores de problema dignos de aten&ccedil;&atilde;o s&atilde;o o
		<application>esound</application> e o suporte a som do
		<application>KDE</application>.</para></entry>
            </row>
          </tbody>
        </tgroup>
      </informaltable>
    </sect3>
  </sect2>

  <sect2>
    <sect2info>
     <authorgroup>
      <author>
       <firstname>Munish</firstname>
       <surname>Chopra</surname>
       <contrib>Contribuido por </contrib>
      </author>
     </authorgroup>
    </sect2info>
    <title>Utilizando multiplas fontes de som</title>

    <para>&Eacute; frequentemente desej&aacute;vel termos multiplas fontes de som, as
      quais possam ser reproduzidas simultaneamente, como por exemplo
      quando o <application>esound</application> ou o
      <application>artsd</application> n&atilde;o suportam o compartilhamento
      do dispositivo de som com alguma aplica&ccedil;&atilde;o.</para>
    
    <para>O FreeBSD permite que voc&ecirc; fa&ccedil;a isso atrav&eacute;s dos
      <emphasis>Canais virtuais de som</emphasis>, os quais podem ser
      configurados atr&aacute;ves do &man.sysctl.8;.  Os canais virtuais
      permitem que voc&ecirc; multiplexe os canais de reprodu&ccedil;&atilde;o da sua
      placa de som atrav&eacute;s de uma mixagem do som pelo kernel.</para>
    
    <para>Para configurar os canais virtuais, existem 2 vari&aacute;veis do
      sysctl que precisam ser ajustadas,  se voc&ecirc; &eacute; o usu&aacute;rio
      <username>root</username>, isto pode ser feito da seguinte
      forma:</para>
    
    <screen>&prompt.root; <userinput>sysctl hw.snd.pcm0.vchans=4</userinput>
&prompt.root; <userinput>sysctl hw.snd.maxautovchans=4</userinput></screen>

    <para>O exemplo acima define 4 canais virtuais, o qual &eacute; um numero
      razo&aacute;vel para uso no dia a dia.  A vari&aacute;vel
      <varname>hw.snd.pcm0.vchans</varname> define o numero de canais
      virtuais que o <devicename>pcm0</devicename> possui, e ela &eacute;
      configur&aacute;vel  uma vez que o dispositivo tenha sido atachado. J&aacute; a
      vari&aacute;vel <literal>hw.snd.maxautovchans</literal> define o numero
      de canais virtuais atribuido a um dispositivo atachado via
      &man.kldload.8;.  Uma vez que o m&oacute;dulo
      <devicename>pcm</devicename> pode ser carregado
      independentemente dos drivers de hardware, a vari&aacute;vel
      <varname>hw.snd.maxautovchans</varname> pode armazenar quantos
      canais virtuais ser&atilde;o atribuidos a qualquer dispositivo de som
      atachado ap&oacute;s a inicializa&ccedil;&atilde;o do sistema.</para>
    
    <para>Se voc&ecirc; n&atilde;o est&aacute; utilizando o &man.devfs.5;,, voc&ecirc; ter&aacute; que
      apontar a sua aplica&ccedil;&atilde;o para
      <devicename>/dev/dsp0</devicename>.<replaceable>x</replaceable>,
      onde <replaceable>x</replaceable> ser&aacute; um valor de 0 a 3 se a
      vari&aacute;vel <varname>hw.snd.pcm.0.vchans</varname> estiver definida
      para 4 como no exemplo anterior.  Em um sistema que utilize o
      &man.devfs.5;, a atribui&ccedil;&atilde;o ocorre de forma autom&aacute;tica e
      transparente ao usu&aacute;rio.</para>
   </sect2>

  </sect1>

  <sect1 id="sound-mp3">
    <sect1info>
      <authorgroup>
	<author>
	  <firstname>Chern</firstname>
	  <surname>Lee</surname>
	  <contrib>Contribuido por </contrib>
	</author>
      </authorgroup>
      <!-- 11 Sept 2001 -->
    </sect1info>

    <title>Audio MP3</title>

    <para>Os arquivos de audio MP3 (MPEG Layer 3) oferecem uma qualidade de som
      pr&oacute;xima a qualidade de um CD de audio convencional, de forma que
      n&atilde;o existe nenhuma raz&atilde;o para que voc&ecirc; deixe a sua esta&ccedil;&atilde;o de
      trabalho FreeBSD sem suporte aos mesmos.</para>
    
    <sect2 id="mp3-players">
      <title>Reprodutores de MP3</title>

      <para>De longe, o reprodutor MP3 mais popular no ambiente
	<application>&xfree86;</application> &eacute; o
	<application>XMMS</application> (X Multimedia System).  Os
	skins do <application>Winamp</application> podem ser
	utilizandos com o <application>XMMS</application> uma vez que
	a GUI &eacute; quase identica a do Nullsoft's <application>Winamp
	</application>.  O <application>XMMS</application> tamb&eacute;m
	possui um suporte nativo a plugins.</para>
      
      <para>O <application>XMMS</application> pode ser instalado
	a partir do port <filename role="package">multimedia/xmms</filename> 
	ou ent&atilde;o atrav&eacute;s de um pacote bin&aacute;rio.</para>
      
      <para>A interface do <application>XMMS'</application> &eacute;
	intuitiva, com uma playlist, equalizador gr&aacute;fico, etc.
	Aqueles que est&atilde;o familizarizados com o
	<application>Winamp</application> ir&atilde;o achar o
	<application>XMMS</application> simples de se utilizar.</para>

      <para>O port <filename role="package">audio/mpg123</filename> &eacute;
	uma alternativa, visto que &eacute; um reprodutor de mp3 de linha de
	comando.</para>

      <para>O <application>mpg123</application> pode ser executado,
	especificando como parametros na linha de comando, o dispositivo 
	de som e o arquivo MP3, como ilustrado abaixo:</para>
      
      <screen>&prompt.root; <userinput>mpg123 -a <replaceable>/dev/dsp1.0</replaceable> Foobar-GreatestHits.mp3</userinput>
High Performance MPEG 1.0/2.0/2.5 Audio Player for Layer 1, 2 and 3.
Version 0.59r (1999/Jun/15). Written and copyrights by Michael Hipp.
Uses code from various people. See 'README' for more!
THIS SOFTWARE COMES WITH ABSOLUTELY NO WARRANTY! USE AT YOUR OWN RISK!





Playing MPEG stream from Foobar-GreatestHits.mp3 ...
MPEG 1.0 layer III, 128 kbit/s, 44100 Hz joint-stereo
</screen>

      <para>O <literal>/dev/dsp1.0</literal>  deve ser substituido com o 
	dispositivo <devicename>dsp</devicename> correspondente ao do
	seu sistema.</para>

    </sect2>

    <sect2 id="rip-cd">
      <title>Ripando trilhas de um CD de audio</title>

      <para>Antes de encodar um CD ou uma trilha de CD para MP3, os
      dados de audio do CD devem ser ripados para o seu disco rigido.
      Isto &eacute; feito atrav&eacute;s da c&oacute;pia dos dados CDDA brutos (CD Digital 
      Audio) para arquivos .WAV.</para>
      
      <para>A ferramenta <command>cdda2wav</command> a qual faz parte
	do pacote <filename role="package">sysutils/cdrtools</filename>,
	&eacute; utilizada para ripar informa&ccedil;&otilde;es de audio dos CDs, bem como
	as informa&ccedil;&otilde;es associadas a ele.</para>
      
      <para>Com o CD de audio no drive, o seguinte comando pode ser
	executado (como <username>root</username>) para ripar um CD
	inteiro para arquivos .WAV individuais (um por trilha):</para>
      
      <screen>&prompt.root; <userinput>cdda2wav -D <replaceable>0,1,0</replaceable> -B</userinput></screen>

      <para>O <application>cdda2wav</application> tamb&eacute;m suporta drives de
	CDROM padr&atilde;o ATAPI (IDE).  Para ripar apartir de um drive IDE,
	especifique o nome do dispositivo no lugar do numero de
	unidade SCSI. Por exemplo, para ripar a trilha 7 apartir de um
	drive IDE:</para>
      
      <screen>&prompt.root; <userinput>cdda2wav -D <replaceable>/dev/acd0a</replaceable> -t 7</userinput></screen>

      <para>A op&ccedil;&atilde;o <option>-D <replaceable>0,1,0</replaceable></option>
	indica o dispositivo SCSI <devicename>0,1,0</devicename>, o
	qual corresponde a saida do comando <command>cdrecord -scanbus
	</command>.</para>
      
      <para>Para ripar trilhas individuais, fa&ccedil;a uso da op&ccedil;&atilde;o
	<option>-t</option> como mostrado:</para>
      
      <screen>&prompt.root; <userinput>cdda2wav -D <replaceable>0,1,0</replaceable> -t 7</userinput></screen>

      <para>Este exemplo ripa a trilha 7 do CDROM de audio.  Para
	ripar um range de trilhas, por exemplo, da trilha 1 a 7,
	especifique o range:</para>
      
      <screen>&prompt.root; <userinput>cdda2wav -D <replaceable>0,1,0</replaceable> -t 1+7</userinput></screen>

      <para>O utilit&aacute;rio &man.dd.1; tamb&eacute;m pode ser utilizado para
	extrair uma trilha de audio de um drive ATAPI, leia a sess&atilde;o
	<xref linkend="duplicating-audiocds"> para maiores informa&ccedil;&otilde;es
	sobre esta possibilidade.</para>
      
    </sect2>

    <sect2 id="mp3-encoding">
      <title>Codificando arquivos MP3</title>

      <para>Hoje em dia, o codificador mp3 escolhido &eacute; o <application>lame</application>.
	O <application>Lame</application> pode ser encontrado no
	caminho <filename role="package">audio/lame</filename> da
	&aacute;rvore do ports.</para>
      
      <para>Utilizando os arquivos WAV ripados, o comando seguinte ir&aacute;
	converter o arquivo <filename>audio01.wav</filename> para
	<filename>audio01.mp3</filename>:</para>
      
      <screen>&prompt.root; <userinput>lame -h -b <replaceable>128</replaceable> \
--tt "<replaceable>Foo Song Title</replaceable>" \
--ta "<replaceable>FooBar Artist</replaceable>" \
--tl "<replaceable>FooBar Album</replaceable>" \
--ty "<replaceable>2001</replaceable>" \
--tc "<replaceable>Ripped and encoded by Foo</replaceable>" \
--tg "<replaceable>Genre</replaceable>" \
<replaceable>audio01.wav audio01.mp3</replaceable></userinput></screen>

      <para>Aparentemente 128&nbsp;kbits &eacute; o bitrate padr&atilde;o para uso
      	com arquivos MP3.  Muitos apreciam a qualidade superior
	oferecida por bitrates maiores como 160 ou 192kbps.  Quanto
	maior o bitrate, maior o espa&ccedil;o em disco ocupado pelo arquivo
	mp3 resultante -- mas a qualidade tamb&eacute;m ser&aacute; maior.  A op&ccedil;&atilde;o
	<option>-h</option> ativa o modo <quote>Maior qualidade mas um
	pouco mais lento</quote>.  As op&ccedil;&otilde;es iniciadas com
	<option>--t</option> indicam as tags ID3, as quais cont&eacute;m
	usualmente informa&ccedil;&otilde;es da musica, para serem embutidas no
	arquivo MP3.  Op&ccedil;&otilde;es adicionais de codifica&ccedil;&atilde;o podem ser
	encontradas consultando a pagina de manual do lame.</para>
      
    </sect2>

    <sect2 id="mp3-decoding">
      <title>Decodificando arquivos MP3</title>

      <para>A fim de gravar um CD de audio a partir de arquivos MP3,
	os mesmos devem ser convertidos para um formato WAV
	n&atilde;o-comprimido.  Tanto o <application>XMMS</application>
	quanto o <application>mpg123</application> suportam
	redirecionar a saida de um MP3 para um formato de arquivo
	descomprimido.</para>
	
      <para>Gravando para disco com o <application>XMMS</application>:</para>

      <procedure>
	<step>
	  <para>Execute o <application>XMMS</application>.</para>
	</step>

	<step>
	  <para>Clique com o bot&atilde;o direito do mouse na janela para
	    exibir o menu do <application>XMMS</application>.</para>
	</step>

	<step>
	  <para>Selecione a op&ccedil;&atilde;o <literal>Preference</literal> abaixo
	    do <literal>Options</literal>.</para>
	</step>

	<step>
	  <para>Altere o plugin de sa&iacute;da para <quote>Disk Writer 
	    Plugin</quote>.</para>
	</step>

	<step>
	  <para>Pressione <literal>Configure</literal>.</para>
	</step>

	<step>
	  <para>Entre com o diret&oacute;rio (ou escolha a op&ccedil;&atilde;o browse) no
	    qual os arquivos descomprimidos ser&atilde;o gravados.</para>
	</step>

	<step>
	  <para>Carregue normalmente o arquivo MP3 no <application>XMMS
	    </application>, com o volume ajustado para 100% e com as
	    configura&ccedil;&otilde;es do equalizador desligadas.</para>
	</step>

	<step>
	  <para>Pressione <literal>Play</literal> &mdash; O 
	    <application>XMMS</application> ir&aacute; se comportar como se
	    estivesse reproduzindo o arquivo MP3, mas nenhuma musica
	    ser&aacute; ouvida.  Ele est&aacute; na verdade reproduzindo o arquivo
	    MP3 para um arquivo.</para>
	</step>

	<step>
	  <para>Certifique-se de refazer a configura&ccedil;&atilde;o do plugin de saida,
	    para poder voltar a ouvir seus MP3 de novo.</para>
	</step>
      </procedure>

      <para>Escrevendo para a saida padr&atilde;o no <application>mpg123</application>:</para>

      <procedure>
	<step>
	  <para>Execute mpg123 -s <replaceable>audio01.mp3</replaceable>
	    &gt; audio01.pcm</para>
	</step>
      </procedure>

      <para>O <application>XMMS</application> gera um arquivo no
      	formato WAv, enquanto o <application>mpg123</application>
	converte o MP3 em dados brutos de audio no formato PCM.
	Ambos os formatos podem ser utilizados com o
	<application>cdrecord</application> para criar CDs de audio.
	J&aacute; com o &man.burncd.8;, voc&ecirc; poder&aacute; utilizar somente arquivos de 
	audio em formato PCM.  Se voc&ecirc; utilizar arquivos WAV, voc&ecirc;
	observar&aacute; um pequeno ruido no inicio de cada trilha, este som
	&eacute; o cabe&ccedil;alho do arquivo WAV.  Voc&ecirc; pode simplesmente remover
	o cabe&ccedil;akho de um arquivo WAV com o utilit&aacute;rio
	<application>SoX</application> (ele pode ser instalado apartir
	do port <filename role="package">audio/sox</filename> ou de um
	pacote bin&aacute;rio):</para>
      
      <screen>&prompt.user; <userinput>sox -t wav -r 44100 -s -w -c 2 <replaceable>track.wav track.raw</replaceable></userinput></screen>

      <para>Leia a sess&atilde;o <xref linkend="creating-cds"> para maiores 
	informa&ccedil;&otilde;es sobre o uso do um gravador de CDs no FreeBSD.</para>
    </sect2>
 </sect1>

 <sect1 id="video-playback">
  <sect1info>
    <authorgroup>
      <author>
        <firstname>Ross</firstname>
	<surname>Lippert</surname>
	<contrib>Contribuido por </contrib>
      </author>
    </authorgroup>
    <!-- 5 June 2002 -->
  </sect1info>

  <title>Reprodu&ccedil;&atilde;o de Video</title>

    <para>A reprodu&ccedil;&atilde;o de video &eacute; uma area de aplica&ccedil;&atilde;o muito nova e
      de rapido desenvolvimento.  Seja paciente.  Nem tudo esta
      funcionando it&atilde;o suavemente como com o som.</para>
    
    <para>Antes de voc&ecirc; iniciar, voc&ecirc; deve saber qual o modelo de
      placa de video que voc&ecirc; possui e qual o chipset que ela utiliza.
      Apesar do <application>&xfree86;</application> suportar uma
      ampla variedade de placas de video, poucas possuem uma boa
      performance de reprodu&ccedil;&atilde;o.  Para obter a lista de extens&otilde;es
      suportadas pelo servidor X que voc&ecirc; est&aacute; utilizando, utilize o
      comando &man.xdpyinfo.1; enquanto o X11 estiver sendo
      executado.</para>
    
    <para>&Eacute; uma id&eacute;ia possuir um arquivo MPEG curto, o qual possa ser
      tratado como um arquivo de teste para avaliar os diversos
      reprodutores e suas op&ccedil;&otilde;es.  Uma vez que alguns reprodutores de
      DVD ir&atilde;o procurar por padr&atilde;o uma midia DVD no
      <filename>/dev/dvd</filename>, ou ent&atilde;o possuem este nome dispositivo 
      definido estaticamente no c&oacute;digo do programa, voc&ecirc; pode achar
      util criar links simb&oacute;licos apontando para os dispositivos 
      apropriados:</para>
    
      <screen>&prompt.root; <userinput>ln -sf /dev/acd0c /dev/dvd</userinput>
&prompt.root; <userinput>ln -sf /dev/racd0c /dev/rdvd</userinput></screen>

    <para>No FreeBSD&nbsp;5.X, o qual utiliza &man.devfs.5; existe um
      conjunto ligeiramente diferente de links recomendados:</para>
    
      <screen>&prompt.root; <userinput>ln -sf /dev/acd0c /dev/dvd</userinput>
&prompt.root; <userinput>ln -sf /dev/acd0c /dev/rdvd</userinput></screen>

    <para>Adicionalmente, a decodifica&ccedil;&atilde;o de um DVD, a qual necessite
      da execu&ccedil;&atilde;o de fun&ccedil;&otilde;es especiais do DVD-ROM, exige permiss&atilde;o de
      escrita no dispositivo de DVD.</para>
    
    <indexterm>
      <primary>Op&ccedil;&otilde;es do kernel</primary>
      <secondary>options CPU_ENABLE_SSE</secondary>
    </indexterm>
    <indexterm>
      <primary>Op&ccedil;&otilde;es do kernel</primary>
      <secondary>options USER_LDT</secondary>
    </indexterm>

    <para>Alguns dos ports discutidos contam com as seguintes op&ccedil;&otilde;es
      no kernel para compilarem correatmente.  Antes de tentar
      compil&aacute;-las, adicione estas ope&ccedil;&otilde;es ao arquivo de configura&ccedil;&atilde;o
      do kernel, compile um novo kernel, e reinicialize:</para>
    
      <programlisting>option CPU_ENABLE_SSE
option USER_LDT</programlisting>

    <para>Para aumentar a memoria compartilhada dispon&iacute;vel para a
    interface X11, &eacute; recomendado que os valores de algumas vari&aacute;veis
    do &man.sysctl.8; sejam aumentadas:</para>
    
      <programlisting>kern.ipc.shmmax=67108864
kern.ipc.shmall=32768</programlisting>

  <sect2 id="video-interface">
    <title>Determinando as Capacidades de Video</title>

    <indexterm><primary>XVideo</primary></indexterm>
    <indexterm><primary>SDL</primary></indexterm>
    <indexterm><primary>DGA</primary></indexterm>

    <para>H&aacute; diversas maneiras poss&iacute;veis de se exibir um v&iacute;deo sob
      X11. Qual realmente ir&aacute; funcionar depende largamente do hardware
      utilizado.  Cada um dos m&eacute;todos descritos abaixo ter&aacute; sua
      qualidade v&aacute;riando em fun&ccedil;&atilde;o dos diferentes hardwares. Em
      segundo lugar, a renderiza&ccedil;&atilde;o de video em ambiente X11 &eacute; um t&oacute;pico 
      que recebe muita aten&ccedil;&atilde;o ultimamente, e cada nova vers&atilde;o do
      <application>&xfree86;</application>  pode trazer melhorias
      significativas.</para>
      
    <para>Uma lista das interfaces de video mais comuns:</para>

    <orderedlist>
    <listitem>
      <para>X11: Sa&iacute;da normal do X11 utilizando memoria compartilhada.</para>
    </listitem>
    <listitem>
      <para>XVideo: Uma extens&atilde;o para a interface X11 a qual suporta
	video em qualquer X11 drawable.</para>
    </listitem>
    <listitem>
      <para>SDL: Camada simples Directmedia.</para>
    </listitem>
    <listitem>
      <para>DGA: Acesso gr&aacute;fico direto.</para>
    </listitem>
    <listitem>
      <para>SVGAlib: Camada gr&aacute;fica para console.</para>
    </listitem>
    </orderedlist>

    <sect3 id="video-interface-xvideo">
    <title>XVideo</title>

      <para>O <application>&xfree86; 4.X</application> possui uma
	extens&atilde;o chamada <emphasis>XVideo</emphasis> (tamb&eacute;m conhecida
	como Xvideo, Xv, ou simplesmente xv) a qual permite que o
	video seja exibido diretamente em objetos drawable atrav&eacute;s de
	uma acelera&ccedil;&atilde;o especial.  Esta extens&atilde;o prove uma qualidade de
	reprodu&ccedil;&atilde;o muito boa, mesmo em equipamentos de poucos recursos
	(por exemplo um um laptop PIII&nbsp;400&nbsp;Mhz).
	Infelizmente, a lista de placas nas quais esta caracteristica
	&eacute; atualmente suportada de forma nativa se limita a:</para>
      
        <orderedlist>
	<listitem>
	   <para>3DFX Voodoo 3</para>
        </listitem>
        <listitem>
           <para>&intel; i810 e i815</para>
        </listitem>
        <listitem>
          <para>Alguns chips S3 (tais como Savage/IX e Savage/MX)</para>
        </listitem>
        </orderedlist>

      <para>Se a sua placa n&atilde;o &eacute; uma destas, n&atilde;o fique desapontado
      ainda.  O <application>&xfree86; 4.X</application> adiciona
      novas habilidades xv a cada release 
      <footnote>
        <para>Uma placa gr&aacute;fica popular e com uma performance no
	  <application>&xfree86;</application> geralmente muito boa,
	  as placas nVidia, ainda n&atilde;o liberaram as especifica&ccedil;&otilde;es do
	  seu suporte a XVideo para o grupo de desenvolvimento do
	  <application>&xfree86;</application>.  De forma que ainda
	  pode levar algum tempo at&eacute; que o <application>&xfree86;</application>
	  suporte completamente o XVideo nestas placas.</para>
      </footnote>.
      Para verificar se a extens&atilde;o esta executando, utilize o comando
      <command>xvinfo</command>:</para>

        <screen>&prompt.user; <userinput>xvinfo</userinput></screen>

      <para>XVideo is supported for your card if the result looks like:</para>
<screen>X-Video Extension version 2.2
screen #0
  Adaptor #0: "Savage Streams Engine"
    number of ports: 1
    port base: 43
    operations supported: PutImage 
    supported visuals:
      depth 16, visualID 0x22
      depth 16, visualID 0x23
    number of attributes: 5
      "XV_COLORKEY" (range 0 to 16777215)
              client settable attribute
              client gettable attribute (current value is 2110)
      "XV_BRIGHTNESS" (range -128 to 127)
              client settable attribute
              client gettable attribute (current value is 0)
      "XV_CONTRAST" (range 0 to 255)
              client settable attribute
              client gettable attribute (current value is 128)
      "XV_SATURATION" (range 0 to 255)
              client settable attribute
              client gettable attribute (current value is 128)
      "XV_HUE" (range -180 to 180)
              client settable attribute
              client gettable attribute (current value is 0)
    maximum XvImage size: 1024 x 1024
    Number of image formats: 7
      id: 0x32595559 (YUY2)
        guid: 59555932-0000-0010-8000-00aa00389b71
        bits per pixel: 16
        number of planes: 1
        type: YUV (packed)
      id: 0x32315659 (YV12)
        guid: 59563132-0000-0010-8000-00aa00389b71
        bits per pixel: 12
        number of planes: 3
        type: YUV (planar)
      id: 0x30323449 (I420)
        guid: 49343230-0000-0010-8000-00aa00389b71
        bits per pixel: 12
        number of planes: 3
        type: YUV (planar)
      id: 0x36315652 (RV16)
        guid: 52563135-0000-0000-0000-000000000000
        bits per pixel: 16
        number of planes: 1
        type: RGB (packed)
        depth: 0
        red, green, blue masks: 0x1f, 0x3e0, 0x7c00
      id: 0x35315652 (RV15)
        guid: 52563136-0000-0000-0000-000000000000
        bits per pixel: 16
        number of planes: 1
        type: RGB (packed)
        depth: 0
        red, green, blue masks: 0x1f, 0x7e0, 0xf800
      id: 0x31313259 (Y211)
        guid: 59323131-0000-0010-8000-00aa00389b71
        bits per pixel: 6
        number of planes: 3
        type: YUV (packed)
      id: 0x0
        guid: 00000000-0000-0000-0000-000000000000
        bits per pixel: 0
        number of planes: 0
        type: RGB (packed)
        depth: 1
        red, green, blue masks: 0x0, 0x0, 0x0</screen>

    <para>Tamb&eacute;m observe que os formatos listados (YUV2, YUV12, etc)
      n&atilde;o est&atilde;o presentes em todas as implementa&ccedil;&otilde;es do XVideo, e a
      sua ausencia pode atrapalhar alguns reprodutores.</para>
    
    <para>se o resultado se paracer com:</para>
<screen>X-Video Extension version 2.2
screen #0
no adaptors present</screen>

    <para>Ent&atilde;o provavelmente o XVideo n&atilde;o &eacute; suportado na sua placa.</para>

    <para>Se o XVideo n&atilde;o &eacute; suportado para a sua placa, isto significa
      somente que ser&aacute; mais dificil para o seu monitor lidar com a
      demanda computacional envolvida no processo de renderiza&atilde;o de
      video.  Dependendo da sua placa de video e do seu processador,
      voc&ecirc; pode continuar sendo capaz de ter uma experiencia
      satisfatoria.  Recomenda-se que voc&ecirc; consulte a sess&atilde;o <xref
      linkend="video-further-reading"> para obter maiores informa&ccedil;&otilde;es
      sobre como mlehorar a sua performance.</para>

    </sect3>

    <sect3 id="video-interface-SDL">
    <title>Camada simples directmedia (Simple Directmedia Layer)</title>

    <para>O SDL (Simple Directmedia Layer), est&aacute; tentando se tornar
      uma camada port&aacute;vel entre &microsoft.windows;, BeOS, e &unix;,
      permitindo o desenvolvimento de aplicativos cross-platform as
      quais fariam uso eficiente do som e dos gr&aacute;ficos.  A camada SDL
      disponibiliza uma abstra&ccedil;&atilde;o de baixo nivel para o hardware o
      que em algumas vezes pode ser mais eficiente do que a interface
      X11.</para>
    
    <para>O SDL pode ser encontrado em <filename role="package">devel/sdl12</filename></para>

    </sect3>

    <sect3 id="video-interface-DGA">
    <title>Acesso gr&aacute;fico direto</title>

    <para>O acesso gr&aacute;fico direto &eacute; uma extens&atilde;o do <application>&xfree86;</application>
      a qual permite a um programa contornar o servidor X e alterar
      diretamente o framebuffer da placa de video.  Como ele necessita
      de acesso ao mapeamento de memoria em baixo nivel para que este
      compartilhamento seja possivel, os programas que o utilizam
      devem ser executados como <username>root</username>.</para>
    
    <para>A extens&atilde;o DGA pode ser testada e avaliada pelo &man.dga.1;.
      Quando o <command>dga</command> esta executando, ele altera as
      cores do monitor sempre que uma tecla &eacute; pressionada.  Para sair,
      utilize a tecla <keycap>q</keycap>.</para>
    
    </sect3>

  </sect2>

  <sect2 id="video-ports">
    <title>Ports e Pacotes para lidar com video</title>

    <indexterm><primary>video ports</primary></indexterm>
    <indexterm><primary>video packages</primary></indexterm>

    <para>Esta sess&atilde;o trata dos programas disponiveis na cole&ccedil;&atilde;o de
      ports do FreeBSD, os quais podem ser utilizados para reproduzir
      video.  A reprodu&ccedil;&atilde;o de video &eacute; uma area de desenvolvimento de
      software muito ativa, e as caracteristicas de varias aplica&ccedil;&otilde;es
      podme divergir um pouco das descri&ccedil;&otilde;es fornecidas aquo.</para>
    
    <para>Inicialmente, &eacute; importante que voc&ecirc; saiba que muitas das
      aplica&ccedil;&otilde;es de video que rodam no FreeBSD foram desenvolvidas
      como uma aplica&ccedil;&atilde;o linux.  Muitas destas aplica&ccedil;&otilde;es permanecem
      com o status de vers&otilde;es beta (experimentais).  Alguns dos
      problemas que voc&ecirc; pode encontrar com os pacotes de video no
      FreeBSD incluem:</para>
    
      <orderedlist>

      <listitem>
        <para>Um aplicativo n&atilde;o pode reproduzir um arquivo o qual
	  tenha sido produzido por outro aplicativo.</para>
      </listitem> 

      <listitem>
        <para>Um aplicativo n&atilde;o pode reproduzir um arquivo o qual foi
	  produzido pelo proprio aplicativo.</para>
      </listitem>

      <listitem>
        <para>O mesmo aplicativo em duas maquinas diferentes,
	  reconstruido em cada maquina para aquela maquina especifica,
	  reproduz o mesmo arquivo de forma diferente.</para>
      </listitem>

      <listitem>
        <para>O uso de filtro aparentemente trivial tal como reescalar o
	  tamanho de uma imagem, gera um resultado muito ruim devido a
	  um bug na rotina de reescalonamento.</para>
      </listitem>

      <listitem>
        <para>Um aplicativo frequentemente apresenta um coredump.</para>
      </listitem>

      <listitem>
        <para>A documenta&ccedil;&atilde;o n&atilde;o &eacute; instalada com o port e pode ser
	  encontrada tanto na web quanto sob o diret&oacute;rio <filename
	  role='directory'>work</filename> dentro do diretorio do
	  port.</para>
      </listitem>

      </orderedlist>

    <para>Muitas destas aplica&ccedil;&otilde;es tamb&eacute;m pode exibir
      <quote>Linux-isms</quote>.  Isto &eacute;, podem existir algumas
      edi&ccedil;&otilde;es resultantes da forma como algumas das bibliotecas
      padr&otilde;es est&atilde;o implementadas nas distribui&ccedil;&otilde;es Linux, ou em algumas
      caracteristicas do kernel do Linux a qual tenha sido assumida
      pelos autores da aplica&ccedil;&atilde;o.  Estas edi&ccedil;&otilde;es nem sempre s&atilde;o
      reparadas ou trabalhadas pelo mantenedor do port, o que pode
      conduzir a problemas tais como pode:</para>
      
      <orderedlist>

      <listitem>
        <para>O uso do <filename>/proc/cpuinfo</filename> para
	  detectar as caracteristicas do processador.</para>
      </listitem>

      <listitem>
        <para>O uso inapropriado de threads o que causa a suspens&atilde;o 
	  do programa ao inv&eacute;s de verdadeiramente encerra-lo.</para>
      </listitem>

      <listitem>
        <para>O software n&atilde;o esta ainda na cole&ccedil;&atilde;o de ports do
	  FreeBSD o qual &eacute; utilizado geralmente em conjunto com a
	  aplica&ccedil;&atilde;o.</para>
      </listitem>

      </orderedlist>

      <para>At&eacute; agora, estes desenvolvedores de aplicativos tem sido
	cooperativos com os mantenedores de ports para minimizar as
	necessidades de work-arounds no port da aplica&ccedil;&atilde;o.</para>
      
    <sect3 id="video-mplayer">
      <title>MPlayer</title>

      <para>O <application>MPlayer</application> &eacute; um reprodutor de
	video desenvolvido recentemente, o qual vem sendo desenvolvido
	rapidamente.  Os objetivos do time de desenvolvedores do
	<application>MPlayer</application> s&atilde;o a velocidade e a
	flexibilidade no linux e em outros sabores do unix.  O projeto
	foi iniciado quando o fundador do projeto se encheu da m&aacute;
	performance de reprodu&ccedil;&atilde;o de video dos reprodutores
	que estavam disponiveis.  Alguns diriam que a interface
	gr&aacute;fica foi sacrificada em favor de um design simplificado.
	Entretanto, uma vez que voc&ecirc; tenha come&ccedil;a a utilizar as op&ccedil;&otilde;es
	de linha de comando e os controles de teclado, ele funciona
	muito bem.</para>
      
      <sect4 id="video-mplayer-building">
        <title>Compilando o MPlayer</title>
        <indexterm><primary>MPlayer</primary>
	           <secondary>making</secondary></indexterm>

	<para>O <application>MPlayer</application> se localiza no
	  <filename role="package">multimedia/mplayer</filename>.  O
	  <application>MPlayer</application> realiza diversas
	  verifica&ccedil;&otilde;es de hardware durante o processo de compila&ccedil;&atilde;o,
	  resultando em um bin&aacute;rio o qual n&atilde;o &eacute; port&aacute;vel de um sistema
	  para outro.  Por este motivo &eacute; importante compil&aacute;-lo a partir
	  do ports e evitando utilizar um pacote bin&aacute;rio.
	  Adicionalmente, um grande numero de po&ccedil;&otilde;es podem ser
	  especificadas  na linha de comando do
	  <command>make</command>, como descrito no inicio do processo
	  de compila&ccedil;&atilde;o.</para>
	
	<screen>&prompt.root; <userinput>cd /usr/ports/multimedia/mplayer</userinput>
&prompt.root; <userinput>make</userinput>
You can enable additional compilation optimizations
by defining WITH_OPTIMIZED_CFLAGS
You can enable GTK GUI by defining WITH_GUI.
You can enable DVD support by defining WITH_DVD.
You can enable SVGALIB support by defining WITH_SVGALIB.
You can enable VORBIS sound support by defining WITH_VORBIS.
You can enable XAnim DLL support by defining WITH_XANIM.
</screen>

        <para>Se voce possui o <filename
	  role="package">x11-toolkits/gtk12</filename> instalado,
	  ent&atilde;o voc&ecirc; tamb&eacute;m poder&aacute; habilitar a interface gr&aacute;fica.  Se
	  n&atilde;o, n&atilde;o vale o esfor&ccedil;o.  Se voc&ecirc; planeja reproduzir
	  (possivelmente encodados com CSS) DVD´s com o
	  <application>MPlayer</application> voc&ecirc; precisa habilitar a
	  op&ccedil;&atilde;o de suporte a DVD <footnote><para>Reprodu&ccedil;&atilde;o n&atilde;o
	  autorizada de DVD´s &eacute; um serio ato criminal em alguns
	  paises.  Verifique as leis locais antes de habilitar esta
	  op&ccedil;&atilde;o.</para></footnote>.  Algumas op&ccedil;&otilde;es razo&aacute;veis s&atilde;o:</para>
	
        <screen>&prompt.root; <userinput>make WITH_DVD=yes WITH_SVGALIB=yes</userinput></screen>

        <para>Neste momento em que este capitulo est&aacute; sendo escrito, o
	  port do <application>MPlayer</application> ir&aacute; construir a
	  documenta&ccedil;&atilde;o HTML dele  e um execut&aacute;vel, <command>mplayer</command>.  Ele 
	  tamb&eacute;m pode ser compilado de forma a gerar um encoder,
	  <command>mencoder</command>, o qual &eacute; uma ferramenta para
	  re-encodar video.  Uma modifica&ccedil;&atilde;o no <filename>Makefile</filename>
	  pode habilitar a sua gera&ccedil;&atilde;o.  Ele pode ser habilitado por
	  padr&atilde;o nas vers&otilde;es futuras do port.</para>
	
        <para>A documenta&ccedil;&atilde;o HTML do <application>MPlayer</application> 
	  &eacute; muito informativa.  Se o leitor sentir falta de alguma
	  informa&ccedil;&atilde;o sobre hardware e interface de video, a
	  documenta&ccedil;&atilde;o do <application>MPlayer</application> &eacute; um
	  suplemento perfeito.  Voc&ecirc; definitivamente deveria dedicar
	  um tempo a leitura da documenta&ccedil;&atilde;o do
	  <application>MPlayer</application> se voc&ecirc; esta procurando
	  por informa&ccedil;&otilde;es sobre o suporte a video no ambiente
	  &unix;.</para>
	
      </sect4>

      <sect4 id="video-mplayer-using">
        <title>Utilizando o MPlayer</title>
        <indexterm><primary>MPlayer</primary>
	           <secondary>use</secondary></indexterm>

        <para>Qualquer usu&aacute;rio do <application>MPlayer</application>
	  deve estabelecer um subdiret&oacute;rio
	  <filename>.mplayer</filename> no seu diret&oacute;rio home.  Para
	  criar este subdiret&oacute;rio necess&aacute;rio ao funcionamento do
	  aplicativo, voc&ecirc; pode executar o seguinte:</para>
	
<screen>&prompt.user; <userinput>cd /usr/ports/multimedia/mplayer</userinput>
&prompt.user; <userinput>make install-user</userinput></screen>

	<para>As op&ccedil;&otilde;es de comando para o <command>mplayer</command>
	  est&atilde;o listadas na sua p&aacute;gina de manual.  Para maiores
	  detalhes consulte a documenta&ccedil;&atilde;o HTML.  Nesta sess&atilde;o, n&oacute;s
	  descreveremos apenas alguns usos comuns.</para>
	
	<para>Para reproduzir um arquivo, como por exemplo
	  <filename><replaceable>testfile.avi</replaceable></filename>,
	  atrav&eacute;s de uma das varias interfaces de video, especifique a
	  op&ccedil;&atilde;o <option>-vo</option>:</para>
	
	  <screen>&prompt.user; <userinput>mplayer -vo xv testfile.avi</userinput></screen>
	  <screen>&prompt.user; <userinput>mplayer -vo sdl testfile.avi</userinput></screen>
	  <screen>&prompt.user; <userinput>mplayer -vo x11 testfile.avi</userinput></screen>
	  <screen>&prompt.root; <userinput>mplayer -vo dga testfile.avi</userinput></screen>
	  <screen>&prompt.root; <userinput>mplayer -vo 'sdl:dga' testfile.avi</userinput></screen>

	<para>Vale a pena tentar todas estas op&ccedil;&otilde;es, porque seu
	  desempenho relativo depende de muitos fatores e variar&aacute;
	  significativamente com o hardware.</para>
	
	<para>Para reproduzir um DVD, supstitua o <filename>
	  testfile.avi</filename> com <option>-dvd &lt;N&gt; 
	  <replaceable>DEVICE</replaceable></option> onde &lt;N&gt; &eacute;
	  o numero do titulo a ser reproduzido e
	  <filename><replaceable>DEVICE</replaceable></filename> &eacute; o
	  n&oacute; de dispositivo para o DVD-ROM.  Por exemplo, para
	  reproduzir o titulo 3 a partir do
	  <filename>/dev/dvd</filename>:</para>
	
	  <screen>&prompt.root; <userinput>mplayer -vo dga -dvd 2 /dev/dvd</userinput></screen>

	<para>Para para, pausar, avan&ccedil;ar e assim por diante, consulte
	  o mapeamento de teclas, o qual &eacute; exibido pela execu&ccedil;&atilde;o do
	  comando <command>mplayer -h</command> ou ent&atilde;o leia a pagina
	  de manual.</para>
	
        <para>Uma importante op&ccedil;&atilde;o de reprodu&ccedil;&atilde;o &eacute;: <option>-fs
	  -zoom</option> a qual emprega o modo de tela cheia e
	  <option>-framedrop</option> a qual ajuda na
	  performance.</para>
	
	<para>Para que a linha de comando do mplayer n&atilde;o se torne
	  demasiadamente grande, o usu&aacute;rio pode criar um arquivo
	  <filename>.mplayer/config</filename> e especificar ali as
	  op&ccedil;&otilde;es padr&otilde;es:</para>
	
<programlisting>vo=xv
fs=yes
zoom=yes</programlisting>

	<para>E por ultimo, o <command>mplayer</command> pode ser
	  utilizado para ripar um titulo DVD para um arquivo
	  <filename>.vob</filename>.  Para ripar o segundo titulo de um
	  DVD, execute isto:</para>
	
	  <screen>&prompt.root; <userinput>mplayer -dumpstream -dumpfile out.vob -dvd 2 /dev/dvd</userinput></screen>

        <para>O arquivo de sa&iacute;da, <filename>out.vob</filename>, ser&aacute;
	   um arquivo mpeg e pode ser manipulado pelos outros pacotes
	  descritos nesta sess&atilde;o.</para>

      </sect4>
      <sect4 id="video-mencoder">
        <title>mencoder</title>
        <indexterm>
	  <primary>mencoder</primary>
	</indexterm>

	<para>Se voc&ecirc; optou por instalar o <command>mencoder</command>
	  quando compilou o <application>MPlayer</application>, fique
	  avisado de antem&atilde;o que ele ainda &eacute; um componente experimental.  Antes 
	  de utilizar o <command>mencoder</command> &eacute; uma boa id&eacute;ia se
	  familizarizar primeiro com as suas op&ccedil;&otilde;es a partir da
	  leitura da documenta&ccedil;&atilde;o HTML.  Existe uma p&aacute;gina de manual,
	  mas ela n&atilde;o &eacute; muito util sem a documenta&ccedil;&atilde;o HTML.  Existem
	  inumeras maneiras de melhorar a qualidade, diminuir a taxa
	  de dados (bitrate), e alterar os formatos, e algums destes
	  truques podem fazer a diferen&ccedil;a entre um desempenho bom e um
	  mediocre.  Aqui est&aacute; um par de exemplos para iniciarmos.
	  Primeiro uma c&oacute;pia simples:</para>
	
	 <screen>&prompt.user; <userinput>mencoder input.avi -oac copy -ovc copy -o output.avi</userinput></screen>

         <para>Combina&ccedil;&otilde;es inapropriadas de op&ccedil;&otilde;es da linha de comando
	   podem render arquivos de sa&iacute;da que n&atilde;o podem ser
	   reproduzidos com o <command>mplayer</command>.  Desta
	   forma, se voc&ecirc; deseja apenas ripar para um arquivo, utilize
	   a op&ccedil;&atilde;o <option>-dumpfile</option> no
	   <command>mplayer</command>.</para>
	 
	 <para>Para converter o arquivo <filename>input.avi</filename> para o
	 codec de video MPEG4 e com codifica&ccedil;&atilde;o de audio no formato MPEG3 
	 (&eacute; necess&aacute;rio ter o <filename role="package">audio/lame</filename>):</para>
	 
	 <screen>&prompt.user; <userinput>mencoder input.avi -oac mp3lame -lameopts br=192 \
	 -ovc lavc -lavcopts vcodec=mpeg4:vhq -o output.avi</userinput></screen>

	 <para>Isso produz um arquivo de saida que pode ser
	   reproduzido pelo <command>mplayer</command> e pelo
	   <command>xine</command>.</para>
	 
	 <para>O <filename>input.avi</filename> pode ser subistituido
	   por <option>-dvd 1 /dev/dvd</option> e execute como
	   <username>root</username> para re-encodar idiretamente um 
	   titulo DVD.  Uma vez que &eacute; prov&aacute;vel que voc&ecirc; n&atilde;o fique
	   satisfeito com o resultado na sua primeira tentativa, &eacute;
	   recomendado que voc&ecirc; ripe o titulo para um arquivo e
	   trabalhe no mesmo.</para>
      </sect4>

    </sect3>

    <sect3 id="video-xine">
    <title>Reprodutor de video xine</title>

    <para>O reprodutor de video <application>xine</application> &eacute; um
      projeto com objetivos amplos, tentando produzir n&atilde;o apenas uma
      solu&ccedil;&atilde;o de vieo tudo em uma, mas tamb&eacute;m uma biblioteca de apoio
      reutiliz&aacute;vel, e um execut&aacute;vel modular cuja funcionalidade possa
      ser extendido com o uso de plugins.  Ele pode ser instalado
      tanto por um pacote quanto pelo ports <filename
      role="package">multimedia/xine</filename>.</para>
    
    <para>O <application>xine</application> est&aacute; ainda em uma fase
      rudimentar e avan&ccedil;a lentamente, mais ele &eacute; claramente um bom
      come&ccedil;o.  Na pr&aacute;tica, o <application>xine</application> necessita
      de uma CPU r&aacute;pida com uma placa de video r&aacute;pida, ou ent&atilde;o de uma
      placa com suporte para a extens&atilde;o XVideo.  A interface gr&aacute;fica &eacute;
      utiliz&aacute;vel, mas um pouco desajeitada.</para>
      
    <para>No momento em que esta sess&atilde;o esta sendo escrita, n&atilde;o existe
      nenhum m&oacute;dulo sendo distribuido com o
      <application>xine</application> o qual seja capaz de reproduzir
      DVD´s codificados com CSS.  Existem configura&ccedil;&otilde;es de terceiros as
      quais implementam m&oacute;dulos para isto, mas nenhum deles est&aacute;
      presente na cole&ccedil;&atilde;o de ports do FreeBSD.</para>
    
    <para>Comparado com o <application>MPlayer</application>, o
      <application>xine</application> faz mais pelo usu&aacute;rio, mas ao
      mesmo tempo, priva o usu&aacute;rio do controle de ajuste fino.  O
      <application>xine</application> apresenta a mlehor performance
      quando sob interface XVideo.</para>
    
    <para>Por padr&atilde;o, ao ser executado o <application>xine</application>
      ir&aacute; carregar a sua interface gr&aacute;fica. Os menus podem ser
      utilizados para abrir um arquivo especifico:</para>
    
      <screen>&prompt.user; <userinput>xine</userinput></screen>

    <para>Alternativamente, ele pode ser executado de forma a
      reproduzir imediatamente um arquivo, sem exibir a interface
      gr&aacute;fica ao usu&aacute;rio, com o comando:</para>
    
      <screen>&prompt.user; <userinput>xine -g -p mymovie.avi</userinput></screen>

    </sect3>

    <sect3 id="video-ports-transcode">
    <title>Utilit&aacute;rio transcode</title>

    <para>O software <application>transcode</application> n&atilde;o &eacute; um
      reprodutor, mas um conjunto de ferramentas para re-encodar
      arquivos <filename>.avi</filename> e <filename>.mpg</filename>.  
      Com o <application>transcode</application>, um tem a habilidade
      de juntar arquivos de video, consertar arquivos quebrados,
      utilizando ferramentas de linha de comando com interface de
      fluxo de dados para <filename>stdin/stdout</filename>.</para>
    
    <para>Assim como o <application>MPlayer</application>, o
      <application>transcode</application> &eacute; um software muito
      experimental, o qual deve ser compilado a partir do 
      <filename role="package">multimedia/transcode</filename>.
      Existe uma grande variedade de op&ccedil;&otilde;es que podem ser utilizadas
      com o comando <command>make</command>. As recomendadas
      s&atilde;o:</para>
    
      <screen>&prompt.root; <userinput>make WITH_LIBMPEG2=yes</userinput></screen>

    <para>Se voc&ecirc; planeja instalar o <filename
      role="package">multimedia/avifile</filename>, ent&atilde;o adicione a
      op&ccedil;&atilde;o <literal>WITH_AVIFILE</literal> a sua linha de comando
      <command>make</command>, como mostrado aqui:</para>
    
      <screen>&prompt.root; <userinput>make WITH_AVIFILE=yes WITH_LIBMPEG2=yes</userinput></screen>

    <para>Aqui est&atilde;o 2 exemplos de uso do <command>transcode</command>
      para para converter um video alterando o tamanho do mesmo na
      saida.  O primeiro encoda a saida para um arquivo AVI openDIVX,
      enquanto o segundo encoda para o formato MPEGi, o qual &eacute; muito mais 
      port&aacute;vel.</para> 
    
      <screen>&prompt.user; <userinput>transcode -i input.vob -x vob -V -Z 320x240 \
-y opendivx -N 0x55 -o output.avi</userinput></screen>

      <screen>&prompt.user; <userinput>transcode -i input.vob -x vob -V -Z 320x240 \
-y mpeg -N 0x55 -o output.tmp</userinput>
&prompt.user; <userinput>tcmplex -o output.mpg -i output.tmp.m1v -p output.tmp.mpa -m 1</userinput></screen>

    <para>Existe uma p&aacute;gina de manual para o <command>transcode</command>, mas
      existe muito pouca documenta&ccedil;&atilde;o para os v&aacute;rios
      utilit&aacute;rios <command>tc*</command> (como por exemplo o
      <command>tcmplex</command>) os quais tamb&eacute;m est&atilde;o instalados.
      Entretando, a op&ccedil;&atilde;o de linha de comando <option>-h</option>
      sempre pode ser utilizada para obter uma curta instru&ccedil;&atilde;o de uso
      para um comando.</para>
    
    <para>Em compara&ccedil;&atilde;o, o <command>transcode</command> roda
      significativamente mais devagar do que o
      <command>mencoder</command>, mas ele possui uma chance melhor de
      produzir um arquivo mais amplamente reprodut&iacute;vel.  MPEGs criados
      pelo <command>transcode</command> sabidamente podem ser
      reproduzidos nas vers&otilde;es antigas do <application>&windows.media;
      Player</application> e do <application>&quicktime;</application>
      da Apple, por exemplo.</para>
    
    </sect3>

  </sect2>

  <sect2 id="video-further-reading">
    <title>Refer&ecirc;ncias para leitura adicional</title>

    <para>Os varios pacotes de software de video para FreeBSD s&atilde;o
      desenvolvidos rapidamente.  E &eacute; bem prov&aacute;vel que em um futuro
      pr&oacute;ximo muitos dos problemas discutidos aqui ter&atilde;o sido
      resolvidos.  Neste meio tempo, aqueles que desejarem tirar o
      m&aacute;ximo das funcionalidades de A/V do FreeBSD ter&atilde;o que
      complementar seu conhecimento apartir de diversos FAQs e
      tutoriais e utilizar alguns aplicativos diferentes.  Esta sess&atilde;o
      existe para dar ao leitor indica&ccedil;&otilde;es de onde obter estas
      informa&ccedil;&otilde;es adicionais.</para>
    
    <para>A <ulink url="http://www.mplayerhq.hu/DOCS/">documenta&ccedil;&atilde;o do
      MPlayer</ulink> &eacute; muito informativa tecnicamente.  Esta
      documenta&ccedil;&atilde;o deveria ser consultada por qualquer pessoa que
      deseja obter um alto nivel de especializa&ccedil;&atilde;o em video no
      ambiente &unix;.  A lista de discuss&atilde;o do
      <application>MPlayer</application> &eacute; hostil para qualquer pessoa
      que n&atilde;o tenha lido a documenta&ccedil;&atilde;o, assim se voc&ecirc; planeja enviar
      relatorios de problemas para ela, leia o manual (RTFM).</para>
    
    <para>O <ulink
      url="http://dvd.sourceforge.net/xine-howto/en_GB/html/howto.html"> 
      tutorial sobre xine</ulink> cont&eacute;m um capitulo sobre melhoria de
      performance a qual se aplica a todos os reprodutores.</para>
    
    <para>Finalmente, existem algumas outras aplica&ccedil;&otilde;es promissoras as
      quais o leitor pode testar:</para>
    
    <itemizedlist>

       <listitem>
         <para>O <ulink
	   url="http://avifile.sourceforge.net/">Avifile</ulink> 
	   tamb&eacute;m esta dispon&iacute;vel no port <filename
	   role='package'>multimedia/avifile</filename>.</para>
       </listitem>

       <listitem>
         <para>O <ulink
	   url="http://www.dtek.chalmers.se/groups/dvd/">Ogle</ulink>
	   tamb&eacute;m esta dispon&iacute;vel no port <filename
	   role='package'>multimedia/ogle</filename>.</para>
       </listitem>

       <listitem>
         <para><ulink url="http://xtheater.sourceforge.net/">Xtheater</ulink></para>
       </listitem>

	<listitem>
         <para><filename
           role="package">multimedia/dvdauthor</filename>, 
	   um pacote de c&oacute;digo aberto para autoria de conteudo 
	   de DVDs
        </listitem>

    </itemizedlist>

  </sect2>
 </sect1>
</chapter>

<!--
     Local Variables:
     mode: sgml
     sgml-declaration: "../chapter.decl"
     sgml-indent-data: t
     sgml-omittag: nil
     sgml-always-quote-attributes: t
     sgml-parent-document: ("../book.sgml" "part" "chapter")
     End:
-->
